---
title: '[Note] 中国剩余定理'
tags:
  - 数论/同余系
  - 难度/P2/提高
categories:
  - 00_Atlas
  - 40_数学
  - 41_数论基础
abbrlink: 715ac6ef
date: 2026-01-25 00:00:00
---

# 中国剩余定理

## 1. 生态位

- **识别**:
    
    1. 题目给出一组一元线性同余方程组：$x \equiv a_i \pmod{m_i}$。
        
    2. 模数 $m_1, m_2, \dots, m_n$ **两两互质**。
        
- **地位**: 数论体系中的“约束合并工具”。它证明了在互质模数下，局部残余系的组合对应唯一的全局解，是处理多条件合并逻辑的原型。
    
- **用途**: 将复杂的全局约束拆解为若干个互不干扰的局部约束，再通过特定的权值构造将其复原。

## 2. 逻辑支点

### 2.1 核心原理：正交构造

中国剩余定理( CRT ) 的本质是寻找一组 "基底" ${e_1, e_2, \cdots ,e_n}$，使得每个 $e_i$ 在模 $m_i$ 时等于 $1$，而在模其他所有 $m_j \quad(j \neq i)$ 时等于 $0$。

而一旦找到这组基底，最终解即可表示为：

$$
x = \sum_{i=1}^{n}(a_i e_i) \bmod M, M = \prod m_i
$$

### 2.2 具体推导

对于每个方程 $x \equiv a_i \pmod m_i$：

1. 令 $M_i = M / m_i$（即除 $m_i$ 外的所有模数乘积）。显然 $M_i$ 能被其他所有 $m_j$ 整除，故 $M_i \equiv 0 \pmod {m_j}$。

2. 我们需要让每一个 $M_i$ 乘上一个系数 $t_i$，使得 $M_i t_i \equiv 1 \pmod m_i$。

3. 这里的 $t_i$ 恰好就是 $M_i$ 在模 $m_i$ 意义下的乘法逆元（利用 ExGCD 求解）。

4. 于是基底 $e_i = M_i t_i$。

### 2.3 逻辑转换

CRT 实际上是将数字从 “值空间” 投影到了 “余数向量空间” $(a_1, a_2, \cdots, a_n)$。由于模数两两互质，这种映射是双射（一一对应）的。

## 3. 实战部署

{% fold info @标准 CRT 模板 %}
```cpp
// 依赖插件：ExGCD
ll exgcd( ll a, ll b, ll &x, ll &y )
{
    if( b == 0 ) { x = 1; y = 0; return a; }
    ll d = exgcd( b, a % b, y, x );
    y -= ( a / b ) * x;
    return d;
}

// 标准 CRT：处理两两互质的模数
ll crt( int n, ll a[], ll m[] )
{
    ll M = 1, ans = 0;
    for( int i = 1; i <= n; ++ i ) M *= m[ i ];

    for( int i = 1; i <= n; ++ i )
    {
        ll Mi = M / m[i];
        ll ti, y;
        // 求解 Mi * t ≡ 1 (mod mi)
        exgcd( Mi, m[i], t, y );
        
        // 构造并累加：ans = ∑ a_i * Mi * (Mi^-1 mod mi)
        // 确保 ti 为正数，并进行正交构造
        ti = ( ti % m[i] + m[i] ) % m[i];
        ans = ( ans + a[i] * Mi % M * ti % M ) % M;
    }
    return ( ans + M ) % M;
}
```
{% endfold %}

## 4. 知识关联

- **前置知识**: 

	- [[扩展欧几里得与裴蜀定理]] —— CRT 的核心计算依赖于 ExGCD 求解逆元。

	- [[乘法逆元体系]] —— CRT 的构造过程本质上是逆元逻辑在多模数环境下的正交化应用。
    
- **扩展应用**:
    
	- [[扩展中国剩余定理]] —— 当模数不互质时，通过两两合并同余方程组的方式求解。
	    
	- [[卢卡斯定理]] —— 在计算大组合数取模时，CRT 常用于合并不同质因子的计算结果。
        