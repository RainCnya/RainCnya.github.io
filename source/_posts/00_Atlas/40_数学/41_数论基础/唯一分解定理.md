---
title: '[Note] 唯一分解定理'
tags:
  - 数论/基础
  - 难度/P1/普及
categories:
  - 00_Atlas
  - 40_数学
  - 41_数论基础
abbrlink: 923ca70a
date: 2026-01-22 00:00:00
---
# 唯一分解定理

## 1. 生态位

- **识别**:
    
	1. 题目涉及因数个数、因数总和。
	    
	2. 需要分析乘积的性质（如判定一个数是否为完全平方数）。
	    
	3. 需要推导欧拉函数等积性函数的数学表达式。
        
- **地位**: 数论的基础原理。它将离散的整数，都映射为一组素数幂次序列的“向量”。
    
- **用途**: 绕过 $O(N)$ 的因数枚举，通过 $O(\sqrt{N})$ 甚至更快的质因数分解，直接利用组合数学计算全局因数属性。

## 2. 逻辑支点

### 2.1 核心表达式

任何正整数 $n > 1$ 都可以唯一地表示为：

$$n = p_1^{a_1} p_2^{a_2} \dots p_k^{a_k} = \prod_{i=1}^{k} p_i^{a_i}$$

其中 $p_i$ 为递增的质数，$a_i$ 为正整数指数。

### 2.2 因数统计

基于上述表示法，我们无需枚举即可推导出以下属性：

- **因数个数** $d(n)$: 每个质因数 $p_i$ 可以在因数中出现 $0 \dots a_i$ 次（共 $a_i + 1$ 种选择）。
    
    $$d(n) = \prod_{i=1}^{k} (a_i + 1)$$
- **因数总和** $\sigma(n)$: 利用分配律，因数之和等于各质因数等比数列之和的乘积。
    
    $$\sigma(n) = \prod_{i=1}^{k} \left( \sum_{j=0}^{a_i} p_i^j \right) = \prod_{i=1}^{k} \frac{p_i^{a_i+1}-1}{p_i-1}$$
- **欧拉函数** $\phi(i)$：定义为 $1 \dots n$ 中与 $n$ 互质的数，根据唯一分解定理和容斥原理推导：

$$
\phi(n) = n \cdot \prod_{i=1}^{k}(1 - \frac{1}{p_i})
$$
	- **物理意义**: 剔除掉所有包含 $p_i$ 因子的数，剩下的即为“互质原子”。

## 3. 实战部署

{% fold info @质因数分解 %}

```cpp
// 复杂度: O(sqrt(N))
// 逻辑：不断试除最小质因子，剩下的部分必定也是质数或 1
vector< PII > primes;
void factorize( ll n )
{
    for ( ll i = 2; i * i <= n; ++ i )
    {
        if ( n % i == 0 )
        {
            int count = 0;
            while ( n % i == 0 )
            {
                n /= i;
                count ++;
            }
            primes.push_back({ i, count });
            // 此时 p = i, 指数 = count
            // 可在此处直接套用因数个数/总和公式
        }
    }
    if( n > 1 ) primes.push_back({ n, 1 });
}
```

{% endfold %}

## 4. 知识关联

- **前置知识**: 
	
	- [[数论导论与位运算]] —— 确立整除的定义与辗转相除法逻辑。
    
- **扩展应用**:
    
    - [[素数筛法]] —— 利用唯一分解性，确保每个合数仅由其最小质因子筛除，实现 $O(N)$ 打表。
	    
	- [[欧拉定理与费马小定理]]:  —— 利用本篇推导的 $\phi(n)$ 公式，寻找幂运算在模意义下的循环节。
	    
	- [[中国剩余定理]]: —— 将合数模的方程拆解为若干个互质质数幂次的方程组进行处理。
        
- **高阶内容**：

	- [[Pollard-rho 算法]]（大整数分解）。