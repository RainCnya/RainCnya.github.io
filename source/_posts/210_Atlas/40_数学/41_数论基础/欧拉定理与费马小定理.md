---
title: '[Note] 欧拉定理与费马小定理'
tags:
  - 数论/同余
  - 难度/P3
categories:
  - 210_Atlas
  - 40_数学
  - 41_数论基础
abbrlink: 7cb87255
date: 2026-01-25 00:00:00
---

# 欧拉定理与费马小定理

## 1. 生态位

- **识别**:
    
    1. 题目涉及形如 $a^b \pmod m$ 的运算，且指数 $b$ 极大（远超 `long long` 范围，甚至以字符串形式给出）。
        
    2. 需要在模意义下求解幂运算的周期性问题。
        
- **地位**: 数论体系的“指数处理工具”。它揭示了模运算下幂次序列的**周期性规律**。
    
- **用途**: 将线性增长的指数运算塌陷为 $O(\log m)$ 的对数运算。

## 2. 逻辑支点

### 2.1 费马小定理

- **内容**：若 $p$ 为质数，且 $gcd(a, p) = 1$，则：

$$
a^{p-1} \equiv 1 \pmod p
$$

- **特例**：它是欧拉定理在 $n$ 为质数时的特例（因为 $\phi(p) = p - 1$ ）。

### 2.2 欧拉定理：

- **内容**：若 $gcd(a, m) = 1$，则：

$$
a^{\phi(m)} \equiv 1 \pmod m
$$

- **物理意义**：在模 $m$ 意义下，底数 $a$ 的幂次以 $\phi(m)$ 为周期进行循环。

### 2.3 扩展欧拉定理

- **内容**：当 $gcd(a, m) \neq 1$ 时，幂次序列在经过一段"前奏"后，依然会进入长度为 $\phi(m)$ 的循环。

- **核心公式**：当 $b \geq \phi(m)$ 时

$$
a^b \equiv a^{(b \bmod \phi(m))+ \phi(m)} \pmod m \quad( b \geq \phi(m))
$$

## 3. 实战部署

{% fold info @扩展欧拉定理 (大数降幂处理) %}

```cpp
// 1. 预处理单个数的欧拉函数
ll get_phi( ll n )
{
    ll res = n;
    for( ll i = 2; i * i <= n; ++ i )
    {
        if( n % i == 0 )
        {
            res = res / i * ( i - 1 );
            while ( n % i == 0 ) n /= i;
        }
    }
    if ( n > 1 ) res = res / n * ( n - 1 );
    return res;
}

// 2. 边读字符串边降幂
// 注意：必须判断指数是否大于等于 phi(m)，决定是否需要加补丁 +phi(m)
ll read_and_reduce( string b_str, ll phi_m )
{
    ll res = 0;
    bool flag = false;
    for ( char c : b_str )
    {
        res = res * 10 + ( c - '0' );
        if ( res >= phi_m )
        {
            res %= phi_m;
            flag = true;
        }
    }
    return flag ? ( res + phi_m ) : res;
}
```

{% endfold %}

## 4. 知识关联

- **前置知识**：

	- [[唯一分解定理]] —— 提供了欧拉函数 $\phi(m)$ 的数学定义与计算公式）。
    
- **扩展应用**：

	- [[乘法逆元体系]]: —— 费马小定理是求解质数模逆元的数学基础（$a^{p-2} \equiv a^{-1}$）。
    - [[素数筛法]]：为多组询问的大数降幂提供 $O(N)$ 的函数预处理支持。

- **高阶内容**：

	- [[原根与离散对数]]（探讨幂运算的最小正周期）。