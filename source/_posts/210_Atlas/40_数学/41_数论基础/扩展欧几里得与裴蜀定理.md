---
title: '[Note] 扩展欧几里得与裴蜀定理'
tags:
  - 数论/同余
  - 难度/P1
categories:
  - 210_Atlas
  - 40_数学
  - 41_数论基础
abbrlink: 86daf17d
date: 2026-01-25 00:00:00
---
# 扩展欧几里得与裴蜀定理

## 1. 生态位

- **识别**:
	
	1. 求解二元一次不定方程 $ax + by = c$ 的整数解。
	
	2. 求解线性同余方程 $ax \equiv c \pmod m$。
	
	3. 模数 $m$ 不是质数，且需要求解逆元。
        
- **地位**: 数论体系的“解方程工具”。它在 GCD 的基础上增加了对线性组合系数 $(x, y)$ 的构造能力，是连接整除与方程的关键。
    
- **用途**: 提供了一种确定性的递归构造法，在 $O( \log \min(a, b) )$ 时间内拉出一组整数特解。

## 2. 逻辑支点

### 2.1 裴蜀定理：存在性判定

- **内容**：对于不全为 $0$ 的整数 $a, b$，方程 $ax + by = c$ 有整数解的**充分必要条件**是 $c$ 是 $gcd(a, b)$ 的倍数。
- **意义**：$(a, b)$ 能够线性组合出的最小正整数就是它们的 $gcd$，如果要求组合出 $c$，那么 $c$ 就必须是 $gcd$ 的倍数。

### 2.2 核心原理：递归构造

我们通过递归寻找 $ax + by = gcd(a, b)$ 的一组特解。

**边界**：当 $b = 0$ 时，$gcd(a, 0) = a$，显然有 $a \times 1 + 0 \times 0 = a$，即 $x = 1, y = 0$。

**递推逻辑**：

假设我们已经求出了下一层 $bx' + ( a \bmod b )y' = gcd( b, a \bmod b )$ 的解。 

> 已知 $a \bmod b = a - \lfloor a/b \rfloor \cdot b$，代入得：

$$
bx' + (a - \lfloor a/b \rfloor \cdot b)y' = gcd(a, b)
$$
> 整理得：

$$
ay' + b( x' - \lfloor a/b \rfloor \cdot y') = gcd(a, b)
$$

**结论**：当前层的 $x = y', y = x' - \lfloor a/b \rfloor \cdot y'$。

### 2.3 通解扩展

求出一组特解 $(x_0, y_0)$ 后，设 $d = gcd(a, b)$，通解为：

$$
x = x_0 + k \cdot \frac{b}{d}, y = y_0 - k \cdot \frac{a}{d} \quad(k \in \mathbb{Z} )
$$

## 3. 实战部署

{% fold info @代码实现: ExGCD 标准模板 (构造特解) %}

```cpp
// 核心函数：返回 gcd(a, b)，并构造 ax + by = gcd(a, b) 的特解
ll exgcd( ll a, ll b, ll &x, ll &y )
{
    if( b == 0 ) { x = 1; y = 0; return a; }
    ll d = exgcd( b, a % b, y, x );
    y -= ( a / b ) * x;
    return d;
}

// 应用：求解 ax = c (mod m) 的最小正整数解
ll solveCongruence( ll a, ll c, ll m )
{
    ll x, y;
    ll d = exgcd( a, m, x, y );

    if( c % d != 0 ) return -1; // 裴蜀定理判定无解

    // 特解 x0 对应的是 ax + my = d，现在缩放 c/d 倍
    ll x0 = x * ( c / d );
    ll mod = m / d; // 步长周期
    
    return ( x0 % mod + mod ) % mod; // 映射回最小正整数区间
}
```

{% endfold %}

## 4. 知识关联

- **前置知识**：
	
	- [[数论导论与位运算]] —— 辗转相除法的扩展。
	
- **扩展应用**:
    
    - [[乘法逆元体系]] —— 利用 ExGCD 处理合数模下的逆元。
        
    - [[中国剩余定理]] —— 利用 ExGCD 解决多个同余方程的“合并”问题。