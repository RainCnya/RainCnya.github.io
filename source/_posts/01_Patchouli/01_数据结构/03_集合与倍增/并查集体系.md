---
title: 并查集体系 (DSU System)
tags:
  - 数据结构/并查集
  - 算法/逆向思维
categories:
  - 01_Patchouli
  - 01_数据结构
  - 03_集合与倍增
abbrlink: 3fd2748a
date: 2025-12-16 20:30:00
---
# 并查集体系 (DSU System)
## 1. 生态位

- **定义**: 维护元素所属集合的拓扑结构，支持 **合并 (Union)** 与 **查询 (Find)**。
    
- **解决痛点**:
    
    - 动态连通性判定（Kruskal 算法核心）。
        
    - 逻辑关系的传递与冲突校验（敌人的敌人是朋友）。
        
    - 离线场景下的动态删点/删边问题。
        

## 2. 逻辑支点

- **路径压缩 (Path Compression)**: 查询时通过递归或迭代将节点直接挂载到根节点下，使均摊复杂度降低至 $\alpha(N)$。
    
- **时光倒流 (Time Reversal)**: 由于并查集只支持合并（Union）不支持分裂（Split），当遇到“摧毁”或“删除”操作时，通过 **离线逆序** 扫描，将删点转化为增点。
    
- **扩展域 (Extended Domain)**: 将单一节点 $i$ 拆分为多个身份（如 $i$ 表示自己，$i+N$ 表示敌人）。通过维护不同身份间的连通性，处理复杂的排他逻辑。
    

## 3. 实战部署

{% fold info @Code: DSU Standard with Path Compression %}

```cpp
int fa[ maxn ];

// 初始化
void init( int n )
{
    for( int i = 1; i <= n; ++ i )
    {
        fa[ i ] = i;
    }
}

// 路径压缩查找
int find( int x )
{
    return fa[ x ] == x ? x : fa[ x ] = find( fa[ x ] );
}

// 合并逻辑
void merge( int x, int y )
{
    int fx = find( x ), fy = find( y );
    if( fx != fy )
    {
        fa[ fx ] = fy;
    }
}
```

{% endfold %}

## 4. 知识粘附

- **变体模型**:
    
    - **带权并查集**: 在路径压缩过程中维护节点到根的距离（偏移量）。
        
    - **离散化并查集**: 面对 $10^9$ 级的值域但稀疏的操作时，先对坐标进行离散化。
        
- **母题索引**:

	- [P1955 程序自动分析](P1955%20程序自动分析.md) :  离散化与处理顺序（先等后不等）。

	- [P1525 关押罪犯 (DSU_Extended_Enemy)](P1525%20关押罪犯%20(DSU_Extended_Enemy).md) : 扩展域经典应用（关押罪犯）。

	- [P1197 星球大战 (DSU_Time_Travel)](P1197%20星球大战%20(DSU_Time_Travel).md) : 时光倒流思想（星球大战）。
