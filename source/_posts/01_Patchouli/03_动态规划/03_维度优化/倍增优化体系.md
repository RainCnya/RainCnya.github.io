---
title: 倍增优化策略 (Doubling System)
tags:
  - DP/优化
  - 数据结构/倍增
categories:
  - 01_Patchouli
  - 03_动态规划
  - 03_维度优化
abbrlink: c936ec9e
date: 2025-12-16 23:30:00
---
# 倍增优化体系

## 1. 生态位

- **定义**: 利用 $2^k$ 的复合性质，预处理并维护状态在 $2^0, 2^1, \dots, 2^{\log N}$ 步长下的转移结果。
    
- **解决痛点**: 解决了线性链或环上超长路径（如 $10^9$ 步）的重复决策合并，将 $O(N)$ 转移跨越至 $O(\log N)$。
    
## 2. 逻辑支点

- **核心不变量**: **指数叠加态**。
    
    - $f[ i ][ j ] = f[ f[ i ][ j - 1 ] ][ j - 1 ]$。
        
    - 物理含义：从 $i$ 开始跳 $2^j$ 步，等价于从 $i$ 跳 $2^{j-1}$ 步到达中转点，再从中转点跳 $2^{j-1}$ 步。
        
- **渗透点 (Penetration)**:
    
    > 倍增是“状态转移的快速幂”。 它不是在搜索路径，而是在构建一条通往未来的“高速公路”。通过预先修好 $2^k$ 长度的路段，我们可以用最少的组合拼凑出任意远的目标位置。
    

## 3. 实战部署

### 3.1 倍增表构建与跳跃查询

{% fold info @Code: Doubling Jump %}

```cpp
// 1. 预处理 f[ i ][ 0 ]: 跳 1 步的最优后继
for( int i = 1; i <= n; ++ i )
{
    f[ i ][ 0 ] = next_pos[ i ];
}

// 2. 迭代建表
for( int j = 1; j < max_log; ++ j )
{
    for( int i = 1; i <= n; ++ i )
    {
        f[ i ][ j ] = f[ f[ i ][ j - 1 ] ][ j - 1 ];
    }
}

// 3. 执行跳跃 k 步
int cur = start;
for( int j = max_log - 1; j >= 0; -- j )
{
    if( ( k >> j ) & 1 )
    {
        cur = f[ cur ][ j ];
    }
}
```

{% endfold %}

## 4. 知识粘附

- **变体模型**:
    
    - [树形DP体系](树形DP体系.md): LCA (最近公共祖先) —— 典型的树上倍增应用。
        
    - [单调性优化体系](../单调性优化体系.md): ST 表 —— 利用倍增思想处理静态区间最值（不具备结合律但具备重叠贡献性）。
        
- **母题索引**:
    
    - [P6902 Surveillance (Opt_Doubling_Jump)](P6902%20Surveillance%20(Opt_Doubling_Jump).md) —— 环形覆盖下的倍增极限跳跃。
        