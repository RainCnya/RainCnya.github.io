---
title: 复合模型与逆向思维  (Composite & Reverse Logic)
tags:
  - 策略/构造
  - 算法/逆向思维
categories:
  - 01_Patchouli
  - 03_动态规划
  - 03_维度优化
abbrlink: 8179d216
date: 2025-12-17 00:40:00
---
# 复合模型与逆向思维

## 1. 生态位

- **定义**: 针对非典型 DP 场景，通过物理空间的**路径压缩**、逻辑序的**时光倒流**，或多种基础模型（背包、状压等）的**异构缝合**，将高熵问题转化为标准 DAG 路径搜索。
    
- **解决痛点**: 解决了时间轴过长但事件稀疏（P5017）、正向决策受未来状态深度耦合（P1280）、以及单一模型无法覆盖多维约束（P1941）的困境。
    
## 2. 逻辑支点

- **Path Compression (时空坍缩)**:
    
    - **渗透点**: 当状态转移的物理跨度远大于决策点的分布密度时，中间的空白路径是决策对称的。
        
    - **不变量**: 在摆渡车模型中，若两个乘客到达时间差 $> 2m$，中间的等待无意义，可将坐标轴截断，将指数级时间轴强行坍缩为 $O(N \cdot M)$。
        
- **Reverse Decision (时光倒流)**:
    
    - **核心直觉**: 当“现在的决策”被“未来的约束”卡死时，从终点向起点倒着走。
        
    - **逻辑归约**: 在尼克的任务中，由于任务结束时刻决定了下一次可选时刻，逆序 DP 使当前时刻 $i$ 能直接获取未来的最优收益。
        
- **Model Hybridization (模型缝合)**:
    
    - 将不同维度的约束映射为不同的 DP 算子。如《飞扬的小鸟》中：上升 $\iff$ 完全背包，下降 $\iff$ 0/1 背包，高度截断 $\iff$ 边界特殊处理。
        

## 3. 实战部署

### 3.1 路径压缩逻辑 (以摆渡车为例)

{% fold info @Code: Path Compression Logic %}

```cpp
// 核心：消除间隔大于 2m 的无效空白段
sort( t + 1, t + n + 1 );
int offset = 0;
for( int i = 1; i <= n; ++ i )
{
    int diff = t[ i ] - t[ i - 1 ];
    if( diff > 2 * m )
    {
        offset += diff - 2 * m;
    }
    t[ i ] -= offset; // 物理坐标重映射
}
```

{% endfold %}

### 3.2 逆序决策范式 (以尼克的任务为例)

{% fold info @Code: Reverse DP Pattern %}

```cpp
// 从时刻 n 倒退回 1
for( int i = n; i >= 1; -- i )
{
    if( tasks[ i ].empty( ) )
    {
        // 1. 无任务开始，空暇时间累加
        f[ i ] = f[ i + 1 ] + 1;
    }
    else
    {
        // 2. 有任务，必须选择一个并跳转至结束时刻
        for( int len : tasks[ i ] )
        {
            f[ i ] = max( f[ i ], f[ i + len ] );
        }
    }
}
```

{% endfold %}

## 4. 知识粘附

- **变体模型**:
    
    - [单调性优化体系](../单调性优化体系.md): 结合单调队列对复合模型（如股票交易）进行维度打击。
        
    - [树形DP体系](树形DP体系.md): 虚树 (Virtual Tree) —— 树上路径的另一种物理压缩形式。
        
- **母题索引**:
    
    - [P5017 摆渡车 (MQ_DP_Path_Compression)](P5017%20摆渡车%20(MQ_DP_Path_Compression).md) —— 路径压缩与时轴截断。
        
    - [P1280 尼克的任务 (Seq_Reverse_DP)](P1280%20尼克的任务%20(Seq_Reverse_DP).md) —— 逆序消除未来相关性。
        
    - [P1941 飞扬的小鸟](P1941%20飞扬的小鸟.md) —— 背包与状态机的高阶缝合。
        
    - [P5851 Greedy Pie Eaters (Interval_Reverse_Aux)](P5851%20Greedy%20Pie%20Eaters%20(Interval_Reverse_Aux).md) —— 逆向区间辅助数组设计。
        
    - [P2519 problem a](P2519%20problem%20a.md) —— 从排名逻辑向区间调度的模型跨越。
        