[{"title":"Mi Qiu's Digital Garden","content":"<h3 id=\"进度与思考-Progress-Thinking\">进度与思考 (Progress &amp; Thinking)</h3>\n<h4 id=\"☕-状态栏\">☕ 状态栏</h4>\n<blockquote>\n<p><strong>Current Status:</strong> 🏛️ TZCACM Team | 🎯 P0 Goal |<br>\n<strong>Current Phase:</strong> 🧊 Phase 2.5 (Refactoring Complete)<br>\n<strong>Philosophy:</strong> &quot;Airy &amp; Structured&quot; —— 追求逻辑极致与结构优雅。</p>\n</blockquote>\n<h3 id=\"🧠-The-Dual-Core\">🧠 The Dual Core</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"><strong>Left Brain (Logic)</strong></th>\n<th style=\"text-align:left\"><strong>Right Brain (Arts)</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>P0-Level ICPC Coach</strong><br>追求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n \\log n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span> 的秩序。<br>相信 <strong>Invariant (不变量)</strong> 胜过模拟。</td>\n<td style=\"text-align:left\"><strong>Rational Romanticist</strong><br>用硬科学锚定情感。<br>Everything is a graph, even memory.</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><a href=\"/posts/c28314d6/\">👉 <strong>Algo Atlas (知识地图)</strong></a></td>\n<td style=\"text-align:left\"><a href=\"/posts/42d63d0f/\">👉 <strong>Essays (橙子汽水)</strong></a></td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3 id=\"🗺️-The-Atlas-知识体系\">🗺️ The Atlas (知识体系)</h3>\n<blockquote>\n<p><em>这里不堆砌代码，只记录思维模型。</em></p>\n</blockquote>\n<h4 id=\"🏗️-Dynamic-Programming-动态规划\">🏗️ <a href=\"/posts/9e0761d7/\">Dynamic Programming (动态规划)</a></h4>\n<ul>\n<li><strong><a href=\"/posts/1c960464/\">DP Core Synthesis</a></strong>: 动态规划体系综述。</li>\n<li><strong><a href=\"/posts/a164e19/\">Sequence System</a></strong>: LIS/LCS 的线性变换与 Dilworth 定理。</li>\n<li><strong><a href=\"/posts/6cf4c37c/\">Knapsack Universe</a></strong>: 从 01 到分组，万变不离“容量”限制。</li>\n<li><strong><a href=\"/posts/a75f3b7c/\">Interval &amp; Ring System</a></strong>: 破环成链与区间动态规划。</li>\n<li><strong><a href=\"/posts/21d85f4f/\">Counting Methodology</a></strong>: 组合计数与容斥原理体系。</li>\n<li><strong>Optimization Tricks</strong>:\n<ul>\n<li><a href=\"/posts/517010cb/\">Implicit Monotonicity</a> (隐性单调性) | <a href=\"/posts/1bc8a91b/\">Queue Optimization</a> (单调队列)</li>\n<li><a href=\"/posts/ec3ba026/\">State Compression</a> (状压与抽象) | <a href=\"/posts/c936ec9e/\">Doubling Strategy</a> (倍增优化)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"🕸️-Graph-Theory-图论\">🕸️ <a href=\"/posts/4b02a8e5/\">Graph Theory (图论)</a></h4>\n<ul>\n<li><strong><a href=\"/posts/a049f02f/\">Graph Modeling Synthesis</a></strong>: 物理图结构 vs 代数状态映射 (差分约束/同余)。</li>\n<li><strong><a href=\"/posts/6ca7ce9c/\">SSSP System</a></strong>: 最短路体系与动态时间轴 (Floyd)。</li>\n<li><strong><a href=\"/posts/5042401c/\">Tarjan SCC</a></strong>: 连通性与 DFS 树的时间戳美学。</li>\n<li><strong><a href=\"/posts/5489c5f9/\">LCA &amp; MST System</a></strong>: 树上倍增与贪心切分定理。</li>\n<li><strong><a href=\"/posts/2608aaeb/\">Tree Difference</a></strong>: 树上差分与路径统计。</li>\n</ul>\n<h4 id=\"🧱-Data-Structure-数据结构\">🧱 <a href=\"/posts/4bddc3c/\">Data Structure (数据结构)</a></h4>\n<ul>\n<li><strong><a href=\"/posts/33f15c14/\">Segment Tree System</a></strong>: 线段树的算子结合律与扫描线几何投影。</li>\n<li><strong><a href=\"/posts/eef750c1/\">BIT System</a></strong>: 树状数组与逆序对模型。</li>\n<li><strong><a href=\"/posts/6c25457a/\">DSU System</a></strong>: 并查集的等价类维护与时光倒流技巧。</li>\n<li><strong><a href=\"/posts/621f0544/\">Monotonic Stack &amp; Queue</a></strong>: 线性结构的单调性维护。</li>\n<li><strong><a href=\"/posts/e6c1b327/\">Sparse Table &amp; Lifting</a></strong>: ST表与倍增思想。</li>\n</ul>\n<h4 id=\"📐-Basis-Dimension-Reduction-基石\">📐 <a href=\"/posts/c28314d6/\">Basis &amp; Dimension Reduction (基石)</a></h4>\n<ul>\n<li><strong><a href=\"/posts/fe091ad2/\">Optimization Map</a></strong>: 降维优化体系总览。</li>\n<li><strong><a href=\"/posts/66874f84/\">Binary Search System</a></strong>: 二分答案与单调性判定。</li>\n<li><strong><a href=\"/posts/b22c5db7/\">Static Array Opt</a></strong>: 前缀和与差分的对偶性。</li>\n<li><strong><a href=\"/posts/4775279/\">Two Pointers</a></strong>: 尺取法与双指针体系。</li>\n<li><strong><a href=\"/posts/ef28f194/\">Discretization</a></strong>: 离散化与值域映射。</li>\n</ul>\n<hr>\n<h3 id=\"🔬-Deep-Dives-精选综述\">🔬 Deep Dives (精选综述)</h3>\n<blockquote>\n<p><em>突破单一题目限制，构建“母题”网络。</em><br>\n<em>(注：以下条目直达 Atlas 中的核心综述文档)</em></p>\n</blockquote>\n<ul>\n<li><strong><a href=\"/posts/a049f02f/\">图论建模的多重面孔</a></strong>: 解析 <code>P1993</code> 与 <code>P2371</code> 背后的同构逻辑。</li>\n<li><strong><a href=\"/posts/6cf4c37c/\">背包问题的变奏曲</a></strong>: 当物品产生依赖或策略分组时，状态如何跃迁？</li>\n<li><strong><a href=\"/posts/517010cb/\">隐性单调性与队列优化</a></strong>: 如何在看似无序的 DP 中寻找单调的滑动窗口？</li>\n<li><strong><a href=\"/posts/f505e82a/\">线段树信息的维持与合并</a></strong>: GSS 系列问题的高阶处理。</li>\n</ul>\n<hr>\n<br>\n<blockquote>\n<p><strong>Bon Voyage.</strong><br>\n<em>Last Updated: 2025-12-12</em></p>\n</blockquote>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/92601886/"},{"title":"时间不是维度","content":"<h3 id=\"时间不是维度（Time-is-not-dimensions）\">时间不是维度（Time is not dimensions）</h3>\n<hr>\n<h4 id=\"相对论\">相对论</h4>\n<p>我曾一度对“此刻”感到怀疑。</p>\n<p>当我第一次了解到“闵可夫斯基时空观”时，我不寒而栗。</p>\n<p>狭义相对论告诉我们：空间和时间是一体的，共同组成了四维时空。</p>\n<p>而闵可夫斯基则更进一步说：过去、现在、未来<strong>并列存在</strong>于这个宏大的几何结构中。</p>\n<p>而我们的人生，我们所珍视的每一个“现在”——甚至整个宇宙的命运——早已写好。</p>\n<p>这就是著名的 <strong>块宇宙（Block Universe）</strong> 理论：</p>\n<p>它冰冷地宣称：未来是固定的。我们的自由意志只是一种幻觉。</p>\n<p>时间并不“流逝”，我们只是在体验一帧帧早已存在的“时空图像”。</p>\n<p>那一刻，我第一次感到一种<strong>来自宇宙</strong>的终极冰冷：</p>\n<p>如果未来早已注定，我的每个决定还有意义吗？</p>\n<p>我，是否只是在不断读取这份早已写好的“剧本”？</p>\n<hr>\n<h4 id=\"量子力学\">量子力学</h4>\n<p>后来，我听到了另一种声音。它来自宇宙中最微小，最不确定的角落。</p>\n<p>它轻声说：“未来不是写好的，是概率。”</p>\n<p>在它描述的世界里，一切在根本上是 <strong>不确定</strong> 的。</p>\n<p>海森堡不确定性原理（Heisenberg’s Uncertainty Principle）中，有一条是关于能量和时间的：</p>\n<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>E</mi><mo>⋅</mo><mi mathvariant=\"normal\">Δ</mi><mi>t</mi><mo>≥</mo><mfrac><mi mathvariant=\"normal\">ℏ</mi><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">\\Delta E \\cdot \\Delta t \\ge \\frac{\\hbar}{2}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0519em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3659em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">ℏ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>这个公式通常被解释为：我们无法在极短的“时间间隔”内，无限精确地知道一个系统“能量的变化”。</p>\n<p>这给了我一个强烈的启示，也许时间从来不是一个确切的维度，而是一种<strong>能量状态的产生过程</strong>。</p>\n<p>如果我们把不确定性稍加改写，就能得到一个惊人的结果：</p>\n<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>t</mi><mo>∼</mo><mfrac><mrow><mi>d</mi><mi>E</mi></mrow><mrow><mi mathvariant=\"normal\">Δ</mi><mi>E</mi></mrow></mfrac><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mi>t</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mo>∫</mo><mrow></mrow></msub><mfrac><mrow><mi>d</mi><mi>E</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">Δ</mi><mi>E</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">dt \\sim \\frac{dE}{\\Delta E} \\implies t(x) = \\int_{} \\frac{dE(x)}{\\Delta E(x)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-0.9119em;\"><span style=\"top:-1.088em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>这意味着什么?</p>\n<p>这意味着：<strong>时间并不是冰冷的坐标轴</strong>，而是整个系统每一次能量变化所留下的痕迹。</p>\n<p>能量波动越剧烈，时间越快；能量波动越稳定，时间也就越慢。</p>\n<p>时间，是万物从“可能”变为“现实”时，留下的温暖痕迹。</p>\n<hr>\n<h4 id=\"时间膨胀\">时间膨胀</h4>\n<p>这个猜想最奇妙的地方在于，它似乎能与那个让我感到冰冷的相对论，“殊途同归”。</p>\n<p>狭义相对论的著名结论是“时间膨胀”（Time Dilation）：</p>\n<ul>\n<li><strong>物体运动速度越快，其自身的时间流逝得越慢。</strong></li>\n</ul>\n<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>γ</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>1</mn><mo>+</mo><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><mi>v</mi></mrow><msub><mi>v</mi><mi>c</mi></msub></mfrac></mrow></msqrt></mfrac><mo>≈</mo><msqrt><mrow><mn>1</mn><mo>−</mo><mfrac><msup><mi>v</mi><mn>2</mn></msup><msup><mi>c</mi><mn>2</mn></msup></mfrac></mrow></msqrt><mo>=</mo><mfrac><mn>1</mn><mi>γ</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{d\\gamma}{dt} = \\frac{1}{\\sqrt{1 + \\frac{\\Delta v}{v_c}}} \\approx \\sqrt{1 - \\frac{v^2}{c^2}} = \\frac{1}{\\gamma}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0514em;vertical-align:-1.73em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.1986em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1986em;\"><span class=\"svg-align\" style=\"top:-3.8em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8723em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Δ</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.1586em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.88em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.88em\" viewbox=\"0 0 400000 1944\" preserveaspectratio=\"xMinYMin slice\"><path d=\"M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6414em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.4286em;\"><span class=\"pstrut\" style=\"height:3.1986em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8756em;\"><span class=\"pstrut\" style=\"height:3.1986em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.73em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.44em;vertical-align:-0.7406em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6994em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4171em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.6594em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"2.48em\" viewbox=\"0 0 400000 2592\" preserveaspectratio=\"xMinYMin slice\"><path d=\"M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7406em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2019em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>稍加梳理得到：</p>\n<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><msup><mi>t</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>γ</mi><mi mathvariant=\"normal\">Δ</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta t&#x27; = \\gamma \\Delta t\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\">Δ</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">t</span></span></span></span></span></p>\n<p>其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span> 是洛伦兹因子</p>\n<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>γ</mi><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>1</mn><mo>−</mo><mfrac><msup><mi>v</mi><mn>2</mn></msup><msup><mi>c</mi><mn>2</mn></msup></mfrac></mrow></msqrt></mfrac></mrow><annotation encoding=\"application/x-tex\">\\gamma = \\frac{1}{\\sqrt{1 - \\frac{v^2}{c^2}}}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0514em;vertical-align:-1.73em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.2707em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2707em;\"><span class=\"svg-align\" style=\"top:-3.8em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9164em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7463em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7463em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.2307em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.88em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.88em\" viewbox=\"0 0 400000 1944\" preserveaspectratio=\"xMinYMin slice\"><path d=\"M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5693em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.5007em;\"><span class=\"pstrut\" style=\"height:3.2707em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.9477em;\"><span class=\"pstrut\" style=\"height:3.2707em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.73em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>也就是说：</p>\n<p>不用假设光速不变，也不用先建立四维时空，</p>\n<p>仅仅只是从“能量变化” <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> “时间流速” 的假设中出发，就能推导出相对论中的时间膨胀。</p>\n<p>高速 μ 子寿命变长、GPS 卫星时间变慢 …… 这些现象，似乎也可以从“能量状态”的角度得到一种富有诗意的解释。</p>\n<p>上个世纪，爱因斯坦从“光速不变”的几何公设出发；而如今，我们从“能量波动”的量子猜想出发。</p>\n<p>竟然，都走到了同一个终点。</p>\n<hr>\n<h4 id=\"未来\">未来</h4>\n<p>在这个视角下，那些曾让我恐惧的问题，也有了清晰的答案：</p>\n<p>未来是否已经被书写好？</p>\n<p><em>答：从未，因为未来不是时空的一部分，它尚未发生。</em></p>\n<p>那我问你，时间是什么？</p>\n<p><em>答：时间是能量不断变化的过程。是波函数不断坍缩的过程。</em></p>\n<p>为什么时间只向前？</p>\n<p><em>答：因为能量只能从高态走向低态，熵增的方向，是万物寻找归宿的方向，也成了时间的方向。</em><br>\n<em>也许，就像水总是流向低处，风总是抚平山丘。</em></p>\n<p>问：那我们的自由意志呢？</p>\n<p><em>答：它是“受物理规则约束的概率自由”。它正是那股最关键的能量波动。</em></p>\n<p>我们的每一次心动，每一次思考，每一个微不足道的选择，</p>\n<p>本质上，都是在向着这个充满可能性的宇宙，投入我们自己的能量。</p>\n<p>是我们在推动“概率”的坍缩。</p>\n<p><strong>我们不是在“读取”未来，而是在“创造”未来。</strong></p>\n<hr>\n<h4 id=\"时间不是维度（Time-is-not-dimensions）-2\">时间不是维度（Time is not dimensions）</h4>\n<p>我们不是活在一个早已固定的四维宇宙胶片里，等待播片员的放映。</p>\n<p>我们活在一个此时此刻、不断被“生成”的宇宙中。</p>\n<p>过去，早已经被能量写下。</p>\n<p>现在，是能量坍缩的瞬间。</p>\n<p>而未来，是无数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 未定的波动，还在等待我们去激发。</p>\n<p>时间不是舞台，而是演出本身。</p>\n<p>宇宙也不是一部电影，而是一部正在被我们续写的剧本。</p>\n<hr>\n<p>如果说爱因斯坦让我们知道：时间不是绝对的。</p>\n<p>那么量子力学也许提醒我们：时间甚至都不是提前存在的。</p>\n<p>我们的每一次选择、每一次思考、每一次能量的跃迁，</p>\n<p>都是在宇宙这张画布上，</p>\n<p>亲手把“可能”变成“现实”。</p>\n<p>这不仅是物理学，</p>\n<p>更是我们存在的方式。</p>\n<hr>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/cfa6377b/"},{"title":"我从洛谷再出发","content":"<h2 id=\"重逢：我从-Luogu-再出发\">重逢：我从 Luogu 再出发</h2>\n<p>我从未想过，当初一句不经意的<strong>再见</strong>，竟会演变成三年漫长的<strong>永别</strong>。<br>\n更不曾料到，这片我单方面认定的“伤心之地”，如今竟又成了我坚定的<strong>重逢</strong>。</p>\n<p>物是人非，<strong>人去楼空</strong>。我变了，它也变了。但在我年少时，对计算机世界那份纯粹的好奇心，却始终未曾更改。</p>\n<p>三岁起，我便痴迷于4399，小小的 CD 播放器，乃至很多单机游戏。那种仿佛<strong>与生俱来</strong>的好奇心，注定了我与计算机世界的缘分。<br>\n奈何身处小县城，编程一度只是一个遥不可及的梦想。</p>\n<p>直到初中，一次偶然的机会，我加入了C++编程社团。每周三下午的那节活动课，<br>\n我总会迫不及待地“溜”进机房，那段略显贫瘠的语法学习，却是我的<strong>编程启蒙</strong>。</p>\n<p>故事的转折发生在初二末。整理书柜时，那本布满灰尘的教材让我猛然想起了<strong>OI竞赛</strong>。<br>\n当即，我决定暂缓提前批的准备，挤出零散的时间，备战不足一个月的 CSP-J。</p>\n<p>最终，我侥幸通过初赛，前往学军中学。在那里，我见到了许多真正的天才，他们口中所探讨的，虽然都是中文，实则是完全听不懂的“专业术语”。<br>\n置身于那片“天才的世界”，我深刻地感受到了自己与他们的差距，如同蚂蚁仰望着我一般。最终带着一个省二的成绩，我告别了中考。</p>\n<p>中考后的暑假，是我前十八年最<strong>享受</strong>的时光。我将整个假期奉献给了 OI，<br>\n在算法与数据结构的海洋中恣意徜徉，只因我在学习自己所热爱的知识。</p>\n<p>然而，命运总是在捉弄着世人。我所在的高中没有竞赛班、没有校队，这意味着我似乎连参赛资格都没有。<br>\n老师告诉我消息的时候，我没说什么，只是默默地关了机，离开了机房，悄悄把机房钥匙放在老师的办公桌上。<br>\n此后，我便再也没打开过 <strong>Luogu</strong>，不愿再触碰哪怕一点点算法，甚至不愿多看一眼电脑。</p>\n<p>当时发生的事情太多了，正值少年的我更是如此，但路还得走。<br>\n我将这份痛苦与不甘，打包进保险箱，扔入我的脑海最深处，不愿再回想起来。</p>\n<p>于是我单方面宣告了这段热爱的“永别”，决定不再重回这片<strong>伤心之地</strong>。</p>\n<hr>\n<p>与三年前那个意气风发的少年截然相反，如今的我反而展现出颓废与失败。<br>\n用心理学的概念来为自己辩解，这大概就是“习得性无助”吧。</p>\n<p>但缘分和内心深处的不甘，终究引导我回到了我的<strong>归宿</strong>。<br>\n一次阴差阳错的机会，我偶然了解到学校的<strong>校集训队</strong>，重新燃起了希望。</p>\n<p>三年的种种经历，使我的血液一度冰冷。我不甘心吗？，我真的甘心宿命吗？<br>\n当这股热血再次涌现，信念便彻底坚定。这一次，我带着更高的认知与能力，重新踏上了这条路。</p>\n<p>于是军训期间，我便开始在 OJ 上刷题。大概一个月后吧，差不多完成了我的康复训练。</p>\n<p>我逐渐崭露头角，也终于鼓起勇气，重新打开了这个被我亲手“单删”的平台——<strong>Luogu</strong>。</p>\n<p>重新接手过去的我留下的各种资料，<strong>2025，我从 Luogu 再出发。</strong></p>\n<hr>\n<p>我不知道这趟旅途的终点是否能为我带来世俗的价值。</p>\n<p>但就像花儿知道自己何时会盛开，却不知道蝴蝶何时会到来一样。</p>\n<p>那么，这一次，我只管尽力盛开。</p>\n<p>我将竭尽全力，弥补过去的遗憾。而这一次，我不再是孤身一人。</p>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/ab65d9e6/"},{"title":"00-Prologue","content":"<p>银辉倾泻而下，洒落在这座城市的每一个角落，穿透高楼大厦的缝隙，在熙熙攘攘的街道上流淌。喧嚣的声音中夹杂着欢笑与祝福，很难让人不联想到，此时此刻正是中秋时分。</p>\n<p>然而，在城市的一隅，一栋破旧建筑的天台上，一个身影与这热闹景象格格不入。她静静伫立在天台边缘，孤身凝视着下方的喧嚣。皎洁的月光温柔地洒在她的脸上，却难掩她眉间的愁绪，反而更添几分孤寂与哀伤。</p>\n<p>她抬起头，目光紧紧锁定那轮圆月，眼中闪烁着希冀的光芒。“月亮小姐，月亮小姐，”她轻声呢喃，“你说有人明明出生在满月，却取了弦月的名，这会不会很奇怪？”</p>\n<p>这个问题如同缠绕了十八年的藤蔓，年年发问，可也年年得不到回答，“月亮小姐，取这个名字的父母，究竟是怎么想的呢？谁的父母才这么取名字呀？好难猜啊。”</p>\n<p>天台陷入一片寂静，唯有少女与明月相对无言。突然，她的眼眶泛起泪光，声音颤抖着，带着几分质问，“为什么，为什么要丢下我一个人？既然不想要我，又为什么把我生下来？”</p>\n<p>片刻后，少女似是意识到自己的失态，深吸一口气，努力平复情绪，轻轻拭去泪水，对着月亮苦笑道：“害呀，又犯傻了，你又怎么能回答我的问题呢？再见了，月亮小姐！下次……下次你一定要告诉我答案哦！”她对着月亮挥了挥拳头，轻柔的动作完全看不出威胁。</p>\n<p>少女轻盈地站起身，轻轻拍打了拍身上的灰尘，像是把一整晚的苦恼都抖落了。转身准备离开时，一抹微光吸引了她的注意。天台角落，一本积满灰尘的书在月光的照耀下显得分外醒目，仿佛在呼唤着她。</p>\n<p>少女似乎好奇地眨了眨眼，确认自己没有看错，便迈步走上前，轻轻拍了拍书上的灰尘，像是在为它解封。书名“青……丘……秘传”像是施了魔法一样，少女的嘴巴不由自主地念出了这几个字，声音微微颤抖，透着一丝神秘的吸引力。</p>\n<p>就在她的指尖轻轻触碰到那粗糙略微泛黄的封皮时，奇迹发生了！书本仿佛被某种无形的力量唤醒，突然散发出一阵柔和的光芒。书页自顾自地翻开，好似潘多拉的魔盒。</p>\n<p>而青丘弦月的故事，也将就此展开。</p>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/ede8027c/"},{"title":"浪潮之巅","content":"<p><strong>了解这些IT巨头的兴衰史有什么意义吗？</strong></p>\n<p>读完最后吴军老师的后记，合上《浪潮之巅》的时候，心中震撼不已。其中最令我印象深刻的不是乔布斯、盖茨、郭士纳的传奇经历，而是那些隐藏在数据与兴衰背后的无情规律。其中最特殊的一条，便是近乎宿命化的“基因决定论”了。</p>\n<p>初读时，我仿佛穿越回了那个年代，作为一个旁观者见证着这一切，从AT&amp;T的百年兴衰，到IBM的保守，Wintel格局的展开，再到Google的悄然崛起。起初，我只是跟随作者的描述在几个巨头公司的历史中游走。</p>\n<p>但当我读到16章“信息产业的规律性”时，书中提出的定律却像一条脉络，将这些看似分离的公司发展史串联了起来。那些看似偶然的成败，实则早已被它们各自的“基因”所注定。</p>\n<p>一家公司的基因——它的企业文化、核心业务、商业模式——在它从小公司一步步走向巅峰的途中被固化，这套基因在它所在的领域完美地适应了市场发展，帮助它走向成功。然而，这也恰恰成了它下一次转型的最大枷锁。正如作者所言：成也萧何，败也萧何。</p>\n<p><strong>到底是什么让“基因决定论”如此致命？</strong></p>\n<p>答案是浪潮本身的力量。书中提到的“摩尔定律”和“反摩尔定律”，迫使英特尔这样的硬件公司，不得不以18个月为周期革命，否则营收额就会减半；而“安迪-比尔定律”则揭示了硬件性能的提升，总会被冗余的软件所吞噬，这驱使着整条产业链的不停更新迭代。这也解答了我很久以来的疑问，为什么科技更先进了，但APP越来越臃肿了，而且硬件价格为什么打不下来。</p>\n<p>而当巨头公司占据50%以上的市场，“诺威格定律”便注定了它们需要去寻求新的“增长点”。而这往往与它们自己的基因冲突。让我们举个几家公司的例子：</p>\n<p>首先是IBM的“大型机”和“服务企业”基因，导致它无法理解PC的消费市场，在个人主机战中被Apple和Wintel打败。其次是Microsoft的“卖软件”基因，想从每个人手上分一杯羹，这也使得它无法在“免费+服务”的互联网时代战胜Google。再就是Google的“信息处理”基因，注定了无法在“人际通信”领域大展拳脚，惨败Facebook。</p>\n<p><strong>这种“基因决定论”似乎太过于宿命化了，真的没有一家公司能逃过吗？</strong></p>\n<p>书中特意拿出一章来讲述成功的案例，比如诺基亚，从木工厂发展成为2G时代的手机之王，但因为新基因“功能机硬件”，却导致它无法理解iPhone带来的“智能手机=移动电脑”的新规则，在移动互联网的大浪潮中倒下。而3M公司看似不断迭代，恰恰是因为它的基因本就是“创新”本身。</p>\n<p><strong>这也不禁让我反思，公司自有基因，个人又何尝不是。</strong></p>\n<p>当我们过度依赖过去成功的经验，是否也会被自己的“基因”所困住，在浪潮中泯然众人。</p>\n<p>书中提到，当下正处在第三期信息革命末期与第四次智能革命的交替点。这是一个我们05后吃尽时代黑利的时代，也是“下一个Google”的时代，更是“乱世出英雄”的时代，。</p>\n<p>面对这个时代，我们很容易陷入“机械论”预测的悲观。比如，看到芯片走向物理极限，就感慨技术更迭无望。</p>\n<p>但信息时代的“三论”（信息论、控制论、系统论），恰恰为我们提供了最适合的思维武器。我们不能再依赖僵化的预测，而应学会通过“反馈”来进行动态调节。</p>\n<p>吴军老师在书中为普通人提供了一个思路：大多数人并不需要去改变底层算法，只需要学会“应用”新技术，就能在新时代找到自己的位置。就像工业革命时，你不需要会造发电机，只需要学会用电灯就行了。</p>\n<p><strong>这固然是一个很好的答案，但它并不是我想要的。</strong></p>\n<p>读懂了硅谷的兴衰，我才真正理解了“下一个Google”的含金量。我不甘于只做一个“应用者”。随波逐流不是我的归宿，我想做的，是去理解浪潮乃至引导浪潮，在“质的发展”上作出贡献。</p>\n<p>正如茨威格在《人类的群星闪耀时》中所写：“一个真正的具有世界历史意义的时刻，一个人类群星闪耀时刻出现以前，必然会有漫长的岁月无谓地流逝而去，在这种关键的时刻，那些平时慢慢悠悠顺序发生和并列发生的事，都压缩在这样一个决定一切的短暂时刻表现出来。这一时刻对世世代代作出不可改变的决定，它决定着一个人的生死，一个民族的存亡甚至整个人类的命运”。</p>\n<p>当今正处于百年未有之大变局，不就正处在那个“决定一切的短暂时刻”。这，就是我们的“群星闪耀时刻”！</p>\n<p>读完这本书，我更加明确了我的信念：知命不惧，日日自新！</p>\n<hr>\n<p>写在后面：非常感谢老师推荐的这本《浪潮之巅》！由于时间有限，我主要精读了上册，下册关于产业规律的探讨还只是匆匆略读了一遍，未能完全消化。但即便是这样，我也确实从中收获良多。这本书无论是在帮我理解IT行业，还是在认知整个世界的发展规律上，都带来了极大的启发。</p>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/19c9c7ed/"},{"title":"橙子汽水","content":"<h3 id=\"橙子汽水\">橙子汽水</h3>\n<p>今天路过便利店，一眼就看到了那种老式玻璃瓶装的橙子汽水。随手拿起一瓶去结账，扫码时才发现，价格已经涨到了六块。</p>\n<p>这个数字让我愣了一下。在我的记忆里，它好像永远都停在三块钱。</p>\n<p>思绪突然就回到了小时候。那天我手里紧紧攥着三枚硬币，站在小卖部前犹豫了很久。要知道，那时候一块钱能发10条短信，而这瓶橙子汽水，就意味着我要放弃和你聊三十次天的机会。</p>\n<p>可那天大概是太热了，手里的硬币都被捏出了汗。我最终还是没抵挡住眼前那份清凉的诱惑，买了汽水。当时我心里想着，反正来日方长，今天的短信没发，明天再发也是一样的。</p>\n<p>那时候真是傻得天真，总以为我们拥有挥霍不完的时间。</p>\n<p>在那样的年代里，手机屏幕很小，按键很硬，打字很慢。虽然那天我没发短信，但在更多平常的日子里，发给你的每一条信息，我都要在对话框里斟酌好久。</p>\n<p>那时候没什么零花钱，但快乐好像特别便宜。三块硬币，一声清脆的“噗呲”开瓶声，就能高兴一个下午。</p>\n<p>真怀念啊。那时候的喜欢，就像手里这瓶没开封的汽水。透明、简单，却不敢轻易说出口。每一次看向你，心里就像汽水一样被摇晃。于是不敢再多看一眼，生怕那些藏不住的心意，会像气泡一样不受控制地喷涌出来。</p>\n<p>依稀记得那时候自己挺傻的。总以为未来很远，总以为许多话可以留到以后慢慢说。</p>\n<p>后来啊，那个常去买汽水的书报亭拆了，变成了宽阔喧嚣的马路；我也换了崭新的智能手机，通讯变得无比便捷，再也不用计算短信的条数了。现在有了买得起很多瓶汽水的钱，却再也买不回当初那种，以为时间永远不够用、又永远用不完的心意了。</p>\n<p>也许人与人的缘分就是这样，像开了盖的汽水，投入再多热烈，最终也抵不过岁月的挥发。</p>\n<p>我其实并不后悔那瓶汽水最终跑光了气，变成了平淡的糖水。只是很奇怪，此刻我再喝下这口甜水时，怎么感觉像喝醉了一样呢？明明这里面，没有一点酒精啊。</p>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/42d63d0f/"},{"title":"月光沐浴的蝴蝶","content":"<p>你见过月光沐浴下的蝴蝶吗？</p>\n<p>记忆里上一次见到，好像还是小时候的生日。那时候，一只蝴蝶停驻在花朵上，清冷的月光打在它的翅膀上。在那一瞬间，它显得那样渺小，却又那样伟大。</p>\n<p>今晚的月亮，亮得有些不像话。许是因为生在中秋的缘故，我对这种圆满的意象总有一种天然的亲近。它悬在那里，充盈、从容，仿佛有着挥霍不完的能量。</p>\n<p>但也很奇怪，看着这样完美的月亮，我却感到一种深深的<strong>乏力</strong>。</p>\n<p>它像是一个太过耀眼的理想，悬在那里提醒我：我还不够圆满，不够亮，我的电量可能只有 20%。 我想做很多事，想把这份像月光一样美好的能量传递出去。但低头看看双手，手里只有微弱的一点点光。</p>\n<p><strong>在这巨大的光辉之下，我的这一点点“热爱”，显得多么渺小，又多么迟缓。</strong></p>\n<p>直到脑海中突然闪过这句话： <strong>“花儿知道自己什么时候会开，但不知道蝴蝶什么时候会来。”</strong></p>\n<p>花是不知道结果的。 它在深夜里张开花瓣，释放香气。它不知道那只蝴蝶会不会路过，也不知道蝴蝶会不会在它凋谢之前赶到。</p>\n<p>如果按照<strong>数学期望</strong>来计算，这完全是一场高风险的投资。既然蝴蝶可能不来，既然没人看见，既然我这么乏力，为什么还要开呢？</p>\n<p>但花还是开了。 不是为了蝴蝶，而是因为 <strong>“开花”本身，就是它热爱这个世界的方式</strong>。</p>\n<p>所谓热爱，不就是这样一种源于底层的本能吗？它是希望，是期盼，是即便只有万分之一的概率，也要加上那个 <code>true</code> 的决心。</p>\n<p>我们头顶的那些星星，其实也是一种 <strong>“不知道蝴蝶什么时候来”的花</strong>。</p>\n<p>它们在几百光年外燃烧，把光扔进虚空。这种光有着漫长的<strong>滞后性</strong>。它要走很久很久，久到恒星自己可能都熄灭了，久到沧海都变成了桑田。</p>\n<p>它们不知道这束光能不能到达地球，不知道有没有人会在今晚抬头，更不知道接收到这束光的人，心里是不是正下着一场大雨。</p>\n<p>但它们依然选择亮着。</p>\n<p>我想，这就是我想找的答案。 我不必成为月亮。我不必等到自己圆满无缺了、能量爆棚了，才去传递希望。</p>\n<p>我可以做那朵不知道结果的花，或者那颗有“时差”的星。 <strong>我负责盛开，负责发光。</strong> 至于蝴蝶什么时候来，至于这束光什么时候能照亮你——那是风的事情，是时间的事情。</p>\n<p>所以，今晚我不再焦虑了。 哪怕我很累，哪怕我的光很弱。我还是愿意把这一点点心意，像星光一样发射出去。</p>\n<p>它可能会迟到，可能会在途中遇到云层。 但只要它出发了，就有被看见的可能。</p>\n<p>如果你恰好路过，恰好接住了这束光。</p>\n<p><strong>愿你的旅途星光璀璨。</strong> <strong>愿你的蝴蝶终会抵达，愿你的夏日永不凋零。</strong></p>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/2ea33511/"},{"title":"复合模型综述 (Composite Models)","content":"<h2 id=\"1-体系融合\">1. 体系融合</h2>\n<p>在掌握了 [线性], [背包], [区间], [优化] 四大板块后，高阶题目往往不再是单一模型的直接应用，而是<strong>多种模型的复合</strong>或<strong>非典型转化</strong>。</p>\n<h2 id=\"2-经典案例解析\">2. 经典案例解析</h2>\n<h3 id=\"2-1-飞扬的小鸟-P1941-——-背包与状态机的共舞\">2.1 飞扬的小鸟 (P1941) —— 背包与状态机的共舞</h3>\n<ul>\n<li><strong>混合核心</strong>: <strong>完全背包 (上升)</strong> + <strong>0/1 背包 (下降)</strong>。</li>\n<li><strong>逻辑陷阱</strong>:\n<ul>\n<li>通常背包是一个物品选一次。这里是“上升”这个动作在同一列可以执行多次 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 完全背包。</li>\n<li>“下降”动作是被动的，且互斥 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 特殊转移。</li>\n<li><strong>天花板效应</strong>: 高度 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&gt;</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">&gt; m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> 强行变为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>。这破坏了背包的纯粹性，需要特殊处理边界。</li>\n</ul>\n</li>\n<li><strong>Atlas 映射</strong>: 归入 <code>02_Knapsack_Model</code> (Variant) 或作为线性递推的复杂状态机。</li>\n</ul>\n<h3 id=\"2-2-成绩排序-P2519-——-从二维偏序到区间调度\">2.2 成绩排序 (P2519) —— 从二维偏序到区间调度</h3>\n<ul>\n<li><strong>混合核心</strong>: <strong>二维 LIS</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <strong>区间 DP/调度</strong>。</li>\n<li><strong>逻辑链条</strong>:\n<ol>\n<li>原始问题是二维偏序 (找出最多的人说真话)。</li>\n<li>转化: 一个人说真话 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\iff</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> 他的排名固定在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>N</mi><mo>−</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a_i+1, N-b_i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>。</li>\n<li>进一步: 相同区间的人是等价的，取 <code>min(cnt, len)</code>。</li>\n<li>最终模型: 给定若干带权区间，选出不重叠的区间子集使权值最大 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 线性 DP (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>) 或 贪心。</li>\n</ol>\n</li>\n<li><strong>Atlas 映射</strong>: 展示了如何通过 <strong>转化 (Transformation)</strong> 将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 模型降维至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n<h3 id=\"2-3-管道取珠-P1758-——-平方的物理意义\">2.3 管道取珠 (P1758) —— 平方的物理意义</h3>\n<ul>\n<li><strong>混合核心</strong>: <strong>计数 DP</strong> + <strong>双线程 (Dual Thread)</strong>。</li>\n<li><strong>思维跃迁</strong>:\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∑</mo><msubsup><mi>a</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\sum a_i^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0728em;vertical-align:-0.2587em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span></span></span></span> 极其难算。</li>\n<li>物理意义: 两个人独立操作，输出序列完全一致的方案数。</li>\n<li>转化: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">dp[k][i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> (两人共取 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 个，A 取上管 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个，B 取上管 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 个)。</li>\n</ul>\n</li>\n<li><strong>Atlas 映射</strong>: 归入 <code>04_Optimization</code> (计数技巧)。</li>\n</ul>\n<h2 id=\"3-总结\">3. 总结</h2>\n<ul>\n<li><strong>模型不是孤岛</strong>。背包可以嵌入图论 (分层图)，倍增可以优化环形 DP。</li>\n<li><strong>P0 级能力</strong>: 不在于背诵板子，而在于识别出题目伪装下的<strong>核心拓扑结构</strong> (是链、是环、还是树?) 和 <strong>依赖关系</strong> (是无后效性、还是互斥?)。</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/8179d216/"},{"title":"线段树信息的维持与合并 (The Art of Push Up)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 探讨线段树在处理 <strong>&quot;非简单可加性信息&quot;</strong> 时的合并策略。从标量 (Scalar) 的最大子段和，进化到集合 (Set) 的动态连通性。</li>\n<li><strong>核心矛盾</strong>:\n<ul>\n<li>简单线段树: <code>sum = L.sum + R.sum</code> (独立性)。</li>\n<li>复杂线段树: 左右子区间不仅有独立贡献，还存在 <strong>&quot;跨界 (Cross-Boundary)&quot;</strong> 的交互。</li>\n</ul>\n</li>\n<li><strong>演进路线</strong>:\n<ul>\n<li><strong>Level 1 (GSS)</strong>: 维护 <code>lmax</code>, <code>rmax</code> 解决数值跨界问题。</li>\n<li><strong>Level 2 (Connectivity)</strong>: 维护 <code>L-Port</code>, <code>R-Port</code> 与 DSU 解决拓扑连接问题。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-Level-1-数值跨界-GSS-模型\">2. Level 1: 数值跨界 (GSS 模型)</h2>\n<h3 id=\"2-1-逻辑支点\">2.1 逻辑支点</h3>\n<p>在 <strong>最大子段和 (Maximum Subarray Sum)</strong> 问题中，区间最优解只有三种可能：</p>\n<ol>\n<li>完全在左儿子 (<code>L.dat</code>)。</li>\n<li>完全在右儿子 (<code>R.dat</code>)。</li>\n<li><strong>跨越中点</strong>: 左儿子的最大后缀 + 右儿子的最大前缀 (<code>L.rmax + R.lmax</code>)。</li>\n</ol>\n<p>为了支撑第 3 点，每个节点必须额外维护 &quot;前缀&quot; 与 &quot;后缀&quot; 信息，形成逻辑闭环。</p>\n<h3 id=\"2-2-状态转移方程\">2.2 状态转移方程</h3>\n<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>l</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>L</mi><mi mathvariant=\"normal\">.</mi><mi>l</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo separator=\"true\">,</mo><mtext> </mtext><mi>L</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>u</mi><mi>m</mi><mo>+</mo><mi>R</mi><mi mathvariant=\"normal\">.</mi><mi>l</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>r</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>R</mi><mi mathvariant=\"normal\">.</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo separator=\"true\">,</mo><mtext> </mtext><mi>R</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>u</mi><mi>m</mi><mo>+</mo><mi>L</mi><mi mathvariant=\"normal\">.</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">{</mo><mi>L</mi><mi mathvariant=\"normal\">.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mo separator=\"true\">,</mo><mtext> </mtext><mi>R</mi><mi mathvariant=\"normal\">.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mo separator=\"true\">,</mo><mtext> </mtext><mi>L</mi><mi mathvariant=\"normal\">.</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>+</mo><mi>R</mi><mi mathvariant=\"normal\">.</mi><mi>l</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">}</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=\"application/x-tex\">\\begin{cases}\nlmax = \\max(L.lmax, \\ L.sum + R.lmax) \\\\\nrmax = \\max(R.rmax, \\ R.sum + L.rmax) \\\\\ndat = \\max(\\{L.dat, \\ R.dat, \\ L.rmax + R.lmax\\})\n\\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.32em;vertical-align:-1.91em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-2.2em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-2.192em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.316em\" style=\"width:0.8889em\" viewbox=\"0 0 888.89 316\" preserveaspectratio=\"xMinYMin\"><path d=\"M384 0 H504 V316 H384z M384 0 H504 V316 H384z\"/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.316em\" style=\"width:0.8889em\" viewbox=\"0 0 888.89 316\" preserveaspectratio=\"xMinYMin\"><path d=\"M384 0 H504 V316 H384z M384 0 H504 V316 H384z\"/></svg></span></span><span style=\"top:-4.6em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.41em;\"><span style=\"top:-4.41em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">L</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.97em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.53em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">({</span><span class=\"mord mathnormal\">L</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">})</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.91em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<h2 id=\"3-Level-2-拓扑跨界-SegTree-DSU\">3. Level 2: 拓扑跨界 (SegTree + DSU)</h2>\n<h3 id=\"3-1-场景与痛点-TZOJ-5563\">3.1 场景与痛点 (TZOJ-5563)</h3>\n<ul>\n<li><strong>场景</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N \\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 网格，支持单点/整列翻转 0/1，求连通块个数。</li>\n<li><strong>痛点</strong>: 连通性不具备简单的加法性质。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> 区间的 2 个连通块和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> 区间的 2 个连通块合并，可能变成 3 个、2 个或 1 个，取决于 <strong>交界面 (Interface)</strong> 的连接情况。</li>\n</ul>\n<h3 id=\"3-2-解决方案-端口维护-Port-Maintenance\">3.2 解决方案: 端口维护 (Port Maintenance)</h3>\n<p>我们无法存储整个网格的连通状态，但根据 <strong>&quot;黑盒原理&quot;</strong>，父节点只关心子节点 <strong>边界</strong> 的连通性。</p>\n<ul>\n<li><strong>状态定义</strong>:\n<ul>\n<li><code>l_id[row]</code>: 该区间左边界第 <code>row</code> 行所属的连通块编号。</li>\n<li><code>r_id[row]</code>: 该区间右边界第 <code>row</code> 行所属的连通块编号。</li>\n<li><code>cnt</code>: 区间内部完全封闭的连通块数量。</li>\n</ul>\n</li>\n<li><strong>合并逻辑 (Push Up with DSU)</strong>:\n<ol>\n<li><strong>初始化</strong>: 将左右子节点的内部连通块数累加。</li>\n<li><strong>接口缝合</strong>: 遍历交界面 (即左儿子的右边界 vs 右儿子的左边界)。若 <code>L.r_id[i]</code> 与 <code>R.l_id[i]</code> 颜色相同且在 DSU 中未连通，则 <code>union</code> 它们，并将连通块总数 <code>-1</code>。</li>\n<li><strong>映射更新</strong>: 父节点的 <code>l_id</code> 来自左儿子的 <code>l_id</code> (经过 DSU 路径压缩)，父节点的 <code>r_id</code> 来自右儿子的 <code>r_id</code>。</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"3-3-实战代码核心-TZOJ-5563\">3.3 实战代码核心 (TZOJ-5563)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-8f7bdefe\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-8f7bdefe\">\n        <div class=\"fold-arrow\">▶</div>Code: Connectivity PushUp\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-8f7bdefe\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 核心：在 push_up 中跑并查集</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">push_up</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> ls = u &lt;&lt; <span class=\"hljs-number\">1</span>, rs = u &lt;&lt; <span class=\"hljs-number\">1</span> | <span class=\"hljs-number\">1</span>;<br>    <span class=\"hljs-type\">int</span> mid = ( tr[u].l + tr[u].r ) &gt;&gt; <span class=\"hljs-number\">1</span>;<br><br>    <span class=\"hljs-comment\">// 1. 继承基础计数</span><br>    tr[u].w = tr[ls].w + tr[rs].w; <span class=\"hljs-comment\">// w: 白块数量</span><br>    tr[u].b = tr[ls].b + tr[rs].b; <span class=\"hljs-comment\">// b: 黑块数量</span><br><br>    <span class=\"hljs-comment\">// 2. 重置并查集映射 (只关心边界相关的点)</span><br>    <span class=\"hljs-comment\">// 注意：这里不能全局 init，而是根据子节点边界信息建立临时 DSU 关系</span><br>    <span class=\"hljs-comment\">// TZOJ 题解中采用了一种特定 trick: 使用全局 fa 数组但在 push_up 中局部复用</span><br>    <span class=\"hljs-comment\">// 更通用的做法是每次 merge 建立新的映射关系</span><br>    <br>    <span class=\"hljs-comment\">// 3. 缝合交界面 (Stitching Interface)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>    &#123;<br>        <span class=\"hljs-comment\">// 检查中轴线 (mid, mid+1) 的颜色是否一致</span><br>        <span class=\"hljs-keyword\">if</span>( G[i][mid] == G[i][mid<span class=\"hljs-number\">+1</span>] ) <br>        &#123;<br>            <span class=\"hljs-comment\">// 获取交界面两侧的连通分量 ID</span><br>            <span class=\"hljs-type\">int</span> root_L = <span class=\"hljs-built_in\">find</span>( tr[ls].rnum[i] ); <br>            <span class=\"hljs-type\">int</span> root_R = <span class=\"hljs-built_in\">find</span>( tr[rs].lnum[i] );<br><br>            <span class=\"hljs-keyword\">if</span>( root_L != root_R ) <br>            &#123;<br>                fa[root_L] = root_R; <span class=\"hljs-comment\">// 合并</span><br>                <span class=\"hljs-comment\">// 连通块减少</span><br>                <span class=\"hljs-keyword\">if</span>( G[i][mid] == <span class=\"hljs-number\">0</span> ) tr[u].w --;<br>                <span class=\"hljs-keyword\">else</span> tr[u].b --;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-comment\">// 4. 更新父节点边界 ID (Expose new ports)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>    &#123;<br>        tr[u].lnum[i] = <span class=\"hljs-built_in\">find</span>( tr[ls].lnum[i] ); <span class=\"hljs-comment\">// 左边界来自于左儿子</span><br>        tr[u].rnum[i] = <span class=\"hljs-built_in\">find</span>( tr[rs].rnum[i] ); <span class=\"hljs-comment\">// 右边界来自于右儿子</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-总结与对比\">4. 总结与对比</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">维度</th>\n<th style=\"text-align:left\"><strong>GSS (P4513)</strong></th>\n<th style=\"text-align:left\"><strong>Connectivity (TZOJ-5563)</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>合并对象</strong></td>\n<td style=\"text-align:left\">标量 (Sum/Max)</td>\n<td style=\"text-align:left\">集合 (DSU ID)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>跨界依据</strong></td>\n<td style=\"text-align:left\">算术加法 (<code>L.sum + R.sum</code>)</td>\n<td style=\"text-align:left\">几何相邻 (<code>G[i][mid] == G[i][mid+1]</code>)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>辅助信息</strong></td>\n<td style=\"text-align:left\">前缀/后缀最大值</td>\n<td style=\"text-align:left\">左/右边界连通 ID</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>复杂度</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>⋅</mo><mi>α</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\cdot \\alpha(N))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">))</span></span></span></span> (需遍历行)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>思维本质</strong></td>\n<td style=\"text-align:left\"><strong>数值传导</strong></td>\n<td style=\"text-align:left\"><strong>等价类合并</strong></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p><strong>Insight</strong>: 线段树的本质是 <strong>分治</strong>。只要能定义清楚 <strong>“如何从两个子状态推导出父状态”</strong> (<code>push_up</code>)，线段树就可以维护任何信息，包括图的连通性、线性基、甚至是矩阵乘法。</p>\n</blockquote>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/f505e82a/"},{"title":"图论：结构映射与状态流转 (Graph Guide)","content":"<blockquote>\n<p><strong>Philosophy</strong>: 一切皆图。不等式是图，同余系是图，矩阵变换也是图。<br>\n图论的本质是将<strong>离散的状态</strong> (Nodes) 与 <strong>逻辑的关系</strong> (Edges) 可视化，从而利用拓扑性质解决代数问题。</p>\n</blockquote>\n<h3 id=\"🌍-宏观视野-Overview-Modeling\">🌍 宏观视野 (Overview &amp; Modeling)</h3>\n<p>建模是图论的灵魂，优化是图论的骨架。</p>\n<ul>\n<li><strong><a href=\"/posts/bc189206/\">图论建模综述 (Graph Core Synthesis)</a></strong>: <strong>必读</strong>。解析图论建模的三大范式：差分约束（不等式映射）、同余最短路（数值折叠）、动态 Floyd（时间轴展开）。</li>\n<li><strong><a href=\"/posts/5c86f54/\">优化建图技巧 (Graph Optimization)</a></strong>: 当边数爆炸 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mo>≈</mo><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">M \\approx N^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>) 时的降维打击。涵盖虚拟节点 (Hub)、线段树优化建图、位运算隐式图。</li>\n</ul>\n<h3 id=\"🛣️-最短路与状态-Shortest-Path-States\">🛣️ 最短路与状态 (Shortest Path &amp; States)</h3>\n<p>最短路不仅是求距离，更是<strong>状态转移的最小代价</strong>。</p>\n<ul>\n<li><strong><a href=\"/posts/614a8671/\">最短路体系 (SSSP System)</a></strong>: Dijkstra、SPFA 与 Floyd 的逻辑支点，以及最短路图 (DAG) 的计数应用。</li>\n<li><strong><a href=\"/posts/2a513a9f/\">分层图最短路 (Layered Graph)</a></strong>: 处理“有限次免费/折扣”或“状态切换”的二维最短路模型。</li>\n<li><strong><a href=\"/posts/6cae5d5b/\">差分约束系统 (Difference Constraints)</a></strong>: 将形如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>u</mi></msub><mo>−</mo><msub><mi>X</mi><mi>v</mi></msub><mo>≤</mo><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">X_u - X_v \\le W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> 的代数不等式组转化为最短路模型。</li>\n</ul>\n<h3 id=\"🔗-连通性与遍历-Connectivity-Traversal\">🔗 连通性与遍历 (Connectivity &amp; Traversal)</h3>\n<p>研究图的<strong>结构特征</strong>，将环拆解，将图分层。</p>\n<ul>\n<li><strong><a href=\"/posts/dbe3a645/\">Tarjan SCC 与缩点 (Tarjan SCC)</a></strong>: <strong>必读</strong>。化环为链，将有向图转化为 DAG 进行 DP 或递推。</li>\n<li><strong><a href=\"/posts/d4dd66e8/\">传递闭包与Bitset优化 (Transitive Closure)</a></strong>: 利用 Bitset 并行加速，在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>3</mn></msup><mi mathvariant=\"normal\">/</mi><mi>w</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^3/w)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">)</span></span></span></span> 复杂度下解决稠密图的连通性查询。</li>\n<li><strong><a href=\"/posts/3fe2b20c/\">欧拉回路与路径 (Eulerian Path)</a></strong>: 边遍历问题（一笔画）。Hierholzer 算法的圈套圈逻辑。</li>\n</ul>\n<h3 id=\"🌳-树上问题-Tree-Algorithms\">🌳 树上问题 (Tree Algorithms)</h3>\n<p>树是特殊的图（<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 边，无环连通）。</p>\n<ul>\n<li><strong><a href=\"/posts/cd7fb2f0/\">MST体系与瓶颈路 (MST, LCA &amp; Bottleneck)</a></strong>: <strong>必读</strong>。最小生成树与 LCA 的结合，解决“路径最大边最小”的瓶颈路问题。包含 Kruskal 重构树。</li>\n<li><strong><a href=\"/posts/447bed30/\">树的直径与重心 (Tree Properties)</a></strong>: 树的“最长跨度”与“平衡中心”，点分治与树形 DP 的基础。</li>\n<li><strong><a href=\"/posts/5e08b96b/\">重链剖分 (HLD System)</a></strong>: 将树“线性化”为序列，结合线段树维护路径信息。</li>\n<li><strong><a href=\"/posts/4f9d9d38/\">树上差分 (Tree Difference)</a></strong>: 离线处理批量的树上路径修改任务。</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/4b02a8e5/"},{"title":"数据结构：信息的容器与维护 (DS Guide)","content":"<blockquote>\n<p><strong>Philosophy</strong>: 数据结构是对信息 (Info) 的封装。我们关注信息的合并 (Merge)、修改 (Update) 与查询 (Query)。</p>\n</blockquote>\n<h3 id=\"🌲-树形结构-Tree-Based\">🌲 树形结构 (Tree-Based)</h3>\n<ul>\n<li><strong><a href=\"/posts/33f15c14/\">线段树体系 (Segment Tree System)</a></strong>: 算子结合律与扫描线几何投影。</li>\n<li><strong><a href=\"/posts/eef750c1/\">树状数组体系 (BIT System)</a></strong>: 前缀和的二进制拆分与逆序对模型。</li>\n<li><strong><a href=\"/posts/8d4c9742/\">堆与优先队列 (Heap &amp; PriorityQueue)</a></strong>: 贪心算法的底层引擎。</li>\n<li><strong><a href=\"/posts/f505e82a/\">线段树信息的维持与合并 (The Art of Push Up)</a></strong>: GSS 系列高阶处理。</li>\n</ul>\n<h3 id=\"🔗-线性与集合-Linear-Set\">🔗 线性与集合 (Linear &amp; Set)</h3>\n<ul>\n<li><strong><a href=\"/posts/6c25457a/\">并查集体系 (DSU System)</a></strong>: 等价类维护、扩展域与时光倒流。</li>\n<li><strong><a href=\"/posts/621f0544/\">单调栈与单调队列 (Monotonic Stack &amp; Queue)</a></strong>: 维护序列中的最近更优元素 (NGE)。</li>\n</ul>\n<h3 id=\"⚡-倍增与高阶-Advanced\">⚡ 倍增与高阶 (Advanced)</h3>\n<ul>\n<li><strong><a href=\"/posts/e6c1b327/\">ST表与倍增 (Sparse Table &amp; Lifting)</a></strong>: 静态 RMQ 的倍增思想。</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/4bddc3c/"},{"title":"动态规划：从线性推演到维度打击 (DP Guide)","content":"<blockquote>\n<p><strong>Philosophy</strong>: 动态规划不是背模板，而是寻找 <strong>DAG (有向无环图)</strong> 上的最短路。</p>\n</blockquote>\n<h3 id=\"🏗️-核心体系-The-Core\">🏗️ 核心体系 (The Core)</h3>\n<ul>\n<li><strong><a href=\"/posts/1c960464/\">动态规划体系综述 (DP Core Synthesis)</a></strong>: 我们如何定义状态？如何保证无后效性？</li>\n<li><strong><a href=\"/posts/a164e19/\">线性序列体系 (Sequence System)</a></strong>: LIS/LCS 的线性变换与 Dilworth 定理。</li>\n<li><strong><a href=\"/posts/6cf4c37c/\">背包宇宙 (Knapsack Universe)</a></strong>: 从 01 到分组，万变不离“容量”限制。</li>\n<li><strong><a href=\"/posts/a75f3b7c/\">区间与环形体系 (Interval &amp; Ring System)</a></strong>: 破环成链与区间合并的拓扑序。</li>\n</ul>\n<h3 id=\"🚀-高阶优化-Optimization-Tricks\">🚀 高阶优化 (Optimization Tricks)</h3>\n<p><em>这是 P0 级选手的核心竞争力。</em></p>\n<ul>\n<li><strong>单调性</strong>:\n<ul>\n<li><a href=\"/posts/517010cb/\">隐性单调性与多路队列 (Implicit Monotonicity)</a></li>\n<li><a href=\"/posts/1bc8a91b/\">显性单调队列优化 (Explicit Queue Optimization)</a></li>\n</ul>\n</li>\n<li><strong>维度压缩</strong>:\n<ul>\n<li><a href=\"/posts/ec3ba026/\">状压与状态抽象 (State Compression)</a></li>\n<li><a href=\"/posts/c936ec9e/\">倍增优化策略 (Doubling Strategy)</a></li>\n<li><a href=\"/posts/f977dd98/\">结构优化与逆向思维 (Structure Tricks)</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"🧮-计数与组合-Counting\">🧮 计数与组合 (Counting)</h3>\n<ul>\n<li><strong><a href=\"/posts/21d85f4f/\">计数与组合体系 (Counting Methodology)</a></strong>: 容斥原理与组合数的艺术。</li>\n</ul>\n<h3 id=\"🔮-深度复盘-Retrospective\">🔮 深度复盘 (Retrospective)</h3>\n<ul>\n<li><strong><a href=\"/posts/8179d216/\">复合模型综述 (Composite Models)</a></strong>: 当背包遇到状态机，当偏序遇到数据结构。</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/9e0761d7/"},{"title":"基石算法：降维打击的起点 (Basis Guide)","content":"<blockquote>\n<p><strong>Philosophy</strong>: 所有高级算法都是基础思想的组合。</p>\n</blockquote>\n<h3 id=\"📉-降维优化-Dimension-Reduction\">📉 降维优化 (Dimension Reduction)</h3>\n<ul>\n<li><strong><a href=\"/posts/fe091ad2/\">降维优化体系 (Optimization Map)</a></strong>: 体系总览。</li>\n<li><strong><a href=\"/posts/b22c5db7/\">静态数组优化 (Prefix Sum &amp; Difference)</a></strong>: 前缀和与差分的对偶性。</li>\n<li><strong><a href=\"/posts/4775279/\">双指针 (Two Pointers)</a></strong>: 尺取法与滑动窗口。</li>\n<li><strong><a href=\"/posts/ef28f194/\">离散化 (Discretization)</a></strong>: 值域映射与相对排名。</li>\n</ul>\n<h3 id=\"🔍-排序与搜索-Sort-Search\">🔍 排序与搜索 (Sort &amp; Search)</h3>\n<ul>\n<li><strong><a href=\"/posts/66874f84/\">二分体系 (Binary Search System)</a></strong>: 二分答案与单调性判定。</li>\n<li><strong><a href=\"/posts/50dbb92c/\">基础排序体系 (Basic Sorting System)</a></strong>: 归并排序与逆序对统计。</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/c28314d6/"},{"title":"图论建模综述 (Graph_Modeling_Synthesis)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 将问题的 <strong>“状态”映射为节点</strong>，将 <strong>“关系/限制”映射为边</strong>。</li>\n<li><strong>物理图 vs 代数图</strong>:\n<ul>\n<li><strong>物理图</strong>: 节点代表位置，边代表通路。</li>\n<li><strong>代数图</strong>: 节点代表数值/状态，边代表转移逻辑/约束。</li>\n</ul>\n</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>复杂约束</strong>: 不等式组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 负环检测。</li>\n<li><strong>无限状态</strong>: 数轴 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 同余环。</li>\n<li><strong>动态过程</strong>: 时间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 阶段 (Floyd) 或 层级 (分层图)。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>三角不等式映射</strong>:\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub><mo>−</mo><msub><mi>x</mi><mi>u</mi></msub><mo>≤</mo><mi>w</mi><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><msub><mi>x</mi><mi>v</mi></msub><mo>≤</mo><msub><mi>x</mi><mi>u</mi></msub><mo>+</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">x_v - x_u \\le w \\iff x_v \\le x_u + w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>。对应边 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>→</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u \\to v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>，权值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>。（详见 <code>Difference_Constraints.md</code>）</li>\n</ul>\n</li>\n<li><strong>同余折叠 (Modulo Folding)</strong>:\n<ul>\n<li>问题: 求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mo>⋯</mo><mo>=</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">a_1 x_1 + \\dots = K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 的可行性。</li>\n<li>转化: 选最小系数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> 为模数，节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>…</mo><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">0 \\dots m-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 构成环。</li>\n</ul>\n</li>\n<li><strong>时间/阶段展开</strong>:\n<ul>\n<li>问题: 动态加点的最短路。</li>\n<li>转化: 利用 Floyd 最外层循环 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 的物理意义（允许经过前 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 个点）。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-同余最短路模型-P2371\">3.1 同余最短路模型 (P2371)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-65ad56e5\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-65ad56e5\">\n        <div class=\"fold-arrow\">▶</div>Code: Modulo Shortest Path\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-65ad56e5\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// m = a[1] (smallest coefficient)</span><br><span class=\"hljs-comment\">// Nodes: 0..m-1</span><br><span class=\"hljs-comment\">// dist[i]: 模 m 余 i 的数中，能凑出的最小值</span><br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">solve</span><span class=\"hljs-params\">( )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// ... Dijkstra Init ...</span><br>    <span class=\"hljs-keyword\">while</span>( ! q.<span class=\"hljs-built_in\">empty</span>( ) ) <br>    &#123;<br>        <span class=\"hljs-type\">int</span> u = q.<span class=\"hljs-built_in\">top</span>( ).second; q.<span class=\"hljs-built_in\">pop</span>( );<br>        <span class=\"hljs-keyword\">if</span>( vis[u] ) <span class=\"hljs-keyword\">continue</span>; <br>        <br>        <span class=\"hljs-comment\">// Try all other coefficients as edges</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">2</span>; i &lt;= n; ++ i ) <br>        &#123;<br>            <span class=\"hljs-type\">int</span> w = a[i];<br>            <span class=\"hljs-type\">int</span> v = ( u + w ) % m; <span class=\"hljs-comment\">// Modulo Transition</span><br>            <span class=\"hljs-keyword\">if</span>( dist[u] + w &lt; dist[v] ) <br>            &#123;<br>                dist[v] = dist[u] + w;<br>                q.<span class=\"hljs-built_in\">push</span>( &#123;dist[v], v&#125; );<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-动态时间轴-Floyd-P1119\">3.2 动态时间轴 Floyd (P1119)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Incremental Floyd\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// Queries sorted by time T</span><br><span class=\"hljs-type\">int</span> k = <span class=\"hljs-number\">0</span>;<br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-keyword\">auto</span>&amp; q : queries ) <br>&#123;<br>    <span class=\"hljs-comment\">// Unlock nodes up to time T</span><br>    <span class=\"hljs-keyword\">while</span>( k &lt; n &amp;&amp; node_time[k] &lt;= q.T ) <br>    &#123;<br>        <span class=\"hljs-comment\">// Use k as the intermediate pivot</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; n; ++ i )<br>        &#123;<br>            <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt; n; ++ j )<br>            &#123;<br>                dist[i][j] = <span class=\"hljs-built_in\">min</span>( dist[i][j], dist[i][k] + dist[k][j] );<br>            &#125;<br>        &#125;<br>        k ++;<br>    &#125;<br>    <span class=\"hljs-comment\">// Answer query using current dist[][]</span><br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>关联模型</strong>:</p>\n<ul>\n<li>\n<p><strong>分层图</strong>: 处理“k次机会”的状态分层（见 <code>Layered_Graph.md</code>）。</p>\n</li>\n<li>\n<p><strong>优化建图</strong>: 处理边数爆炸问题（见 <code>Graph_Optimization.md</code>）。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/bc189206/"},{"title":"差分约束系统 (Difference_Constraints)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 将形如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>u</mi></msub><mo>−</mo><msub><mi>X</mi><mi>v</mi></msub><mo>≤</mo><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">X_u - X_v \\le W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> 的不等式组转化为最短路问题。</li>\n<li><strong>转化</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>u</mi></msub><mo>≤</mo><msub><mi>X</mi><mi>v</mi></msub><mo>+</mo><mi>W</mi><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>u</mi><mo stretchy=\"false\">]</mo><mo>≤</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>v</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">X_u \\le X_v + W \\iff dist[u] \\le dist[v] + w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7073em;vertical-align:-0.024em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>。对应边 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>→</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">v \\to u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>，权值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>三角不等式</strong>: 最短路满足 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>v</mi><mo stretchy=\"false\">]</mo><mo>≤</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>u</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">dist[v] \\le dist[u] + w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>。</li>\n<li><strong>负环判定</strong>: 若图中存在负环，说明不等式组有冲突，<strong>无解</strong>。</li>\n<li><strong>超级源点</strong>: 建立 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 号点连向所有点，防止图不连通。</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Diff Constraints\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 核心: SPFA 判负环</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">bool</span> <span class=\"hljs-title\">spfa</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> n )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// ... init ...</span><br>    <span class=\"hljs-keyword\">while</span>( !q.<span class=\"hljs-built_in\">empty</span>() )<br>    &#123;<br>        <span class=\"hljs-type\">int</span> u = q.<span class=\"hljs-built_in\">front</span>(); q.<span class=\"hljs-built_in\">pop</span>(); in_queue[u] = <span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-keyword\">auto</span> &amp;e : adj[u] )<br>        &#123;<br>            <span class=\"hljs-keyword\">if</span>( dist[e.v] &gt; dist[u] + e.w )<br>            &#123;<br>                dist[e.v] = dist[u] + e.w;<br>                cnt[e.v] = cnt[u] + <span class=\"hljs-number\">1</span>;<br>                <span class=\"hljs-keyword\">if</span>( cnt[e.v] &gt; n ) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>; <span class=\"hljs-comment\">// 负环 -&gt; 无解</span><br>                <span class=\"hljs-keyword\">if</span>( !in_queue[e.v] ) &#123; q.<span class=\"hljs-built_in\">push</span>(e.v); in_queue[e.v] = <span class=\"hljs-number\">1</span>; &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>前置技巧</strong>: <strong>前缀和转化</strong>。区间和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>T</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[S, T]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">]</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">[</mo><mi>T</mi><mo stretchy=\"false\">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy=\"false\">[</mo><mi>S</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">Sum[T] - Sum[S-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>。</p>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[P5960]</strong>: 差分约束系统。</p>\n</li>\n<li>\n<p><strong>[P2294]</strong>: 狡猾的商人。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/6cae5d5b/"},{"title":"优化建图技巧 (Graph_Optimization)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 通过引入<strong>虚拟节点</strong>或数据结构，将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 的暴力连边降为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><strong>解决痛点</strong>: 集合连边、区间连边、位运算隐式图。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>虚拟节点 (Hub)</strong>:\n<ul>\n<li>场景: 集合 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 向集合 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> 连边。</li>\n<li>策略: 建立中转点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi></mrow><annotation encoding=\"application/x-tex\">O</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span></span></span></span>，连边 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>→</mo><mi>O</mi></mrow><annotation encoding=\"application/x-tex\">A \\to O</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">O \\to B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>。</li>\n</ul>\n</li>\n<li><strong>线段树优化</strong>:\n<ul>\n<li>场景: 点向区间连边。</li>\n<li>策略: 建立入树和出树，叶子为实际点。点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 连向入树的区间节点。</li>\n</ul>\n</li>\n<li><strong>隐式位运算图</strong>:\n<ul>\n<li>场景: 边权由 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>⊕</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u \\oplus v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊕</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 决定。</li>\n<li>策略: 仅当 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 二进制差一位时连边，最短路即为逐位修正的过程。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Virtual Node (P1983)\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 虚拟汇点: 优化 &quot;未停靠集合&quot; -&gt; &quot;停靠集合&quot; 的连边</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">build_virtual</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> train_id )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> virtual_node = n + train_id; <br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = start_stat; i &lt;= end_stat; ++ i )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( ! is_stop[i] ) <span class=\"hljs-built_in\">add_edge</span>( i, virtual_node, <span class=\"hljs-number\">0</span> );<br>        <span class=\"hljs-keyword\">else</span> <span class=\"hljs-built_in\">add_edge</span>( virtual_node, i, <span class=\"hljs-number\">1</span> );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[CF786B]</strong>: Legacy (线段树优化)。</p>\n</li>\n<li>\n<p><strong>[P1983]</strong>: 车站分级 (虚拟点)。</p>\n</li>\n<li>\n<p><strong>[P4366]</strong>: 最短路 (位运算)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/5c86f54/"},{"title":"分层图最短路 (Layered_Graph)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 将图复制 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">K+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 层，层间通过特定规则（如免费/状态改变）单向连接。</li>\n<li><strong>解决痛点</strong>: 二维 Dijkstra 状态。例如有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 次免费机会。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>状态升维</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>u</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">dist[u][k]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span></span></span></span> 表示到达 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 且消耗 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 次机会。</li>\n<li><strong>层间连边</strong>:\n<ul>\n<li>层内: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>k</mi></msub><mo>→</mo><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_k \\to v_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (权值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>)。</li>\n<li>层间: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>k</mi></msub><mo>→</mo><msub><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u_k \\to v_{k+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span> (权值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 或折扣)。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Layered Dijkstra\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// id(u, k) = u + k * n</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> k = <span class=\"hljs-number\">0</span>; k &lt;= K; ++ k )<br>&#123;<br>    <span class=\"hljs-comment\">// 1. 层内</span><br>    <span class=\"hljs-built_in\">add</span>( <span class=\"hljs-built_in\">id</span>(u, k), <span class=\"hljs-built_in\">id</span>(v, k), w );<br>    <span class=\"hljs-comment\">// 2. 层间 (免费)</span><br>    <span class=\"hljs-keyword\">if</span>( k &lt; K ) <span class=\"hljs-built_in\">add</span>( <span class=\"hljs-built_in\">id</span>(u, k), <span class=\"hljs-built_in\">id</span>(v, k<span class=\"hljs-number\">+1</span>), <span class=\"hljs-number\">0</span> );<br>&#125;<br><span class=\"hljs-comment\">// Ans: min( dist[t][0...K] )</span><br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[P4568]</strong>: 飞行路线。</p>\n</li>\n<li>\n<p><strong>[P4822]</strong>: 冻结。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/2a513a9f/"},{"title":"欧拉回路与路径 (Eulerian_Path)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 经过图中<strong>每条边恰好一次</strong>的路径。</li>\n<li><strong>解决痛点</strong>: “一笔画”问题，DNA 序列重组，词语接龙。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>度数不变量</strong>:\n<ul>\n<li><strong>有向图回路</strong>: 所有点 <code>in == out</code>。</li>\n<li><strong>有向图路径</strong>: 恰有 1 点 <code>out = in + 1</code> (起)，1 点 <code>in = out + 1</code> (终)。</li>\n</ul>\n</li>\n<li><strong>Hierholzer 算法 (圈套圈)</strong>:\n<ul>\n<li>核心: <strong>回溯时记录</strong>。</li>\n<li>只有当一个点无路可走（所有关联边都已遍历）时，才将其压入栈。最后逆序输出。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Hierholzer Vector\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// cur[u]: 当前弧优化，防止重复遍历边</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dfs</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">while</span>( cur[u] &lt; adj[u].<span class=\"hljs-built_in\">size</span>( ) )<br>    &#123;<br>        <span class=\"hljs-type\">int</span> v = adj[u][ cur[u] ];<br>        cur[u] ++; <span class=\"hljs-comment\">// 逻辑删边</span><br>        <span class=\"hljs-built_in\">dfs</span>( v );<br>    &#125;<br>    ans.<span class=\"hljs-built_in\">push</span>( u ); <span class=\"hljs-comment\">// 回溯入栈</span><br>&#125;<br><br><span class=\"hljs-comment\">// 主逻辑: 判度数 -&gt; 找起点 -&gt; DFS -&gt; 逆序输出</span><br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P7771]</strong>: 欧拉路径模板。</p>\n</li>\n<li>\n<p><strong>[Luogu P1341]</strong>: 无序字母对。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/3fe2b20c/"},{"title":"传递闭包与Bitset优化 (Transitive_Closure_Bitset)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 计算图中所有点对 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(u, v)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span></span></span></span> 是否可达。</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li>稠密图的连通性查询。</li>\n<li><strong>Bitset 优化</strong>: 将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 的 Floyd 优化 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>32</mn></mrow><annotation encoding=\"application/x-tex\">1/32</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/32</span></span></span></span> 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">1/64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/64</span></span></span></span>，解决 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>2000</mn></mrow><annotation encoding=\"application/x-tex\">N=2000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2000</span></span></span></span> 级别的问题。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>Floyd 变体</strong>: 若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 能到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>，且 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 能到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>，则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 能到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>。</li>\n<li><strong>行压缩</strong>: 用 <code>bitset&lt;N&gt; B[i]</code> 表示第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 行的状态（即 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 能到达的点集）。</li>\n<li><strong>并行计算</strong>: <code>if( B[i][k] ) B[i] |= B[k]</code>。意为：如果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 能到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>，那么 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 能到的所有点，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 也能到。</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Bitset Floyd\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// P4306 连通数</span><br>bitset&lt;2005&gt; f[<span class=\"hljs-number\">2005</span>];<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">solve</span><span class=\"hljs-params\">()</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> n; cin &gt;&gt; n;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i )<br>    &#123;<br>        string s; cin &gt;&gt; s;<br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt; n; ++ j )<br>            <span class=\"hljs-keyword\">if</span>( s[j] == <span class=\"hljs-string\">&#x27;1&#x27;</span> ) f[i][j<span class=\"hljs-number\">+1</span>] = <span class=\"hljs-number\">1</span>;<br>        f[i][i] = <span class=\"hljs-number\">1</span>; <span class=\"hljs-comment\">// 自己到自己</span><br>    &#125;<br>    <br>    <span class=\"hljs-comment\">// Floyd with Bitset</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> k = <span class=\"hljs-number\">1</span>; k &lt;= n; ++ k )<br>    &#123;<br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i )<br>        &#123;<br>            <span class=\"hljs-keyword\">if</span>( f[i][k] ) f[i] |= f[k];<br>        &#125;<br>    &#125;<br>    <br>    <span class=\"hljs-type\">int</span> ans = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) ans += f[i].<span class=\"hljs-built_in\">count</span>();<br>    cout &lt;&lt; ans &lt;&lt; <span class=\"hljs-string\">&#x27;\\n&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[P4306]</strong>: 连通数。</p>\n</li>\n<li>\n<p><strong>[B3611]</strong>: 传递闭包。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/d4dd66e8/"},{"title":"最短路体系 (SSSP_System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 在加权图中，寻找从源点到目标点总权值最小的路径。</li>\n<li><strong>核心机制</strong>: <strong>松弛 (Relaxation)</strong>。</li>\n<li><strong>算法选型</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">核心逻辑</th>\n<th style=\"text-align:left\">适用场景</th>\n<th style=\"text-align:left\">复杂度</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>Dijkstra</strong></td>\n<td style=\"text-align:left\"><strong>贪心</strong> + 优先队列</td>\n<td style=\"text-align:left\"><strong>非负权</strong>单源最短路</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>SPFA</strong></td>\n<td style=\"text-align:left\"><strong>队列</strong> + 反复入队</td>\n<td style=\"text-align:left\"><strong>负权</strong>边/判负环</td>\n<td style=\"text-align:left\">Avg <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(kM)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\">)</span></span></span></span>, Max <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(NM)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">NM</span><span class=\"mclose\">)</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>Floyd</strong></td>\n<td style=\"text-align:left\"><strong>DP</strong> + 阶段划分</td>\n<td style=\"text-align:left\"><strong>多源</strong>最短路 / 传递闭包</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>Dijkstra (确定的贪心)</strong>\n<ul>\n<li>将节点分为“已确定”和“未确定”。每次选出距离最小的未确定点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>，<strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 的最短路不可能再被后续节点优化</strong>（基于非负权前提）。</li>\n</ul>\n</li>\n<li><strong>SPFA (纠错的代价)</strong>\n<ul>\n<li>允许节点多次入队。如果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 的距离被更新（纠错），那么 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 的邻居可能也需要随之更新。</li>\n</ul>\n</li>\n<li><strong>Floyd (阶段性中转)</strong>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">dp[k][i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 表示“仅允许经过节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>…</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">1 \\dots k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 作为中转”的最短路。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-Dijkstra-标准模板\">3.1 Dijkstra (标准模板)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Dijkstra Heap\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// SSSP Template (Non-negative weights)</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dijkstra</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> st )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) dist[i] = INF, vis[i] = <span class=\"hljs-number\">0</span>;<br>    dist[st] = <span class=\"hljs-number\">0</span>;<br>    <br>    priority_queue&lt; PII, vector&lt; PII &gt;, greater&lt; PII &gt; &gt; pq;<br>    pq.<span class=\"hljs-built_in\">push</span>( &#123;<span class=\"hljs-number\">0</span>, st&#125; );<br>    <br>    <span class=\"hljs-keyword\">while</span>( ! pq.<span class=\"hljs-built_in\">empty</span>( ) ) <br>    &#123;<br>        <span class=\"hljs-keyword\">auto</span> [d, u] = pq.<span class=\"hljs-built_in\">top</span>( ); pq.<span class=\"hljs-built_in\">pop</span>( );<br>        <br>        <span class=\"hljs-keyword\">if</span>( vis[u] ) <span class=\"hljs-keyword\">continue</span>; <span class=\"hljs-comment\">// Lazy deletion</span><br>        vis[u] = <span class=\"hljs-number\">1</span>;<br>        <br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-keyword\">auto</span> [v, w] : adj[u] ) <br>        &#123;<br>            <span class=\"hljs-keyword\">if</span>( dist[u] + w &lt; dist[v] ) <br>            &#123;<br>                dist[v] = dist[u] + w;<br>                pq.<span class=\"hljs-built_in\">push</span>( &#123;dist[v], v&#125; );<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-SPFA-判负环\">3.2 SPFA (判负环)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: SPFA Queue\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// Negative Cycle Detection</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">bool</span> <span class=\"hljs-title\">spfa</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> st )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    queue&lt; <span class=\"hljs-type\">int</span> &gt; q;<br>    q.<span class=\"hljs-built_in\">push</span>( st ); vis[st] = <span class=\"hljs-number\">1</span>; dist[st] = <span class=\"hljs-number\">0</span>;<br>    <br>    <span class=\"hljs-keyword\">while</span>( ! q.<span class=\"hljs-built_in\">empty</span>( ) ) <br>    &#123;<br>        <span class=\"hljs-type\">int</span> u = q.<span class=\"hljs-built_in\">front</span>( ); q.<span class=\"hljs-built_in\">pop</span>( );<br>        vis[u] = <span class=\"hljs-number\">0</span>; <span class=\"hljs-comment\">// Not in queue now</span><br>        <br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-keyword\">auto</span> [v, w] : adj[u] ) <br>        &#123;<br>            <span class=\"hljs-keyword\">if</span>( dist[u] + w &lt; dist[v] ) <br>            &#123;<br>                dist[v] = dist[u] + w;<br>                cnt[v] = cnt[u] + <span class=\"hljs-number\">1</span>;<br>                <span class=\"hljs-keyword\">if</span>( cnt[v] &gt; n ) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>; <span class=\"hljs-comment\">// Negative Cycle</span><br>                <br>                <span class=\"hljs-keyword\">if</span>( ! vis[v] ) <br>                &#123;<br>                    q.<span class=\"hljs-built_in\">push</span>( v );<br>                    vis[v] = <span class=\"hljs-number\">1</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-3-Floyd-最小环变体\">3.3 Floyd (最小环变体)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-e064c6af\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-e064c6af\">\n        <div class=\"fold-arrow\">▶</div>Code: Floyd Variant\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-e064c6af\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// Floyd with Min-Cycle</span><br><span class=\"hljs-comment\">// k 必须在最外层</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> k = <span class=\"hljs-number\">1</span>; k &lt;= n; ++ k ) <br>&#123;<br>    <span class=\"hljs-comment\">// 1. Check Min Cycle (using nodes 1..k-1)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt; k; ++ i )<br>    &#123;<br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = i + <span class=\"hljs-number\">1</span>; j &lt; k; ++ j )<br>        &#123;<br>             ans = <span class=\"hljs-built_in\">min</span>( ans, dist[i][j] + mat[i][k] + mat[k][j] );<br>        &#125;<br>    &#125;<br>             <br>    <span class=\"hljs-comment\">// 2. Standard Relaxation</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i )<br>    &#123;<br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">1</span>; j &lt;= n; ++ j )<br>        &#123;<br>            dist[i][j] = <span class=\"hljs-built_in\">min</span>( dist[i][j], dist[i][k] + dist[k][j] );<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-高阶建模\">4. 高阶建模</h2>\n<ul>\n<li>\n<p><strong>最短路图</strong>: 原图中满足 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>w</mi><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>v</mi><mo separator=\"true\">,</mo><mi>T</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>=</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dist(S, u) + w + dist(v, T) == dist(S, T)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">==</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span></span></span></span> 的边构成的 DAG。用于路径计数。</p>\n</li>\n<li>\n<p><strong>分层图</strong>: 处理“有限次免费/折扣”状态（详见 <code>Layered_Graph.md</code>）。</p>\n</li>\n<li>\n<p><strong>差分约束</strong>: 处理不等式组（详见 <code>Difference_Constraints.md</code>）。</p>\n</li>\n</ul>\n<h2 id=\"5-知识粘附\">5. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P2829]</strong>: 大逃离 (次短路)。</p>\n</li>\n<li>\n<p><strong>[Luogu P2149]</strong>: Elaxia 的路线 (最短路图)。</p>\n</li>\n<li>\n<p><strong>[Luogu P5304]</strong>: 旅行者 (多源染色)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/614a8671/"},{"title":"Tarjan SCC 与缩点 (Tarjan_SCC)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 在有向图中，找到最大子图，使得子图中任意两点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 互相可达。</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>化环为链</strong>: 将有向有环图转化为 <strong>DAG</strong>。</li>\n<li><strong>传递性分析</strong>: 强连通分量内部的所有点在可达性上是等价的。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>dfn (物理时间)</strong>: 节点被 DFS 首次访问的时间戳。</li>\n<li><strong>low (回溯能力)</strong>: 节点通过有向边能回溯到的、且<strong>仍在栈中</strong>的最小 <code>dfn</code>。</li>\n<li><strong>SCC 根判定</strong>: <code>dfn[u] == low[u]</code>。说明 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 无法回到更早的祖先，栈中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 及其上方节点构成一个 SCC。</li>\n<li><strong>DAG 补全定理</strong>:\n<ul>\n<li>覆盖全图最少源点 = 入度为 0 的 SCC 数量。</li>\n<li>强连通最少加边 = <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mtext>in_zero</mtext><mo separator=\"true\">,</mo><mtext>out_zero</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\max( \\text{in\\_zero}, \\text{out\\_zero} )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">in_zero</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">out_zero</span></span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Tarjan SCC\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">tarjan</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    dfn[u] = low[u] = ++ idx;<br>    stk.<span class=\"hljs-built_in\">push</span>( u );<br>    in_stk[u] = <span class=\"hljs-literal\">true</span>;<br><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> v : adj[u] )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( ! dfn[v] )<br>        &#123;<br>            <span class=\"hljs-built_in\">tarjan</span>( v );<br>            low[u] = <span class=\"hljs-built_in\">min</span>( low[u], low[v] );<br>        &#125;<br>        <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>( in_stk[v] )<br>        &#123;<br>            <span class=\"hljs-comment\">// 返祖边: 只能用 dfn 更新</span><br>            low[u] = <span class=\"hljs-built_in\">min</span>( low[u], dfn[v] );<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">if</span>( dfn[u] == low[u] )<br>    &#123;<br>        ++ scc_cnt;<br>        <span class=\"hljs-type\">int</span> v;<br>        <span class=\"hljs-keyword\">do</span><br>        &#123;<br>            v = stk.<span class=\"hljs-built_in\">top</span>( );<br>            stk.<span class=\"hljs-built_in\">pop</span>( );<br>            in_stk[v] = <span class=\"hljs-literal\">false</span>;<br>            scc_id[v] = scc_cnt;<br>        &#125; <span class=\"hljs-keyword\">while</span>( v != u );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体</strong>:</p>\n<ul>\n<li><strong>割点/桥</strong>: 逻辑相似但无栈，判定条件为 <code>low[v] &gt;= dfn[u]</code>。</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P2812]</strong>: 校园网络 (DAG 补边)。</p>\n</li>\n<li>\n<p><strong>[Luogu P2341]</strong>: 受欢迎的牛 (缩点)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/dbe3a645/"},{"title":"MST体系与瓶颈路 (MST, LCA & Bottleneck)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>MST (最小生成树)</strong>: 图的<strong>稀疏化</strong>骨架。保留了图的连通性与瓶颈性质。</li>\n<li><strong>生态位细分</strong>:\n<ul>\n<li><strong>Kruskal</strong>: 稀疏图首选，易于编写，天然支持“重构树”。</li>\n<li><strong>Prim (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>)</strong>: <strong>稠密图</strong> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mo>≈</mo><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">M \\approx N^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>) 首选。</li>\n</ul>\n</li>\n<li><strong>LCA (最近公共祖先)</strong>: 树上路径信息的聚合点。</li>\n<li><strong>联合应用</strong>: <strong>瓶颈路问题</strong> —— 在多条路径中寻找“最大边最小”或“最小边最大”的路径。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>MST 的贪心本质</strong>:\n<ul>\n<li><strong>Kruskal (边优先)</strong>: 自下而上的合并。每选一条边，就是合并两个集合。</li>\n<li><strong>Prim (点优先)</strong>: 类似 Dijkstra。维护集合 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> 到外部 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>−</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">V-S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> 的最短边 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">dist</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span></span></span></span>。</li>\n</ul>\n</li>\n<li><strong>瓶颈路定理</strong>:\n<ul>\n<li>图中任意两点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 间路径的<strong>最大边权最小值</strong>，一定等于 MST 上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 路径的最大边权。</li>\n<li><em>转化</em>: 原图的最优路径问题 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> MST 上的 LCA 路径最值查询。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-Kruskal-稀疏图-标准\">3.1 Kruskal (稀疏图/标准)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Kruskal\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 适用于 M ~ N log N 或 M &lt;&lt; N^2</span><br><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Edge</span> &#123; <span class=\"hljs-type\">int</span> u, v, w; &#125;;<br><span class=\"hljs-type\">bool</span> <span class=\"hljs-keyword\">operator</span> &lt; ( <span class=\"hljs-type\">const</span> Edge&amp; a, <span class=\"hljs-type\">const</span> Edge&amp; b ) &#123; <span class=\"hljs-keyword\">return</span> a.w &lt; b.w; &#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">kruskal</span><span class=\"hljs-params\">( )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-built_in\">sort</span>( edges + <span class=\"hljs-number\">1</span>, edges + m + <span class=\"hljs-number\">1</span> );<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) fa[i] = i;<br>    <br>    <span class=\"hljs-type\">int</span> cnt = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= m; ++ i ) <br>    &#123;<br>        <span class=\"hljs-keyword\">auto</span> [u, v, w] = edges[i];<br>        <span class=\"hljs-type\">int</span> ru = <span class=\"hljs-built_in\">find</span>( u ), rv = <span class=\"hljs-built_in\">find</span>( v );<br>        <span class=\"hljs-keyword\">if</span>( ru != rv ) <br>        &#123;<br>            fa[ru] = rv;<br>            mst_weight += w;<br>            <span class=\"hljs-comment\">// add_tree_edge(u, v, w); // 建树用于 LCA</span><br>            <span class=\"hljs-keyword\">if</span>( ++ cnt == n - <span class=\"hljs-number\">1</span> ) <span class=\"hljs-keyword\">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-Prim-稠密图-邻接矩阵\">3.2 Prim (稠密图/邻接矩阵)</h3>\n<blockquote>\n<p><strong>关键</strong>: 使用 <code>vis</code> 数组和 <code>min_dist</code> 数组，不使用堆，严格 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>。</p>\n</blockquote>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Prim Dense\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// 适用于 N &lt;= 3000, M 极大</span><br><span class=\"hljs-type\">int</span> g[maxn][maxn]; <span class=\"hljs-comment\">// 邻接矩阵</span><br><span class=\"hljs-type\">int</span> min_dist[maxn]; <span class=\"hljs-comment\">// 点到当前生成树集合的最短距离</span><br><span class=\"hljs-type\">bool</span> vis[maxn];<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">prim</span><span class=\"hljs-params\">( )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-built_in\">memset</span>( min_dist, <span class=\"hljs-number\">0x3f</span>, <span class=\"hljs-keyword\">sizeof</span> min_dist );<br>    <span class=\"hljs-built_in\">memset</span>( vis, <span class=\"hljs-number\">0</span>, <span class=\"hljs-keyword\">sizeof</span> vis );<br>    <br>    min_dist[<span class=\"hljs-number\">1</span>] = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-type\">int</span> tot_weight = <span class=\"hljs-number\">0</span>;<br>    <br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; n; ++ i ) <span class=\"hljs-comment\">// 循环 n 次，每次加入一个点</span><br>    &#123;<br>        <span class=\"hljs-type\">int</span> u = <span class=\"hljs-number\">-1</span>;<br>        <span class=\"hljs-comment\">// 1. 寻找距离集合最近的未访问点</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">1</span>; j &lt;= n; ++ j )<br>        &#123;<br>            <span class=\"hljs-keyword\">if</span>( ! vis[j] &amp;&amp; ( u == <span class=\"hljs-number\">-1</span> || min_dist[j] &lt; min_dist[u] ) )<br>                u = j;<br>        &#125;<br>        <br>        <span class=\"hljs-keyword\">if</span>( u == <span class=\"hljs-number\">-1</span> || min_dist[u] == INF ) <span class=\"hljs-keyword\">break</span>; <span class=\"hljs-comment\">// 图不连通</span><br>        <br>        vis[u] = <span class=\"hljs-number\">1</span>;<br>        tot_weight += min_dist[u];<br>        <br>        <span class=\"hljs-comment\">// 2. 用新加入的点 u 更新其他点</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> v = <span class=\"hljs-number\">1</span>; v &lt;= n; ++ v )<br>        &#123;<br>            <span class=\"hljs-keyword\">if</span>( ! vis[v] &amp;&amp; g[u][v] &lt; min_dist[v] )<br>                min_dist[v] = g[u][v];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-3-瓶颈路应用-MST-LCA\">3.3 瓶颈路应用 (MST + LCA)</h3>\n<blockquote>\n<p>场景: 求两点间“最大边最小”的路径。</p>\n<p>流程: 建 MST <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> DFS 预处理倍增数组 max_w[u][i] <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> LCA 查询。</p>\n</blockquote>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-e064c6af\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-e064c6af\">\n        <div class=\"fold-arrow\">▶</div>Code: Bottleneck Query\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-e064c6af\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// DFS 预处理: f[u][i] 祖先, max_w[u][i] 路径最大边</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dfs</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> father, <span class=\"hljs-type\">int</span> w )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    dep[u] = dep[father] + <span class=\"hljs-number\">1</span>;<br>    f[u][<span class=\"hljs-number\">0</span>] = father;<br>    max_w[u][<span class=\"hljs-number\">0</span>] = w; <br><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt; <span class=\"hljs-number\">20</span>; ++ i ) <br>    &#123;<br>        f[u][i] = f[ f[u][i<span class=\"hljs-number\">-1</span>] ][ i<span class=\"hljs-number\">-1</span> ];<br>        max_w[u][i] = <span class=\"hljs-built_in\">max</span>( max_w[u][i<span class=\"hljs-number\">-1</span>], max_w[ f[u][i<span class=\"hljs-number\">-1</span>] ][ i<span class=\"hljs-number\">-1</span> ] );<br>    &#125;<br>    <span class=\"hljs-comment\">// ... 遍历子节点</span><br>&#125;<br><br><span class=\"hljs-comment\">// 查询 u, v 路径上的最大边</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">query_max</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> v )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( dep[u] &lt; dep[v] ) <span class=\"hljs-built_in\">swap</span>( u, v );<br>    <span class=\"hljs-type\">int</span> ans = <span class=\"hljs-number\">0</span>;<br>    <br>    <span class=\"hljs-comment\">// 1. 上跳对齐</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">19</span>; i &gt;= <span class=\"hljs-number\">0</span>; -- i )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( dep[ f[u][i] ] &gt;= dep[v] ) <br>        &#123;<br>            ans = <span class=\"hljs-built_in\">max</span>( ans, max_w[u][i] );<br>            u = f[u][i];<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">if</span>( u == v ) <span class=\"hljs-keyword\">return</span> ans;<br>    <br>    <span class=\"hljs-comment\">// 2. 同步上跳</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">19</span>; i &gt;= <span class=\"hljs-number\">0</span>; -- i )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( f[u][i] != f[v][i] ) <br>        &#123;<br>            ans = <span class=\"hljs-built_in\">max</span>( ans, <span class=\"hljs-built_in\">max</span>( max_w[u][i], max_w[v][i] ) );<br>            u = f[u][i];<br>            v = f[v][i];<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-comment\">// 最后还需要合并连接 LCA 的两条边</span><br>    ans = <span class=\"hljs-built_in\">max</span>( ans, <span class=\"hljs-built_in\">max</span>( max_w[u][<span class=\"hljs-number\">0</span>], max_w[v][<span class=\"hljs-number\">0</span>] ) );<br>    <span class=\"hljs-keyword\">return</span> ans;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-高阶建模\">4. 高阶建模</h2>\n<h3 id=\"4-1-Kruskal-重构树\">4.1 Kruskal 重构树</h3>\n<ul>\n<li>\n<p><strong>原理</strong>: 在 Kruskal 合并 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 时，不直接连边，而是新建虚点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> (点权为边权 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>)，令 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> 为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 所在集合根节点的父节点。</p>\n</li>\n<li>\n<p><strong>性质</strong>:</p>\n<ul>\n<li>\n<p>原图变为一棵有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2N-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 个节点的树（叶子为原图节点）。</p>\n</li>\n<li>\n<p>原图 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 所有路径瓶颈的最大值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\iff</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> 重构树上 <code>LCA(u, v)</code> 的点权。</p>\n</li>\n<li>\n<p>这是一个<strong>大顶堆</strong>（父节点权值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo></mrow><annotation encoding=\"application/x-tex\">\\ge</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span></span></span></span> 子节点）。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"5-知识粘附\">5. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>关联算法</strong>:</p>\n<ul>\n<li>\n<p><strong>DSU (并查集)</strong>: Kruskal 的基石。</p>\n</li>\n<li>\n<p><strong>次小生成树</strong>: 在 MST 基础上，枚举非树边 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(u, v)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span></span></span></span>，替换 MST 上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>→</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u \\to v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 路径的最大边。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1967]</strong>: 货车运输 (最大生成树 + LCA 瓶颈路)。</p>\n</li>\n<li>\n<p><strong>[POJ 1797]</strong>: Heavy Transportation (Prim 变体/瓶颈路)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/cd7fb2f0/"},{"title":"树的直径与重心 (Tree_Prop_Diameter_Centroid)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li>\n<p><strong>树的直径</strong>: 树上<strong>最长</strong>的简单路径。</p>\n<ul>\n<li><strong>痛点</strong>: 决定了树的“跨度”极限。常用于计算树上最远点对。</li>\n</ul>\n</li>\n<li>\n<p><strong>树的重心</strong>: 删除该点后，最大子树的节点数最小的点。</p>\n<ul>\n<li><strong>痛点</strong>: 树的分治中心。点分治的核心，保证递归层数稳定在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li>\n<p><strong>直径的端点特质</strong>: 从树上<strong>任意</strong>一点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 出发，能走到的最远节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>，一定是直径的一个端点。</p>\n<ul>\n<li><em>算法</em>: 两次 DFS。第一次找端点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>，第二次找另一端点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>。</li>\n</ul>\n</li>\n<li>\n<p><strong>重心的平衡特质</strong>: 重心 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> 满足 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>v</mi><mo>∈</mo><mi>s</mi><mi>o</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">{</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>v</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>N</mi><mo>−</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\max_{v \\in son(G)} \\{ size(v), N - size(G) \\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3552em;\"></span><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\">so</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">G</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">G</span><span class=\"mclose\">)}</span></span></span></span> 最小。</p>\n<ul>\n<li><em>性质</em>: 以重心为根，所有子树大小 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><mi>N</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\le N/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\">/2</span></span></span></span>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Tree Diameter & Centroid\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1. 直径 (Two-DFS)</span><br><span class=\"hljs-type\">int</span> max_len = <span class=\"hljs-number\">0</span>, endpoint = <span class=\"hljs-number\">0</span>;<br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dfs_diam</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> fa, <span class=\"hljs-type\">int</span> dist )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( dist &gt; max_len ) &#123; max_len = dist; endpoint = u; &#125;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-keyword\">auto</span> &amp;edge : adj[u] )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( edge.v != fa ) <span class=\"hljs-built_in\">dfs_diam</span>( edge.v, u, dist + edge.w );<br>    &#125;<br>&#125;<br><br><span class=\"hljs-comment\">// 2. 重心 (Centroid)</span><br><span class=\"hljs-type\">int</span> sz[maxn], max_part[maxn]; <br><span class=\"hljs-type\">int</span> root = <span class=\"hljs-number\">0</span>; <span class=\"hljs-comment\">// max_part[0] = INF</span><br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">get_root</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> fa, <span class=\"hljs-type\">int</span> total_n )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    sz[u] = <span class=\"hljs-number\">1</span>; max_part[u] = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> v : adj[u] )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( v == fa ) <span class=\"hljs-keyword\">continue</span>;<br>        <span class=\"hljs-built_in\">get_root</span>( v, u, total_n );<br>        sz[u] += sz[v];<br>        max_part[u] = <span class=\"hljs-built_in\">max</span>( max_part[u], sz[v] );<br>    &#125;<br>    max_part[u] = <span class=\"hljs-built_in\">max</span>( max_part[u], total_n - sz[u] );<br>    <span class=\"hljs-keyword\">if</span>( max_part[u] &lt; max_part[root] ) root = u;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体</strong>: <strong>树的中心</strong> (直径中点) vs <strong>重心</strong> (质量中心)。</p>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[SP1437]</strong>: Longest path in a tree (直径模板)。</p>\n</li>\n<li>\n<p><strong>[P1395]</strong>: 会议 (重心性质应用)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/447bed30/"},{"title":"重链剖分 (Tree_HLD_System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 将边分为<strong>重边</strong>和<strong>轻边</strong>，将树剖分为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 条链，使其“线性化”。</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>树上路径修改</strong>: 结合线段树，维护路径上的点权/边权。</li>\n<li><strong>LCA</strong>: 相比倍增，常数更小，且支持修改。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>重儿子</strong>: 子树大小 (<code>size</code>) 最大的子节点。</li>\n<li><strong>重链连续性</strong>: 重链上的 DFS 序是<strong>连续</strong>的。这是线段树能维护区间的根本原因。</li>\n<li><strong>跳链逻辑</strong>:\n<ul>\n<li>若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u, v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 不在同一重链，选择链头 (<code>top</code>) 深度较深的点，跳到 <code>top</code> 的父节点。</li>\n<li>循环直到二者在同一条链。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: HLD Template\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// DFS 1: sz, dep, fa, son</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dfs1</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> f, <span class=\"hljs-type\">int</span> d )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    dep[u] = d; fa[u] = f; sz[u] = <span class=\"hljs-number\">1</span>;<br>    <span class=\"hljs-type\">int</span> max_sz = <span class=\"hljs-number\">-1</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> v : adj[u] )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( v == f ) <span class=\"hljs-keyword\">continue</span>;<br>        <span class=\"hljs-built_in\">dfs1</span>( v, u, d + <span class=\"hljs-number\">1</span> );<br>        sz[u] += sz[v];<br>        <span class=\"hljs-keyword\">if</span>( sz[v] &gt; max_sz ) &#123; max_sz = sz[v]; son[u] = v; &#125;<br>    &#125;<br>&#125;<br><br><span class=\"hljs-comment\">// DFS 2: top, dfn (Priority: Heavy Son)</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dfs2</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> tp )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    top[u] = tp; dfn[u] = ++ idx; <br>    <span class=\"hljs-keyword\">if</span>( ! son[u] ) <span class=\"hljs-keyword\">return</span>;<br>    <span class=\"hljs-built_in\">dfs2</span>( son[u], tp ); <span class=\"hljs-comment\">// 重儿子优先</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> v : adj[u] )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( v != fa[u] &amp;&amp; v != son[u] ) <span class=\"hljs-built_in\">dfs2</span>( v, v );<br>    &#125;<br>&#125;<br><br><span class=\"hljs-comment\">// LCA</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">lca</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> v )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">while</span>( top[u] != top[v] )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( dep[ top[u] ] &lt; dep[ top[v] ] ) <span class=\"hljs-built_in\">swap</span>( u, v );<br>        u = fa[ top[u] ];<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> dep[u] &lt; dep[v] ? u : v;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>竞品</strong>: <strong>倍增 LCA</strong> (静态)，<strong>LCT</strong> (动态树)。</p>\n</li>\n<li>\n<p><strong>数据结构映射</strong>: 重链 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 序列区间。</p>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/5e08b96b/"},{"title":"动态规划体系综述 (DP Core Synthesis)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 通过<strong>记忆化 (Memoization)</strong> 或 <strong>递推 (Tabulation)</strong>，将指数级复杂度的搜索树剪枝为多项式级复杂度的<strong>有向无环图 (DAG)</strong> 的算法范式。</li>\n<li><strong>核心地位</strong>: 连接 <strong>搜索 (Search)</strong> 与 <strong>数学 (Math)</strong> 的桥梁。\n<ul>\n<li>相比搜索：通过记录消除了重叠子问题。</li>\n<li>相比贪心：保留了所有可能的最优分支，而非单步短视。</li>\n</ul>\n</li>\n<li><strong>三大公理</strong>:\n<ol>\n<li><strong>重叠子问题 (Overlapping Subproblems)</strong>: 暴力递归会反复计算相同状态。</li>\n<li><strong>最优子结构 (Optimal Substructure)</strong>: 全局最优解由局部最优解组合而成。</li>\n<li><strong>无后效性 (No-aftereffect)</strong>: &quot;未来&quot;只取决于&quot;现在&quot;，与&quot;过去&quot;无关。</li>\n</ol>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li>\n<p><strong>思考流 (The 4-Step Flow)</strong>:</p>\n<ol>\n<li><strong>State (状态)</strong>: 描述局面的最小参数集合 (e.g., <code>dp[i][j]</code>)。</li>\n<li><strong>Transition (转移)</strong>: 状态之间的因果关系 (e.g., <code>dp[i] = dp[i-1] + cost</code>).</li>\n<li><strong>Base Case (边界)</strong>: 递归的终止点或递推的起点 (e.g., <code>dp[0] = 0</code>).</li>\n<li><strong>Order (顺序)</strong>: 拓扑序，确保计算当前状态时，依赖项已知。</li>\n</ol>\n</li>\n<li>\n<p><strong>实现范式对比</strong>:</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">范式</th>\n<th style=\"text-align:left\">别名</th>\n<th style=\"text-align:left\">核心逻辑</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>递推</strong></td>\n<td style=\"text-align:left\">Bottom-Up</td>\n<td style=\"text-align:left\"><code>for</code> 循环遍历，空间换时间</td>\n<td style=\"text-align:left\">线性、区间、背包等拓扑序明确的模型</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>记忆化</strong></td>\n<td style=\"text-align:left\">Top-Down</td>\n<td style=\"text-align:left\"><code>DFS</code> + <code>memo</code> 数组</td>\n<td style=\"text-align:left\">树形、图上、博弈等状态依赖复杂或稀疏的模型</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-递推模板-Push-Pull\">3.1 递推模板 (Push/Pull)</h3>\n<ul>\n<li><strong>策略</strong>: 必须明确遍历顺序 (Order)。</li>\n<li><strong>Airy Style</strong>: 推荐使用 <code>1-based</code> 索引以简化边界判断。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Tabulation\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1. Init</span><br><span class=\"hljs-built_in\">memset</span>(dp, <span class=\"hljs-number\">0</span>, <span class=\"hljs-built_in\">sizeof</span>(dp)); <span class=\"hljs-comment\">// or INF for min-problems</span><br><br><span class=\"hljs-comment\">// 2. Stage &amp; State</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>&#123;<br>    <span class=\"hljs-comment\">// 3. Decision</span><br>    <span class=\"hljs-comment\">// dp[i] = max/min( ... )</span><br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-记忆化模板-Memoization\">3.2 记忆化模板 (Memoization)</h3>\n<ul>\n<li>\n<p><strong>策略</strong>: <strong>查表 (Lookup) -&gt; 计算 -&gt; 记录 (Record)</strong>。</p>\n</li>\n<li>\n<p><strong>优势</strong>: 只计算需要的状态，天然剪枝。</p>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Memoization\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-type\">int</span> memo[MAXN]; <span class=\"hljs-comment\">// Init to -1</span><br><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">dfs</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// 1. Base Case</span><br>    <span class=\"hljs-keyword\">if</span>( u == <span class=\"hljs-number\">0</span> ) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;<br>    <br>    <span class=\"hljs-comment\">// 2. Lookup</span><br>    <span class=\"hljs-keyword\">if</span>( memo[u] != <span class=\"hljs-number\">-1</span> ) <span class=\"hljs-keyword\">return</span> memo[u];<br>    <br>    <span class=\"hljs-comment\">// 3. Compute &amp; Record</span><br>    <span class=\"hljs-type\">int</span> res = ...; <span class=\"hljs-comment\">// Transition logic</span><br>    <span class=\"hljs-keyword\">return</span> memo[u] = res;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/1c960464/"},{"title":"背包宇宙 (Knapsack Universe)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 在<strong>有限容量</strong> (Capacity) 限制下，通过<strong>组合选择</strong>物品以达成最大价值 (Value) 的模型。</li>\n<li><strong>前置依赖</strong>: [枚举], [状态压缩], [离散化]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>资源分配</strong>: 典型如预算分配、时间管理。</li>\n<li><strong>子集和问题</strong>: 判定是否能凑出特定数值 (可行性背包/货币系统)。</li>\n<li><strong>策略博弈</strong>: 离散化后的策略选择 (排兵布阵)。</li>\n</ul>\n</li>\n<li><strong>本质</strong>: <strong>维度限制下的组合优化</strong>。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>循环方向决定复用性</strong>。\n<ul>\n<li><strong>倒序 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>→</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">V \\to w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>)</strong>: 隔离当前层影响 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\implies</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> 物品仅被选 <strong>1次</strong> (0/1 背包/分组背包)。</li>\n<li><strong>正序 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo>→</mo><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">w \\to V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>)</strong>: 利用当前层影响 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\implies</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> 物品可选 <strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>次</strong> (完全背包)。</li>\n</ul>\n</li>\n<li><strong>模型坍缩 (Collapse)</strong>:\n<ul>\n<li>所有背包问题最终都可归纳为 <strong>分组背包</strong> (互斥组) 或 <strong>0/1 背包</strong> (独立项)。</li>\n<li><strong>多重背包</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover><mo stretchy=\"true\" minsize=\"3.0em\">→</mo><mpadded width=\"+0.6em\" lspace=\"0.3em\"><mtext>二进制拆分</mtext></mpadded></mover></mrow><annotation encoding=\"application/x-tex\">\\xrightarrow{\\text{二进制拆分}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1113em;vertical-align:-0.011em;\"></span><span class=\"mrel x-arrow\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1003em;\"><span style=\"top:-3.322em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight x-arrow-pad\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord cjk_fallback mtight\">二进制拆分</span></span></span></span></span><span class=\"svg-align\" style=\"top:-2.689em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"hide-tail\" style=\"height:0.522em;min-width:1.469em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.522em\" viewbox=\"0 0 400000 522\" preserveaspectratio=\"xMaxYMin slice\"><path d=\"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.011em;\"><span></span></span></span></span></span></span></span></span> 0/1 背包。</li>\n<li><strong>依赖背包</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover><mo stretchy=\"true\" minsize=\"3.0em\">→</mo><mpadded width=\"+0.6em\" lspace=\"0.3em\"><mtext>打包组合</mtext></mpadded></mover></mrow><annotation encoding=\"application/x-tex\">\\xrightarrow{\\text{打包组合}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1113em;vertical-align:-0.011em;\"></span><span class=\"mrel x-arrow\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1003em;\"><span style=\"top:-3.322em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight x-arrow-pad\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord cjk_fallback mtight\">打包组合</span></span></span></span></span><span class=\"svg-align\" style=\"top:-2.689em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"hide-tail\" style=\"height:0.522em;min-width:1.469em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.522em\" viewbox=\"0 0 400000 522\" preserveaspectratio=\"xMaxYMin slice\"><path d=\"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.011em;\"><span></span></span></span></span></span></span></span></span> 分组背包。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-统一骨架-The-Unified-Bone\">3.1 统一骨架 (The Unified Bone)</h3>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Universal Knapsack\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1-based indexing preferred</span><br><span class=\"hljs-comment\">// dp array initialized to 0 (max value) or -INF (exact fill)</span><br><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i )      <span class=\"hljs-comment\">// Stage: 物品/组</span><br>&#123;<br>    <span class=\"hljs-comment\">// Mode Switch:</span><br>    <span class=\"hljs-comment\">// 01/Multi/Group -&gt; Reverse Loop (m -&gt; w)</span><br>    <span class=\"hljs-comment\">// Complete       -&gt; Forward Loop (w -&gt; m)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = m; j &gt;= w[i]; -- j ) <br>    &#123;<br>        <span class=\"hljs-comment\">// Decision: </span><br>        <span class=\"hljs-comment\">// 01/Complete: max(dp[j], dp[j-w] + v)</span><br>        <span class=\"hljs-comment\">// Group:       max(dp[j], dp[j-w_k] + v_k) for k in Group</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-二进制拆分-Binary-Splitting\">3.2 二进制拆分 (Binary Splitting)</h3>\n<ul>\n<li>\n<p><strong>策略</strong>: 将数量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span> 拆解为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>4</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msup><mn>2</mn><mi>k</mi></msup><mo separator=\"true\">,</mo><mtext>Remainder</mtext></mrow><annotation encoding=\"application/x-tex\">1, 2, 4, \\dots, 2^k, \\text{Remainder}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0435em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">Remainder</span></span></span></span></span>。利用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span> 的组合特性覆盖所有数量区间。</p>\n</li>\n<li>\n<p><strong>目的</strong>: 将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>⋅</mo><mi>V</mi><mo>⋅</mo><mi>C</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\cdot V \\cdot C)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span></span></span></span> 优化为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>⋅</mo><mi>V</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>C</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\cdot V \\cdot \\log C)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span></span></span></span>。</p>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Binary Split\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\">vector&lt;<span class=\"hljs-type\">int</span>&gt; W, V;<br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">add_item</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> w, <span class=\"hljs-type\">int</span> v, <span class=\"hljs-type\">int</span> c )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> k = <span class=\"hljs-number\">1</span>; k &lt;= c; k &lt;&lt;= <span class=\"hljs-number\">1</span> ) <br>    &#123;<br>        W.<span class=\"hljs-built_in\">push_back</span>( k * w );<br>        V.<span class=\"hljs-built_in\">push_back</span>( k * v );<br>        c -= k;<br>    &#125;<br>    <span class=\"hljs-keyword\">if</span>( c &gt; <span class=\"hljs-number\">0</span> ) <span class=\"hljs-comment\">// Handle Remainder</span><br>    &#123;<br>        W.<span class=\"hljs-built_in\">push_back</span>( c * w );<br>        V.<span class=\"hljs-built_in\">push_back</span>( c * v );<br>    &#125;<br>&#125;<br><span class=\"hljs-comment\">// Then run standard 0/1 Knapsack on W, V</span><br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 恰好装满 vs 不必装满</strong>:</p>\n<ul>\n<li>\n<p><strong>不必装满</strong>: 初始化 <code>dp[all] = 0</code> (求最大值)。</p>\n</li>\n<li>\n<p><strong>恰好装满</strong>: 初始化 <code>dp[0] = 0</code>, <code>dp[others] = -INF</code> (求合法最大值)。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>[坑点 2] 循环层级 (分组背包)</strong>:</p>\n<ul>\n<li>\n<p>必须遵循 <strong>组 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>) <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 容量 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>, 倒序) <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 组内决策 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>)</strong> 的顺序。</p>\n</li>\n<li>\n<p>若交换 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>，会导致“组内多选”，破坏互斥性。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<h3 id=\"4-1-核心变体-Variants\">4.1 核心变体 (Variants)</h3>\n<ul>\n<li>\n<p><strong>Dependency Variant (依赖背包 - P1064 金明的预算)</strong>:</p>\n<ul>\n<li>\n<p><em>逻辑</em>: 主件与附件绑定。</p>\n</li>\n<li>\n<p><em>转化</em>: 将 &quot;主件&quot;, &quot;主+附1&quot;, &quot;主+附2&quot;, &quot;主+1+2&quot; 视为<strong>同一个组</strong>内的 4 种互斥策略。</p>\n</li>\n<li>\n<p><em>部署</em>: 对每个主件构建分组，运行分组背包 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>⋅</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\cdot m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Nature Variant (性质背包 - P5020 货币系统)</strong>:</p>\n<ul>\n<li>\n<p><em>逻辑</em>: 小面额货币可以替代大面额。</p>\n</li>\n<li>\n<p><em>转化</em>: 排序。若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 能被 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mrow><mn>1</mn><mo>…</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">a_{1 \\dots i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"minner mtight\">…</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span> 组合表示 (即 <code>dp[a[i]] == true</code>)，则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 冗余。</p>\n</li>\n<li>\n<p><em>部署</em>: 这是一个 <strong>&quot;可行性判定&quot;</strong> 的 <strong>完全背包</strong> (Sieve Sytle)。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>Strategy Variant (策略背包 - P5322 排兵布阵)</strong>:</p>\n<ul>\n<li>\n<p><em>逻辑</em>: 投入兵力必须 <strong>严格大于</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><msub><mi>a</mi><mrow><mi>j</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">2 \\times a_{j,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> 才能得分。虽然兵力 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> 很大，但有效决策点有限。</p>\n</li>\n<li>\n<p><em>转化</em>: 对第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个城堡，将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span> 个对手的兵力排序。有效决策点仅为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><msub><mi>a</mi><mrow><mi>s</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2 \\times a_{sorted}[k] + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">sor</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>。</p>\n</li>\n<li>\n<p><em>部署</em>: 将每个城堡视为一个<strong>组</strong>，离散化后的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">s+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 种投入策略视为<strong>组内物品</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 分组背包 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>⋅</mo><mi>M</mi><mo>⋅</mo><mi>S</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\cdot M \\cdot S)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mclose\">)</span></span></span></span>。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"4-2-母题索引\">4.2 母题索引</h3>\n<ul>\n<li>\n<p><strong>[Luogu P1064]</strong>: 金明的预算方案 (依赖 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 分组)。</p>\n</li>\n<li>\n<p><strong>[Luogu P5020]</strong>: 货币系统 (完全背包筛法)。</p>\n</li>\n<li>\n<p><strong>[Luogu P5322]</strong>: 排兵布阵 (排序 + 离散化 + 分组)。</p>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/6cf4c37c/"},{"title":"线性序列体系 (Sequence System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 状态转移依赖于<strong>序列前缀/后缀</strong>的线性决策模型。</li>\n<li><strong>前置依赖</strong>: [基础 DP 概念], [二分查找]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>子序列问题</strong>: 在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> (贪心) 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (朴素) 内解决“最长”、“计数”等非连续子序列问题。</li>\n<li><strong>偏序关系</strong>: 处理元素间的相对大小顺序（如导弹拦截、排列匹配）。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">核心逻辑</th>\n<th style=\"text-align:left\">复杂度</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>LIS (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>)</strong></td>\n<td style=\"text-align:left\">朴素 DP</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>≤</mo><mn>5000</mn></mrow><annotation encoding=\"application/x-tex\">N \\le 5000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5000</span></span></span></span>，需记录具体方案</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>LIS (Greedy)</strong></td>\n<td style=\"text-align:left\">贪心 + 二分</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>≤</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">N \\le 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>，仅求长度/末尾状态</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>LCS</strong></td>\n<td style=\"text-align:left\">二维匹配</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">双序列匹配，一般无法优化到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> (除非转化为 LIS)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>&quot;Potential&quot; (潜能)</strong>。\n<ul>\n<li>在 LIS 中，长度相同时，<strong>结尾元素越小，后续增长的潜能越大</strong>。</li>\n<li>这将 DP 的“最优子结构”具象化为单调数组 <code>f[]</code>，从而引入二分查找优化。</li>\n</ul>\n</li>\n<li><strong>关键定理: Dilworth 定理</strong>:\n<ul>\n<li><strong>内容</strong>: 偏序集的最少链覆盖数 = 最长反链长度。</li>\n<li><strong>翻译 (P1020 导弹拦截)</strong>:\n<ul>\n<li><strong>覆盖</strong>: 用最少的不上升子序列覆盖整个序列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\iff</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> LIS (最长上升子序列) 的长度。</li>\n<li><strong>直觉</strong>: 每一套拦截系统（链）只能处理不上升导弹，要拦截所有导弹，系统数取决于“必须同时存在的上升点”（反链）。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-LIS-贪心优化模板-O-N-log-N\">3.1 LIS 贪心优化模板 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>)</h3>\n<ul>\n<li><strong>策略</strong>: 维护数组 <code>f[len]</code> 表示长度为 <code>len</code> 的 LIS 的<strong>最小结尾</strong>。<code>f</code> 必然单调递增。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: LIS (Greedy + Binary)\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 求解最长上升子序列长度</span><br><span class=\"hljs-comment\">// input: a[1...n]</span><br><span class=\"hljs-type\">int</span> x[maxn]; <span class=\"hljs-comment\">// 贪心数组 (f数组)</span><br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">solve</span><span class=\"hljs-params\">()</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> len = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>    &#123;<br>        <span class=\"hljs-comment\">// 若当前元素大于 f 末尾，直接延长 (Strictly Increasing)</span><br>        <span class=\"hljs-keyword\">if</span>( len == <span class=\"hljs-number\">0</span> || x[len] &lt; a[i] ) <br>        &#123;<br>            x[++len] = a[i];<br>        &#125;<br>        <span class=\"hljs-keyword\">else</span> <br>        &#123;<br>            <span class=\"hljs-comment\">// 否则，找到第一个 &gt;= a[i] 的位置替换，保留“更小结尾”的潜能</span><br>            <span class=\"hljs-comment\">// airy style: strictly increasing -&gt; lower_bound</span><br>            <span class=\"hljs-type\">int</span> k = <span class=\"hljs-built_in\">lower_bound</span>( x + <span class=\"hljs-number\">1</span>, x + len + <span class=\"hljs-number\">1</span>, a[i] ) - x;<br>            x[k] = a[i];<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-comment\">// ans = len</span><br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-LCS-转化为-LIS-排列特例\">3.2 LCS 转化为 LIS (排列特例)</h3>\n<ul>\n<li>\n<p><strong>场景</strong>: 当序列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A, B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> 均为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>∼</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1 \\sim N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 的<strong>排列</strong>时。</p>\n</li>\n<li>\n<p><strong>策略</strong>: 将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 映射为基准 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1, 2, \\dots, N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>，将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> 按映射规则转换，问题转化为求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>B</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">B&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span> 的 LIS。</p>\n</li>\n<li>\n<p><strong>复杂度</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo>→</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2) \\to O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</p>\n</li>\n</ul>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 严格性</strong>:</p>\n<ul>\n<li>\n<p><strong>LIS (Strict)</strong>: <code>a[i] &gt; f.back()</code> 且 <code>lower_bound</code> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo></mrow><annotation encoding=\"application/x-tex\">\\ge</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span></span></span></span>)。</p>\n</li>\n<li>\n<p><strong>Non-decreasing (LDS 反向)</strong>: <code>a[i] &gt;= f.back()</code> 且 <code>upper_bound</code> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">&gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&gt;</span></span></span></span>)。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>[坑点 2] 路径还原</strong>: 贪心法的 <code>f</code> 数组<strong>不是</strong>真实的 LIS 序列，仅用于计算长度。若需输出方案，需记录每个元素的前驱 <code>pre[i]</code>。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>Dilworth 对偶 (P1020)</strong>: 第一问求 LDS (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> DP 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 贪心)；第二问求“最少系统数”，根据 Dilworth 定理等价于求 LIS。</p>\n</li>\n<li>\n<p><strong>Bitwise LIS</strong>: 转移条件不是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i &lt; a_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>，而是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mi mathvariant=\"normal\">&amp;</mi><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">(a_i \\&amp; a_j) \\neq 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">&amp;</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>。需在位域 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>∼</mo><mn>30</mn></mrow><annotation encoding=\"application/x-tex\">0 \\sim 30</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">30</span></span></span></span>) 上定义状态 <code>dp[bit]</code>。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1020]</strong>: 导弹拦截 (LIS + Dilworth)。</p>\n</li>\n<li>\n<p><strong>[Luogu P1439]</strong>: 两个排列的 LCS (转化 LIS)。</p>\n</li>\n<li>\n<p><strong>[Luogu P2516]</strong>: LCS 长度 + 计数 (双重 DP)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/a164e19/"},{"title":"结构优化与逆向思维 (Structure & Reverse Logic)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 通过分析题目特定的<strong>物理约束</strong>或<strong>逻辑顺序</strong>，对 DP 的状态空间或转移路径进行剪枝和重构。</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>无效时间</strong>: 时间轴过长但事件稀疏 (P5017)。</li>\n<li><strong>耦合困境</strong>: 正向操作导致状态相互缠绕，无法拆分 (P5851)。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<h3 id=\"2-1-Path-Compression-路径压缩\">2.1 Path Compression (路径压缩)</h3>\n<ul>\n<li><strong>场景</strong>: P5017 摆渡车。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo>≤</mo><mn>4</mn><mo>×</mo><msup><mn>10</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">T \\le 4 \\times 10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span>，直接 DP <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(T)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span></span></span></span> 偏慢且空间大。</li>\n<li><strong>观察</strong>: 当两批人的到达间隔 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&gt;</mo><mn>2</mn><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">&gt; 2m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">m</span></span></span></span> 时，车往返一次 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>) 甚至两次 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">2m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">m</span></span></span></span>) 后，状态本质上“复位”了。中间的等待是无效的。</li>\n<li><strong>策略</strong>: 若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>&gt;</mo><mn>2</mn><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">t_i - t_{i-1} &gt; 2m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">m</span></span></span></span>，则强制将时间轴压缩，等效于平移 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> 压缩至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>⋅</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\cdot m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n<h3 id=\"2-2-Reverse-Logic-逆向分治\">2.2 Reverse Logic (逆向分治)</h3>\n<ul>\n<li><strong>场景</strong>: P5851 Greedy Pie Eaters。牛吃掉区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l, r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> 的派。正向枚举“谁先吃”会导致区间碎片化，难以描述。</li>\n<li><strong>转化</strong>: <strong>逆向枚举“最后被吃掉的派”</strong>。\n<ul>\n<li>考虑区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i, j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span>，枚举 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 是<strong>最后</strong>被吃掉的。</li>\n<li>这意味吃掉 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 的那头牛（覆盖 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>），将原问题完美切分为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i, k-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[k+1, j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 两个独立子问题。</li>\n</ul>\n</li>\n<li><strong>辅助 DP</strong>: 需要快速求“在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i, j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 内覆盖 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 的最大权值牛”，引入 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">g[i][j][k]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span></span></span></span> 进行预处理。</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-P5017-摆渡车优化模板\">3.1 P5017 摆渡车优化模板</h3>\n<ul>\n<li><strong>策略</strong>: 离散化(路径压缩) + 线性 DP。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-65ad56e5\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-65ad56e5\">\n        <div class=\"fold-arrow\">▶</div>Code: Path Compression\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-65ad56e5\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1. Compress Time</span><br><span class=\"hljs-keyword\">if</span>( a[i] - a[i<span class=\"hljs-number\">-1</span>] &gt; <span class=\"hljs-number\">2</span> * m ) <br>    offset += (a[i] - a[i<span class=\"hljs-number\">-1</span>] - <span class=\"hljs-number\">2</span> * m);<br>real_time[i] = a[i] - offset;<br><br><span class=\"hljs-comment\">// 2. DP Transfer</span><br><span class=\"hljs-comment\">// dp[i] = min cost to depart at time i</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt;= max_time; ++ i ) <br>&#123;<br>    <span class=\"hljs-comment\">// Pruning: if no one waits in (i-m, i], just inherit i-m</span><br>    <span class=\"hljs-keyword\">if</span>( i &gt;= m &amp;&amp; cnt[i] == cnt[i-m] ) <br>    &#123;<br>        dp[i] = dp[i-m]; <span class=\"hljs-keyword\">continue</span>;<br>    &#125;<br>    <span class=\"hljs-comment\">// Enumerating previous departure j in [i-2m, i-m]</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-built_in\">max</span>(<span class=\"hljs-number\">0</span>, i - <span class=\"hljs-number\">2</span> * m); j &lt;= i - m; ++ j )<br>        dp[i] = <span class=\"hljs-built_in\">min</span>( dp[i], dp[j] + <span class=\"hljs-built_in\">cost</span>(j, i) );<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-P5851-逆向区间模板\">3.2 P5851 逆向区间模板</h3>\n<ul>\n<li><strong>策略</strong>: 辅助数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span> (Rolling Array) + 区间 DP (Split Point)。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Reverse Interval\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// g[i][j][k]: max weight cow covering k inside [i, j]</span><br><span class=\"hljs-comment\">// dp[i][j]: max weight for interval [i, j]</span><br><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> len = <span class=\"hljs-number\">1</span>; len &lt;= n; ++ len ) <br>&#123;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i + len - <span class=\"hljs-number\">1</span> &lt;= n; ++ i ) <br>    &#123;<br>        <span class=\"hljs-type\">int</span> j = i + len - <span class=\"hljs-number\">1</span>;<br>        <span class=\"hljs-comment\">// 1. Maintain Aux g (Extension)</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> k = i; k &lt;= j; ++ k )<br>             g[i][j][k] = <span class=\"hljs-built_in\">max</span>(&#123;f[i][j], g[i<span class=\"hljs-number\">+1</span>][j][k], g[i][j<span class=\"hljs-number\">-1</span>][k]&#125;);<br>             <br>        <span class=\"hljs-comment\">// 2. Main DP (Split by k)</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> k = i; k &lt;= j; ++ k )<br>             dp[i][j] = <span class=\"hljs-built_in\">max</span>(dp[i][j], <br>                            dp[i][k<span class=\"hljs-number\">-1</span>] + dp[k<span class=\"hljs-number\">+1</span>][j] + g[i][j][k]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P5017]</strong>: 摆渡车 (路径压缩 + 线性优化)。</p>\n</li>\n<li>\n<p><strong>[Luogu P5851]</strong>: Greedy Pie Eaters (逆向分治 + 辅助 DP)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/f977dd98/"},{"title":"倍增优化策略 (Doubling Strategy)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 利用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span> 的跳跃特性，快速计算线性或环形结构上的<strong>多次状态转移</strong>。</li>\n<li><strong>前置依赖</strong>: [ST表], [最近公共祖先 (LCA)]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>长路径转移</strong>: 需要跳跃 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 次 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>≤</mo><msup><mn>10</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">N \\le 10^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>)，倍增降至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">\\log N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。</li>\n<li><strong>环形覆盖</strong>: 求最少多少个区间能覆盖环 (P6902)，暴力贪心 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>，倍增优化至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>&quot;Jump to the Limit&quot; (极限跳跃)</strong>。\n<ul>\n<li>如果我们知道“跳 1 步最远到哪”，我们就能知道“跳 2 步最远到哪” (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[i][1] = f[f[i][0]][0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mclose\">]]</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mclose\">]</span></span></span></span>)。</li>\n<li>进而知道“跳 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span> 步最远到哪”。</li>\n</ul>\n</li>\n<li><strong>关键模型</strong>:\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span>: 从点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 出发，跳 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>j</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span></span></span></span></span></span></span> 步能到达的最远位置 (或最优状态)。</li>\n<li><strong>拼凑</strong>: 任意步数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 都可以由二进制拆分，通过组合 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">\\log K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 时间内到达。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-环形区间覆盖-P6902-Surveillance\">3.1 环形区间覆盖 (P6902 Surveillance)</h3>\n<ul>\n<li><strong>问题</strong>: 给定环上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 个区间，求最小覆盖数。</li>\n<li><strong>转化</strong>:\n<ol>\n<li><strong>破环成链</strong>: 复制一倍 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>…</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1 \\dots 2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。</li>\n<li><strong>预处理</strong>: 对于每个点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>，贪心求出“跳 1 步”（即用 1 个区间）能覆盖到的最远右端点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。此步可用双指针 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 完成。</li>\n<li><strong>倍增构建</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mi>f</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[i][j] = f[f[i][j-1]][j-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>。</li>\n<li><strong>查询</strong>: 枚举起点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>，利用倍增试探，看最少跳几步能覆盖长度 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。</li>\n</ol>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Doubling Coverage\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1. Init Step 1 (Greedy + Two Pointers)</span><br><span class=\"hljs-comment\">// f[i][0] = max right end reachable from i using 1 interval</span><br><span class=\"hljs-type\">int</span> r = <span class=\"hljs-number\">0</span>, idx = <span class=\"hljs-number\">1</span>;<br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= <span class=\"hljs-number\">2</span>*n; ++ i ) &#123;<br>    <span class=\"hljs-keyword\">while</span>( idx &lt;= k &amp;&amp; intervals[idx].L &lt;= i ) &#123;<br>        r = <span class=\"hljs-built_in\">max</span>( r, intervals[idx].R + <span class=\"hljs-number\">1</span> );<br>        idx++;<br>    &#125;<br>    f[i][<span class=\"hljs-number\">0</span>] = r;<br>&#125;<br><br><span class=\"hljs-comment\">// 2. Build Doubling Table</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">1</span>; j &lt; LOG; ++ j )<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= <span class=\"hljs-number\">2</span>*n; ++ i )<br>        f[i][j] = f[ f[i][j<span class=\"hljs-number\">-1</span>] ][j<span class=\"hljs-number\">-1</span>];<br><br><span class=\"hljs-comment\">// 3. Query Min Steps</span><br><span class=\"hljs-type\">int</span> ans = INF;<br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) &#123; <span class=\"hljs-comment\">// Enumerate start point</span><br>    <span class=\"hljs-type\">int</span> cur = i, steps = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = LOG<span class=\"hljs-number\">-1</span>; j &gt;= <span class=\"hljs-number\">0</span>; -- j ) &#123;<br>        <span class=\"hljs-keyword\">if</span>( f[cur][j] &lt; i + n ) &#123; <span class=\"hljs-comment\">// Can&#x27;t cover full ring yet</span><br>            cur = f[cur][j];<br>            steps += (<span class=\"hljs-number\">1</span> &lt;&lt; j);<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-comment\">// Need one last step to complete cover</span><br>    <span class=\"hljs-keyword\">if</span>( f[cur][<span class=\"hljs-number\">0</span>] &gt;= i + n ) ans = <span class=\"hljs-built_in\">min</span>(ans, steps + <span class=\"hljs-number\">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>树上倍增</strong>: LCA, 树上路径权值和。</p>\n</li>\n<li>\n<p><strong>快速幂</strong>: 矩阵快速幂优化 DP 也是倍增思想的体现 (状态转移矩阵化)。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li><strong>[Luogu P6902]</strong>: Surveillance (环形覆盖 + 倍增)。</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/c936ec9e/"},{"title":"树上差分 (Tree_Difference)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 差分思想在树上的推广。</li>\n<li><strong>解决痛点</strong>: <strong>离线</strong>批量处理路径上的区间修改（<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">+K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>），最后一次性查询。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>影响的抵消</strong>: 在路径两端施加影响，在 <strong>LCA</strong> 处消除影响。</li>\n<li><strong>点差分</strong>:\n<ul>\n<li>修改 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>→</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u \\to v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 的点权。</li>\n<li>操作: <code>cnt[u]++</code>, <code>cnt[v]++</code>, <code>cnt[lca]--</code>, <code>cnt[fa[lca]]--</code>。</li>\n</ul>\n</li>\n<li><strong>边差分</strong>:\n<ul>\n<li>修改 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>→</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u \\to v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> 的边权（下放给深度深的节点）。</li>\n<li>操作: <code>cnt[u]++</code>, <code>cnt[v]++</code>, <code>cnt[lca]-=2</code>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Tree Difference\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 点差分示例: diff[u]++</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">add_path</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> v, <span class=\"hljs-type\">int</span> lca_node )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    diff[u] ++;<br>    diff[v] ++;<br>    diff[lca_node] --;<br>    diff[ fa[lca_node] ] --;<br>&#125;<br><br><span class=\"hljs-comment\">// 自底向上求前缀和</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dfs_sum</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> f )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> v : adj[u] )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( v == f ) <span class=\"hljs-keyword\">continue</span>;<br>        <span class=\"hljs-built_in\">dfs_sum</span>( v, u );<br>        diff[u] += diff[v];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[P3128]</strong>: Max Flow P (点差分)。</p>\n</li>\n<li>\n<p><strong>[P3258]</strong>: 松鼠的新家 (注意端点重复计算)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/4f9d9d38/"},{"title":"显性单调队列优化 (Explicit Queue Optimization)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 将 DP 转移方程转化为<strong>滑动窗口最值</strong>模型，利用单调队列 (Deque) 将转移复杂度从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>K</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(K)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mclose\">)</span></span></span></span> 降至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><strong>前置依赖</strong>: [单调队列基础], [同余分组]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>多重背包</strong>: 物品数量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span> 很大，二进制拆分 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>V</mi><mi>log</mi><mo>⁡</mo><mi>C</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(V \\log C)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span></span></span></span>) 依然超时，需优化至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>V</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(V)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><strong>定长区间最值</strong>: 在时间轴或环形路径上，决策点位于固定长度的过去区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>L</mi><mo separator=\"true\">,</mo><mi>i</mi><mo>−</mo><mi>R</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i-L, i-R]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">]</span></span></span></span> 内。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心公式</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>j</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mi>L</mi><mo separator=\"true\">,</mo><mi>R</mi><mo stretchy=\"false\">]</mo></mrow></msub><mo stretchy=\"false\">{</mo><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mtext>val</mtext><mo stretchy=\"false\">(</mo><mi>j</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo><mo>+</mo><mtext>const</mtext><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dp[i] = \\max_{j \\in [L, R]} \\{ dp[j] + \\text{val}(j) \\} + \\text{const}(i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3552em;\"></span><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">∈</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\">L</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">val</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)}</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">const</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span>\n<ul>\n<li>关键在于将依赖 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的项和依赖 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的项彻底分离。</li>\n<li>依赖 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的部分 <code>val(j)</code> 放入队列维护单调性。</li>\n</ul>\n</li>\n<li><strong>同余分组 (Congruence Splitting)</strong>:\n<ul>\n<li>场景: 背包类问题，转移仅发生在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>≡</mo><mi>k</mi><mspace></mspace><mspace width=\"0.4444em\"><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"><mi>w</mi><mo stretchy=\"false\">)</mo></mspace></mspace></mrow><annotation encoding=\"application/x-tex\">j \\equiv k \\pmod w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">)</span></span></span></span> 的状态链上。</li>\n<li>策略: 将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span> 数组按 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">%</mi><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">\\% w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">%</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 分为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 条独立的链，每条链单独跑单调队列。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-多重背包单调队列优化-P1776-宝物筛选\">3.1 多重背包单调队列优化 (P1776 宝物筛选)</h3>\n<ul>\n<li><strong>模型</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">{</mo><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mi>k</mi><mo>⋅</mo><mi>w</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>k</mi><mo>⋅</mo><mi>v</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">dp[j] = \\max \\{ dp[j - k \\cdot w] + k \\cdot v \\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">}</span></span></span></span></li>\n<li><strong>转化</strong>: 令 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>=</mo><mi>r</mi><mo>+</mo><mi>t</mi><mo>⋅</mo><mi>w</mi><mo separator=\"true\">,</mo><mtext> </mtext><msup><mi>k</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>t</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">j = r + t \\cdot w, \\ k&#x27; = t - k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>。\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>r</mi><mo>+</mo><mi>t</mi><mo>⋅</mo><mi>w</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">{</mo><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>r</mi><mo>+</mo><msup><mi>k</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>⋅</mo><mi>w</mi><mo stretchy=\"false\">]</mo><mo>−</mo><msup><mi>k</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>⋅</mo><mi>v</mi><mo stretchy=\"false\">}</mo><mo>+</mo><mi>t</mi><mo>⋅</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">dp[r + t \\cdot w] = \\max \\{ dp[r + k&#x27; \\cdot w] - k&#x27; \\cdot v \\} + t \\cdot v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span></li>\n<li>队列维护: <code>val(k') = dp[index] - index/w * v</code> 的最大值。</li>\n</ul>\n</li>\n<li><strong>复杂度</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>⋅</mo><mi>W</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\cdot W)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose\">)</span></span></span></span> (理论下界)。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Monotonic Knapsack\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 备份 dp 到 old_dp</span><br><span class=\"hljs-comment\">// 枚举余数 r (0 ~ w-1)</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> r = <span class=\"hljs-number\">0</span>; r &lt; w; ++ r ) <br>&#123;<br>    deque&lt;<span class=\"hljs-type\">int</span>&gt; q;<br>    <span class=\"hljs-comment\">// 遍历链: j = r, r+w, r+2w...</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = r; j &lt;= W; j += w ) <br>    &#123;<br>        <span class=\"hljs-comment\">// 1. Calc Value: old_dp[j] - (j/w)*v</span><br>        <span class=\"hljs-type\">int</span> val = <span class=\"hljs-built_in\">calc</span>(j);<br>        <br>        <span class=\"hljs-comment\">// 2. Push &amp; Maintain Monotonicity</span><br>        <span class=\"hljs-keyword\">while</span>( !q.<span class=\"hljs-built_in\">empty</span>() &amp;&amp; <span class=\"hljs-built_in\">calc</span>(q.<span class=\"hljs-built_in\">back</span>()) &lt;= val ) q.<span class=\"hljs-built_in\">pop_back</span>();<br>        q.<span class=\"hljs-built_in\">push_back</span>(j);<br>        <br>        <span class=\"hljs-comment\">// 3. Pop Outdated (Window Size: limit * w)</span><br>        <span class=\"hljs-keyword\">if</span>( q.<span class=\"hljs-built_in\">front</span>() &lt; j - limit * w ) q.<span class=\"hljs-built_in\">pop_front</span>();<br>        <br>        <span class=\"hljs-comment\">// 4. Update</span><br>        <span class=\"hljs-comment\">// dp[j] = best_val + (j/w)*v</span><br>        dp[j] = <span class=\"hljs-built_in\">calc</span>(q.<span class=\"hljs-built_in\">front</span>()) + (j/w) * v;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-环形滑动窗口-P1070-道路游戏\">3.2 环形滑动窗口 (P1070 道路游戏)</h3>\n<ul>\n<li>\n<p><strong>模型</strong>: 机器人在环上走 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>≤</mo><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">k \\le p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> 步。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mn>1</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">{</mo><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>k</mi><mo stretchy=\"false\">]</mo><mo>−</mo><mtext>cost</mtext><mo>+</mo><mtext>gain</mtext><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">dp[i] = \\max_{1 \\le k \\le p} \\{ dp[i-k] - \\text{cost} + \\text{gain} \\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">≤</span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\">cost</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">gain</span></span><span class=\"mclose\">}</span></span></span></span>。</p>\n</li>\n<li>\n<p><strong>难点</strong>: 这里的 <code>gain</code> 是斜向前缀和。但本质上，对于固定的出发点，随着时间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 增加，可选的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 构成了一个滑动的“时间窗口”。</p>\n</li>\n<li>\n<p><strong>策略</strong>: 对每个工厂维护一个单调队列，随着时间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的推移，将过期的决策弹出，取队首最优解。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1776]</strong>: 宝物筛选 (多重背包 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>W</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(NW)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose\">)</span></span></span></span>)。</p>\n</li>\n<li>\n<p><strong>[Luogu P1070]</strong>: 道路游戏 (环形 + 斜向窗口)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/1bc8a91b/"},{"title":"区间与环形体系 (Interval & Ring System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 状态定义在<strong>连续区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i, j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span></strong> 上，通过枚举<strong>分割点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></strong> 将大区间分裂为子区间的决策模型。</li>\n<li><strong>前置依赖</strong>: [线性 DP], [DFS 序]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>合并类问题</strong>: 石子合并、能量项链 (局部最优无法推导全局最优，必须枚举分割)。</li>\n<li><strong>递归结构</strong>: 括号匹配 (CF149D)、树的遍历序 (需结合递归性质)。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">拓扑序</th>\n<th style=\"text-align:left\">复杂度</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>线性 DP</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>→</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i \\to i+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> / <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">序列单向依赖</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>区间 DP</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>e</mi><mi>n</mi><mo>:</mo><mn>2</mn><mo>→</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">Len: 2 \\to N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> / <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>4</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">区间融合、括号匹配</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>区间 DP (优化)</strong></td>\n<td style=\"text-align:left\">四边形不等式</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">满足决策单调性 (如石子合并)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>&quot;Cellular Fusion&quot; (细胞融合)</strong>。\n<ul>\n<li>所有大区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i, j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 都是由小区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i, k]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[k+1, j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 融合而来。</li>\n<li><strong>上帝视角</strong>: 必须先计算所有长度为 2 的区间，再计算长度为 3 的… <strong>长度 (Length)</strong> 是 DP 的物理时间轴。</li>\n</ul>\n</li>\n<li><strong>关键技巧</strong>:\n<ul>\n<li><strong>破环成链 (Ring to Chain)</strong>:\n<ul>\n<li>环形问题无明确起点。</li>\n<li><strong>策略</strong>: 将数组复制一份接在后面 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>…</mo><mi>N</mi><mo>→</mo><mn>1</mn><mo>…</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1 \\dots N \\to 1 \\dots 2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>)，截取长度为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 的任意窗口即为一条链。</li>\n</ul>\n</li>\n<li><strong>递归与记忆化</strong>:\n<ul>\n<li>对于复杂的匹配规则 (如 CF149D)，迭代式写法极其痛苦。<strong>记忆化搜索 (Memoization)</strong> 是更优雅的实现，它自然契合“括号匹配”的递归定义。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-标准区间-DP-模板-O-N-3\">3.1 标准区间 DP 模板 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>)</h3>\n<ul>\n<li><strong>策略</strong>: <strong>Length-Driven</strong>。外层枚举长度，内层枚举左端点，最内层枚举分割点。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Interval DP\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// dp[i][j] 初始化: 0 或 INF</span><br><span class=\"hljs-comment\">// 1. Enumerate Length (Physical Time)</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> len = <span class=\"hljs-number\">2</span>; len &lt;= n; ++ len ) <br>&#123;<br>    <span class=\"hljs-comment\">// 2. Enumerate Left Endpoint</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i + len - <span class=\"hljs-number\">1</span> &lt;= n; ++ i ) <br>    &#123;<br>        <span class=\"hljs-type\">int</span> j = i + len - <span class=\"hljs-number\">1</span>; <span class=\"hljs-comment\">// Right Endpoint</span><br>        <br>        <span class=\"hljs-comment\">// 3. Enumerate Split Point k</span><br>        <span class=\"hljs-comment\">// [i, j] -&gt; [i, k] + [k+1, j]</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> k = i; k &lt; j; ++ k ) <br>        &#123;<br>            dp[i][j] = <span class=\"hljs-built_in\">min</span>( dp[i][j], dp[i][k] + dp[k<span class=\"hljs-number\">+1</span>][j] + <span class=\"hljs-built_in\">cost</span>(i, j) );<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-递归结构变体-CF149D-Coloring-Brackets\">3.2 递归结构变体 (CF149D Coloring Brackets)</h3>\n<ul>\n<li>\n<p><strong>场景</strong>: 括号匹配。区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l, r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> 的状态不仅取决于子区间，还取决于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> 的<strong>匹配关系</strong>及<strong>颜色约束</strong>。</p>\n</li>\n<li>\n<p><strong>策略</strong>: 使用 <code>dfs(l, r, color_l, color_r)</code> 进行记忆化搜索。</p>\n<ul>\n<li>\n<p><strong>Case 1 (Match)</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">l, r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> 匹配。递归 <code>dfs(l+1, r-1, ...)</code>。</p>\n</li>\n<li>\n<p><strong>Case 2 (Concat)</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">l, r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> 不匹配。找到分割点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mtext>match</mtext><mo stretchy=\"false\">[</mo><mi>l</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">k = \\text{match}[l]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">match</span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mclose\">]</span></span></span></span>，递归 <code>dfs(l, k, ...)</code> 和 <code>dfs(k+1, r, ...)</code>。</p>\n</li>\n</ul>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Memoization (Structure)\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// dp[l][r][cl][cr]: Interval [l,r] with colors cl, cr</span><br><span class=\"hljs-comment\">// match[i]: pair of i</span><br><br><span class=\"hljs-function\">ll <span class=\"hljs-title\">dfs</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> l, <span class=\"hljs-type\">int</span> r, <span class=\"hljs-type\">int</span> cl, <span class=\"hljs-type\">int</span> cr )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( dp[l][r][cl][cr] != <span class=\"hljs-number\">-1</span> ) <span class=\"hljs-keyword\">return</span> dp[l][r][cl][cr];<br>    <br>    ll ans = <span class=\"hljs-number\">0</span>;<br>    <br>    <span class=\"hljs-comment\">// Logic Branch: Nested vs Concatenated</span><br>    <span class=\"hljs-keyword\">if</span>( match[l] == r ) <span class=\"hljs-comment\">// Nested: ( A )</span><br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( !<span class=\"hljs-built_in\">check_valid</span>(cl, cr) ) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-comment\">// Enumerate inner colors</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> ncl = <span class=\"hljs-number\">0</span>; ncl &lt; <span class=\"hljs-number\">3</span>; ++ ncl )<br>            <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> ncr = <span class=\"hljs-number\">0</span>; ncr &lt; <span class=\"hljs-number\">3</span>; ++ ncr )<br>                 <span class=\"hljs-keyword\">if</span>( !<span class=\"hljs-built_in\">conflict</span>(cl, ncl) &amp;&amp; !<span class=\"hljs-built_in\">conflict</span>(cr, ncr) )<br>                     ans += <span class=\"hljs-built_in\">dfs</span>( l + <span class=\"hljs-number\">1</span>, r - <span class=\"hljs-number\">1</span>, ncl, ncr );<br>    &#125;<br>    <span class=\"hljs-keyword\">else</span> <span class=\"hljs-comment\">// Concatenated: A B</span><br>    &#123;<br>        <span class=\"hljs-type\">int</span> k = match[l];<br>        <span class=\"hljs-comment\">// Enumerate split colors</span><br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> mcl = <span class=\"hljs-number\">0</span>; mcl &lt; <span class=\"hljs-number\">3</span>; ++ mcl )<br>            <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> mcr = <span class=\"hljs-number\">0</span>; mcr &lt; <span class=\"hljs-number\">3</span>; ++ mcr )<br>                <span class=\"hljs-keyword\">if</span>( !<span class=\"hljs-built_in\">conflict</span>(mcl, mcr) )<br>                    ans += <span class=\"hljs-built_in\">dfs</span>( l, k, cl, mcl ) * <span class=\"hljs-built_in\">dfs</span>( k + <span class=\"hljs-number\">1</span>, r, mcr, cr );<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> dp[l][r][cl][cr] = ans % MOD;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 循环顺序</strong>: 必须先枚举 <code>len</code>。若先枚举 <code>i</code>，计算 <code>dp[i][j]</code> 时可能用到尚未计算的 <code>dp[k+1][j]</code> (若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>&gt;</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">k+1 &gt; i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6835em;vertical-align:-0.0391em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>)，导致错误。</p>\n</li>\n<li>\n<p><strong>[坑点 2] 环形空间</strong>: 破环成链时数组大小需开 <code>2*N</code>，且最终答案需遍历 <code>dp[i][i+n-1]</code> 取最优。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>费用提前 (关路灯 P1220)</strong>: 区间合并不仅有当前代价，还会影响“未被处理元素”的未来代价。需在状态中加入位置维度。</p>\n</li>\n<li>\n<p><strong>四边形不等式</strong>: 当代价函数满足 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>d</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>w</mi><mo stretchy=\"false\">(</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mo>≥</mo><mi>w</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>w</mi><mo stretchy=\"false\">(</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">w(a,d)+w(b,c) \\ge w(a,c)+w(b,d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span> 时，决策点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">K[i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 单调，优化至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1880]</strong>: 石子合并 (环形 + 区间基础)。</p>\n</li>\n<li>\n<p><strong>[CF 149D]</strong>: Coloring Brackets (结构化匹配 + 记忆化)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/a75f3b7c/"},{"title":"状压与状态抽象 (State Compression & Abstraction)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 通过<strong>二进制位</strong>或<strong>数学抽象</strong>来压缩高维状态的 DP 技术。</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>集合状态</strong>: 某个集合中的元素“选或不选” (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>N</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span></span></span></span>)。</li>\n<li><strong>数值特性</strong>: 转移条件依赖于数值的二进制位 (P4310)。</li>\n<li><strong>对称冗余</strong>: 状态看似不同但功能等价 (P2051)。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<h3 id=\"2-1-Bitwise-Domain-从位置到值域\">2.1 Bitwise Domain (从位置到值域)</h3>\n<ul>\n<li><strong>场景</strong>: P4310 绝世好题。求子序列满足 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mi mathvariant=\"normal\">&amp;</mi><msub><mi>a</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo mathvariant=\"normal\">≠</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">a_i \\&amp; a_{i-1} \\ne 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">&amp;</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>。</li>\n<li><strong>转化</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 的 <code>dp[i]</code> (以位置 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 结尾) <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log A)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span> 的 <code>dp[bit]</code> (以第 <code>bit</code> 位为 1 的数值结尾)。</li>\n<li><strong>直觉</strong>: 两个数按位与不为 0 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\iff</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> 它们至少共享一个为 1 的二进制位。我们只需记录“拥有第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 位”的最长链长度。</li>\n</ul>\n<h3 id=\"2-2-Symmetry-Abstraction-从具体到抽象\">2.2 Symmetry Abstraction (从具体到抽象)</h3>\n<ul>\n<li><strong>场景</strong>: P2051 中国象棋。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">N \\times M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> 棋盘，每行每列最多 2 个炮。</li>\n<li><strong>转化</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>3</mn><mi>M</mi></msup></mrow><annotation encoding=\"application/x-tex\">3^M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span></span></span></span></span></span></span> 的具体状压 (Mask) <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>M</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 的计数状压 (Count)。</li>\n<li><strong>直觉</strong>: 列是<strong>无标号</strong>的。对于下一行而言，它不关心“第 1 列放了 1 个”，只关心“<strong>有多少列</strong>放了 1 个”。利用对称性，将状态压缩为 <code>(count_1, count_2)</code>。</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-P4310-位运算优化模板\">3.1 P4310 位运算优化模板</h3>\n<ul>\n<li><strong>策略</strong>: 外层遍历序列，内层遍历 30 个二进制位。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Bitwise LIS\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// dp[j]: max length ending with a number whose j-th bit is 1</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>&#123;<br>    <span class=\"hljs-type\">int</span> now = <span class=\"hljs-number\">1</span>;<br>    <span class=\"hljs-comment\">// 1. Check history: inherit from any bit j that a[i] has</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt;= <span class=\"hljs-number\">30</span>; ++ j ) <br>        <span class=\"hljs-keyword\">if</span>( (a[i] &gt;&gt; j) &amp; <span class=\"hljs-number\">1</span> ) <br>            now = <span class=\"hljs-built_in\">max</span>( now, dp[j] + <span class=\"hljs-number\">1</span> );<br>            <br>    <span class=\"hljs-comment\">// 2. Update future: update all bits j that a[i] has</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt;= <span class=\"hljs-number\">30</span>; ++ j )<br>        <span class=\"hljs-keyword\">if</span>( (a[i] &gt;&gt; j) &amp; <span class=\"hljs-number\">1</span> )<br>            dp[j] = <span class=\"hljs-built_in\">max</span>( dp[j], now );<br>            <br>    ans = <span class=\"hljs-built_in\">max</span>( ans, now );<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-P2051-对称性计数模板\">3.2 P2051 对称性计数模板</h3>\n<ul>\n<li>\n<p><strong>状态</strong>: <code>dp[i][j][k]</code> 表示前 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 行，有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 列含 1 个炮， <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 列含 2 个炮。</p>\n</li>\n<li>\n<p><strong>转移</strong>: 分类讨论当前行放 0, 1, 2 个炮，利用组合数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mi>e</mi><mi>m</mi><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mi>e</mi><mi>m</mi><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(rem, 1), C(rem, 2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span> 等进行转移。</p>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Symmetry DP\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// z: count of columns with 0 cannons = m - j - k</span><br><span class=\"hljs-comment\">// j: count of columns with 1 cannon</span><br><span class=\"hljs-comment\">// k: count of columns with 2 cannons</span><br><br><span class=\"hljs-comment\">// Example transition: Place 2 cannons</span><br><span class=\"hljs-comment\">// Case 3.3: One in 0-col, One in 1-col</span><br><span class=\"hljs-comment\">// 0-col becomes 1-col (j+1), 1-col becomes 2-col (j-1, k+1) -&gt; net j unchanged</span><br><span class=\"hljs-keyword\">if</span>( j &gt;= <span class=\"hljs-number\">1</span> &amp;&amp; z &gt;= <span class=\"hljs-number\">1</span> ) <br>    <span class=\"hljs-built_in\">update</span>( i<span class=\"hljs-number\">+1</span>, j, k<span class=\"hljs-number\">+1</span>, cur * z * j );<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P4310]</strong>: 绝世好题 (位域转换)。</p>\n</li>\n<li>\n<p><strong>[Luogu P2051]</strong>: 中国象棋 (对称性压缩)。</p>\n</li>\n<li>\n<p><strong>[P5664 Emiya]</strong>: (见 03_Interval_Ring) 也是对称性/容斥的一种体现。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/ec3ba026/"},{"title":"二分体系 (Binary Search System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 在<strong>单调</strong>定义域上，通过不断折半缩小搜索区间，以 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 复杂度锁定目标值的算法。</li>\n<li><strong>前置依赖</strong>: [排序], [单调性证明]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>二分查找</strong>: 在有序数组中快速定位元素（替代 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 遍历）。</li>\n<li><strong>二分答案</strong>: 将“求解问题”转化为“判定问题”。\n<ul>\n<li><em>原问题</em>: 求最大的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>。</li>\n<li><em>转化后</em>: 给定 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>，判定 <code>check(X)</code> 是否合法？</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">核心优势</th>\n<th style=\"text-align:left\">劣势/局限</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>二分查找</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 极速定位</td>\n<td style=\"text-align:left\">必须依赖单调性/有序</td>\n<td style=\"text-align:left\">静态查找、求最值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>倍增法</strong></td>\n<td style=\"text-align:left\">适合处理“跳跃”和“区间”</td>\n<td style=\"text-align:left\">状态需满足结合律</td>\n<td style=\"text-align:left\">LCA、RMQ</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>非黑即白的分界线</strong>。\n<ul>\n<li>问题的解空间必须具备单调性（例如：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 合法 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mi>X</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\implies X-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 一定合法）。二分的本质是寻找合法与不合法的<strong>边界 (Boundary)</strong>。</li>\n</ul>\n</li>\n<li><strong>通用模型</strong>:\n<ul>\n<li><strong>定义域</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>L</mi><mo separator=\"true\">,</mo><mi>R</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[L, R]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">L</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">]</span></span></span></span>。</li>\n<li><strong>中点</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>=</mo><mi>L</mi><mo>+</mo><mo stretchy=\"false\">(</mo><mi>R</mi><mo>−</mo><mi>L</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">mid = L + (R - L) / 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mclose\">)</span><span class=\"mord\">/2</span></span></span></span>。</li>\n<li><strong>决策</strong>: 根据 <code>check(mid)</code> 的结果，舍弃一半区间。</li>\n</ul>\n</li>\n<li><strong>两类模板</strong>:\n<ul>\n<li><strong>寻找第一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">\\ge K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 的数</strong>: <code>L</code> 收敛于目标。</li>\n<li><strong>寻找最后一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">\\le K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 的数</strong> (或二分答案最大值): <code>mid</code> 计算需向上取整或使用 <code>ans</code> 记录法。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-整数二分模板\">3.1 整数二分模板</h3>\n<ul>\n<li><strong>策略</strong>: 推荐使用 <code>L &lt;= R</code> + <code>ans</code> 记录法。这种写法逻辑最清晰，不易死循环。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Integer BS\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">solve</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> L, <span class=\"hljs-type\">int</span> R )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> ans = <span class=\"hljs-number\">-1</span>;<br>    <span class=\"hljs-keyword\">while</span>( L &lt;= R ) <br>    &#123;<br>        <span class=\"hljs-type\">int</span> mid = L + ( (R - L) &gt;&gt; <span class=\"hljs-number\">1</span> );<br>        <span class=\"hljs-keyword\">if</span>( <span class=\"hljs-built_in\">check</span>( mid ) ) <br>        &#123;<br>            ans = mid;<br>            L = mid + <span class=\"hljs-number\">1</span>; <br>        &#125;<br>        <span class=\"hljs-keyword\">else</span> <br>        &#123;<br>            R = mid - <span class=\"hljs-number\">1</span>; <br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> ans;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-实数二分模板\">3.2 实数二分模板</h3>\n<ul>\n<li><strong>策略</strong>: 建议固定循环次数 (如 100 次)，避免精度死循环，同时精度优于 <code>eps</code> 法。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Real BS\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-function\"><span class=\"hljs-type\">double</span> <span class=\"hljs-title\">solve</span><span class=\"hljs-params\">( <span class=\"hljs-type\">double</span> L, <span class=\"hljs-type\">double</span> R )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// 循环 100 次，精度可达 1e-30 级别，足够所有竞赛题目</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-number\">100</span>; ++ i ) <br>    &#123;<br>        <span class=\"hljs-type\">double</span> mid = ( L + R ) / <span class=\"hljs-number\">2.0</span>;<br>        <span class=\"hljs-keyword\">if</span>( <span class=\"hljs-built_in\">check</span>( mid ) ) L = mid; <span class=\"hljs-comment\">// 或 R = mid</span><br>        <span class=\"hljs-keyword\">else</span> R = mid;<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> L;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-3-Check-函数的构造艺术\">3.3 Check 函数的构造艺术</h3>\n<p>二分答案的难点永远不在二分本身，而在于 <strong><code>check()</code></strong> 函数的设计。以下是几种经典结合：</p>\n<ul>\n<li>\n<p><strong>BS + 差分/前缀和</strong>:</p>\n<ul>\n<li>\n<p><strong>P1083 借教室</strong>: 判定前 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 个订单是否合法 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 差分数组区间修改，判定是否有负值。</p>\n</li>\n<li>\n<p><strong>P1314 聪明的质监员</strong>: 判定参数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 前缀和快速计算区间校验值。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>BS + 二维前缀和/贪心</strong>:</p>\n<ul>\n<li><strong>P3017 Brownie Slicing</strong>: 判定最小面积 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 贪心切割，利用二维前缀和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 算面积。</li>\n</ul>\n</li>\n<li>\n<p><strong>BS + 单调队列/01分数规划</strong>:</p>\n<ul>\n<li><strong>P1419 寻找段落</strong>: 判定平均值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">\\ge X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 转化为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∑</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>−</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>≥</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\sum (a_i - X) \\ge 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 单调队列求最大子段和。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 死循环</strong>: 若写成 <code>L &lt; R</code> 且 <code>mid = (L+R)/2</code>，当 <code>L=R-1</code> 时易死循环。</p>\n</li>\n<li>\n<p><strong>[坑点 2] 单调性</strong>: 并非所有问题都具备全局单调性，单峰函数需用三分法。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>三分法</strong>: 用于求单峰函数极值。</p>\n</li>\n<li>\n<p><strong>整体二分</strong>: 同时解决多个二分查找问题（高级技巧）。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1083]</strong>: 二分答案 + 差分。</p>\n</li>\n<li>\n<p><strong>[Luogu P1419]</strong>: 二分答案 + 01分数规划 + 单调队列。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/66874f84/"},{"title":"隐性单调性与多路队列 (Implicit Monotonicity)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 在贪心或 DP 转移中，利用<strong>新产生元素天然有序</strong>的特性，使用<strong>多路单调队列 (Multi-Queue)</strong> 替代 <strong>优先队列 (Priority Queue)</strong> 的优化技术。</li>\n<li><strong>前置依赖</strong>: [贪心], [队列]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>复杂度降维</strong>: 将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> (堆) 优化至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\">)</span></span></span></span> (队列)。</li>\n<li><strong>大规模数据</strong>: 解决 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo separator=\"true\">,</mo><mi>M</mi><mo>≥</mo><msup><mn>10</mn><mn>7</mn></msup></mrow><annotation encoding=\"application/x-tex\">N, M \\ge 10^7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">7</span></span></span></span></span></span></span></span></span></span></span> 时堆操作 TLE 的问题。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">维护方式</th>\n<th style=\"text-align:left\">复杂度</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>Priority Queue</strong></td>\n<td style=\"text-align:left\">堆调整 (Heapify)</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">产出无序，通用性强</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>Multi-Queue</strong></td>\n<td style=\"text-align:left\">队尾追加 (Push Back)</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\"><strong>产出单调</strong>，特定模型</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>&quot;The Output is Ordered&quot; (产出即有序)</strong>。\n<ul>\n<li>如果先被处理的元素 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 产出的新值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>，一定优于后被处理的元素 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> 产出的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>B</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">B&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>，那么我们为何要花费 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">\\log N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 把它们扔进堆里重排？</li>\n<li><strong>策略</strong>: 直接将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>B</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;, B&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span> 按顺序推入一个新的队列。</li>\n</ul>\n</li>\n<li><strong>两类模型</strong>:\n<ul>\n<li><strong>Merge (合并)</strong>: 取最小的两个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 产生一个更大的 (如哈夫曼树/合并果子)。若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>≤</mo><mi>y</mi><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mi>x</mi><mo>+</mo><mi>z</mi><mo>≤</mo><mi>y</mi><mo>+</mo><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">x \\le y \\implies x+z \\le y+z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7194em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>，满足单调性。</li>\n<li><strong>Cut (切分)</strong>: 取最大的一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 产生两个更小的 (如蚯蚓切断)。若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">L_1 &gt; L_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⌊</mo><mi>p</mi><msub><mi>L</mi><mn>1</mn></msub><mo stretchy=\"false\">⌋</mo><mo>≥</mo><mo stretchy=\"false\">⌊</mo><mi>p</mi><msub><mi>L</mi><mn>2</mn></msub><mo stretchy=\"false\">⌋</mo></mrow><annotation encoding=\"application/x-tex\">\\lfloor pL_1 \\rfloor \\ge \\lfloor pL_2 \\rfloor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⌊</span><span class=\"mord mathnormal\">p</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">⌋</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⌊</span><span class=\"mord mathnormal\">p</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">⌋</span></span></span></span>，满足单调性。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-P2827-蚯蚓-Cut-Model\">3.1 P2827 蚯蚓 (Cut Model)</h3>\n<ul>\n<li><strong>场景</strong>: 每次取最长蚯蚓切成两段，且所有其他蚯蚓长度增加 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>。</li>\n<li><strong>架构</strong>: <strong>3 路队列</strong>。\n<ul>\n<li><code>Q1</code>: 初始有序序列 (原蚯蚓)。</li>\n<li><code>Q2</code>: 切下的左段。</li>\n<li><code>Q3</code>: 切下的右段。</li>\n</ul>\n</li>\n<li><strong>全局增长处理</strong>: 维护一个全局偏移量 <code>delta</code>。实际长度 = <code>val + delta</code>，存入队列时存 <code>real_val - delta</code>。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Earthworm Multi-Queue\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 3 queues: q[0] original, q[1] left_part, q[2] right_part</span><br><span class=\"hljs-comment\">// delta: global offset accumlated by time</span><br><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">get_max</span><span class=\"hljs-params\">()</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> res = -INF, idx = <span class=\"hljs-number\">-1</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-number\">3</span>; ++ i ) <br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( !q[i].<span class=\"hljs-built_in\">empty</span>() &amp;&amp; q[i].<span class=\"hljs-built_in\">front</span>() &gt; res ) <br>        &#123;<br>            res = q[i].<span class=\"hljs-built_in\">front</span>();<br>            idx = i;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">if</span>( idx != <span class=\"hljs-number\">-1</span> ) q[idx].<span class=\"hljs-built_in\">pop</span>();<br>    <span class=\"hljs-keyword\">return</span> res;<br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">solve</span><span class=\"hljs-params\">()</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// airy style loop</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> t = <span class=\"hljs-number\">1</span>; t &lt;= m; ++ t ) <br>    &#123;<br>        <span class=\"hljs-type\">int</span> x = <span class=\"hljs-built_in\">get_max</span>() + delta; <span class=\"hljs-comment\">// Get max from 3 queues</span><br>        <br>        <span class=\"hljs-comment\">// Push new parts (stored relative to current delta)</span><br>        <span class=\"hljs-type\">int</span> left = <span class=\"hljs-built_in\">floor</span>(x * p);<br>        <span class=\"hljs-type\">int</span> right = x - left;<br>        <br>        delta += q_val; <span class=\"hljs-comment\">// Others grow</span><br>        <br>        q[<span class=\"hljs-number\">1</span>].<span class=\"hljs-built_in\">push</span>( left - delta );<br>        q[<span class=\"hljs-number\">2</span>].<span class=\"hljs-built_in\">push</span>( right - delta );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 初始化排序</strong>: Multi-Queue 的前提是 <code>Q1</code> 初始有序。若值域小可用桶排序 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>)，否则需 <code>sort</code> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>)。</p>\n</li>\n<li>\n<p><strong>[坑点 2] 精度</strong>: 浮点运算需转为整数乘除，避免精度误差。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P2827]</strong>: 蚯蚓 (3路队列 + 偏移量)。</p>\n</li>\n<li>\n<p><strong>[Luogu P6033]</strong>: 合并果子加强版 (2路队列 + 桶排序)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/517010cb/"},{"title":"计数与组合体系 (Counting Methodology)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 求解满足特定约束的<strong>方案总数</strong> (Answer is Number of Ways) 的 DP 模型。</li>\n<li><strong>前置依赖</strong>: [加法原理/乘法原理], [容斥原理]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>组合爆炸</strong>: 直接搜索无法处理指数级方案。</li>\n<li><strong>复杂约束</strong>: &quot;至少一个&quot;、&quot;至多一半&quot; 等限制条件 (P5664 Emiya)。</li>\n<li><strong>结构依赖</strong>: 路径计数、骨牌覆盖。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉 1: 循环序决定排列/组合</strong>。\n<ul>\n<li><strong>组合 (Combination)</strong>: 物品无序 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\implies</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> <strong>先枚举物品，再枚举容量</strong>。 (强制了物品的选择顺序，如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{1, 2\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">}</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{2, 1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span> 归为一类)。</li>\n<li><strong>排列 (Permutation)</strong>: 物品有序 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\implies</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> <strong>先枚举容量，再枚举物品</strong>。 (允许最后一步选任意物品，创造了顺序差异)。</li>\n</ul>\n</li>\n<li><strong>核心直觉 2: 正难则反 (Inclusion-Exclusion)</strong>。\n<ul>\n<li>当限制条件是 &quot;Globally Constraint&quot; (如所有食材 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><mo stretchy=\"false\">⌊</mo><mi>k</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo stretchy=\"false\">⌋</mo></mrow><annotation encoding=\"application/x-tex\">\\le \\lfloor k/2 \\rfloor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⌊</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord\">/2</span><span class=\"mclose\">⌋</span></span></span></span>) 时，状态极难压缩。</li>\n<li><strong>转化</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>合法</mtext><mo>=</mo><mtext>总数</mtext><mo>−</mo><mtext>非法</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{合法} = \\text{总数} - \\text{非法}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">合法</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">总数</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">非法</span></span></span></span></span>。</li>\n<li><strong>非法特征</strong>: 对于 Emiya 做饭，<strong>至多只有一种</strong>食材会超过半数。这使得我们可以枚举这个“违规食材”，将全局限制降维为局部限制。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-基础计数模板-Permutation-vs-Combination\">3.1 基础计数模板 (Permutation vs Combination)</h3>\n<ul>\n<li><strong>策略</strong>: 这里的 Loop Order 是绝对的逻辑支点。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Loop Order\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1. Combination (e.g., Coin Change 2)</span><br><span class=\"hljs-comment\">// 凑成 amount 的组合数 (1,2) == (2,1)</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i )      <span class=\"hljs-comment\">// Item First</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = coin[i]; j &lt;= m; ++ j ) <span class=\"hljs-comment\">// Vol Second</span><br>        dp[j] += dp[j - coin[i]];<br><br><span class=\"hljs-comment\">// 2. Permutation (e.g., Combination Sum 4)</span><br><span class=\"hljs-comment\">// 凑成 amount 的排列数 (1,2) != (2,1)</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">1</span>; j &lt;= m; ++ j )      <span class=\"hljs-comment\">// Vol First</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i )  <span class=\"hljs-comment\">// Item Second</span><br>        <span class=\"hljs-keyword\">if</span>( j &gt;= coin[i] ) <br>            dp[j] += dp[j - coin[i]];<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-容斥原理计数-P5664-Emiya\">3.2 容斥原理计数 (P5664 Emiya)</h3>\n<ul>\n<li>\n<p><strong>模型</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 种烹饪方式，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> 种食材。每行选一个，每列总数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><mo stretchy=\"false\">⌊</mo><mi>K</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo stretchy=\"false\">⌋</mo></mrow><annotation encoding=\"application/x-tex\">\\le \\lfloor K/2 \\rfloor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⌊</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord\">/2</span><span class=\"mclose\">⌋</span></span></span></span>。</p>\n</li>\n<li>\n<p><strong>转化</strong>: 枚举<strong>违规列</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mi>o</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">col</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>。</p>\n</li>\n<li>\n<p><strong>状态</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">dp[i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 表示前 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 行，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mtext>Count</mtext><mrow><mi>c</mi><mi>o</mi><mi>l</mi></mrow></msub><mo>−</mo><msub><mtext>Count</mtext><mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">(\\text{Count}_{col} - \\text{Count}_{other}) = j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Count</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">co</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Count</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">er</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的方案数。</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的范围是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mi>N</mi><mo separator=\"true\">,</mo><mi>N</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-N, N]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">]</span></span></span></span>，需加偏移量 <code>base = N</code>。</li>\n</ul>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Emiya Inclusion-Exclusion\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// Calculate Total Ways first</span><br><span class=\"hljs-comment\">// total = Product(sum[i] + 1) - 1</span><br><br><span class=\"hljs-comment\">// Calculate Illegal Ways</span><br>ll illegal = <span class=\"hljs-number\">0</span>;<br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> c = <span class=\"hljs-number\">1</span>; c &lt;= m; ++ c ) <span class=\"hljs-comment\">// Enumerate the illegal ingredient</span><br>&#123;<br>    <span class=\"hljs-built_in\">memset</span>(dp, <span class=\"hljs-number\">0</span>, <span class=\"hljs-built_in\">sizeof</span>(dp));<br>    dp[<span class=\"hljs-number\">0</span>][n] = <span class=\"hljs-number\">1</span>; <span class=\"hljs-comment\">// Offset n (represents 0 diff)</span><br>    <br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i )<br>    &#123;<br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = n - i; j &lt;= n + i; ++ j )<br>        &#123;<br>            <span class=\"hljs-comment\">// Option 1: Skip row</span><br>            dp[i][j] = dp[i<span class=\"hljs-number\">-1</span>][j];<br>            <br>            <span class=\"hljs-comment\">// Option 2: Pick illegal ingredient &#x27;c&#x27; (+1 diff)</span><br>            <span class=\"hljs-keyword\">if</span>( j &gt; <span class=\"hljs-number\">0</span> )<br>                dp[i][j] = (dp[i][j] + dp[i<span class=\"hljs-number\">-1</span>][j<span class=\"hljs-number\">-1</span>] * a[i][c]) % MOD;<br>            <br>            <span class=\"hljs-comment\">// Option 3: Pick other ingredients (-1 diff)</span><br>            <span class=\"hljs-comment\">// others = row_sum[i] - a[i][c]</span><br>            <span class=\"hljs-keyword\">if</span>( j &lt; <span class=\"hljs-number\">2</span>*n )<br>                dp[i][j] = (dp[i][j] + dp[i<span class=\"hljs-number\">-1</span>][j<span class=\"hljs-number\">+1</span>] * (sum[i] - a[i][c])) % MOD;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-comment\">// Sum up states where diff &gt; 0 (j &gt; n)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = n + <span class=\"hljs-number\">1</span>; j &lt;= <span class=\"hljs-number\">2</span>*n; ++ j ) <br>        illegal = (illegal + dp[n][j]) % MOD;<br>&#125;<br><span class=\"hljs-comment\">// ans = (total - illegal)</span><br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 取模减法</strong>: <code>(A - B) % MOD</code> 必须写成 <code>(A - B + MOD) % MOD</code>，否则可能出现负数结果。</p>\n</li>\n<li>\n<p><strong>[坑点 2] 偏移量</strong>: 处理涉及负数下标的状态（如差值）时，务必加上 <code>offset</code>，并检查数组越界。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>结构化依赖 (P1006 传纸条)</strong>:</p>\n<ul>\n<li>虽然主要用于求最值，但其 <strong>Multi-path State</strong> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">dp[step][x_1][x_2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>) 是处理复杂路径计数的基础。在计数问题中，若路径不可重合，通常需要利用 Lindström–Gessel–Viennot 引理 (LGV) 或此类多路 DP 状态。</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P5664]</strong>: Emiya 家今天的饭 (容斥 + 计数 DP)。</p>\n</li>\n<li>\n<p><strong>[Luogu P1006]</strong>: 传纸条 (多路结构状态)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/21d85f4f/"},{"title":"离散化 (Discretization)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 在不改变数据<strong>相对大小 (Relative Order)</strong> 的前提下，将分布稀疏的大值域数据映射为紧凑的小下标数据。</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li>题目给出的数值范围很大 (如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>10</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">10^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>)，但数据量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 较小 (如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>)。</li>\n<li>算法（如树状数组、线段树、差分）的空间复杂度依赖于<strong>值域</strong>而非数据量。</li>\n</ul>\n</li>\n<li><strong>本质</strong>: <strong>Value <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> Rank</strong> 的映射。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心不变量</strong>: <strong>Rank (排名)</strong>。\n<ul>\n<li>离散化后的数组 <code>b[i]</code> 表示原数组 <code>a[i]</code> 在所有出现过的数中排第几小。</li>\n</ul>\n</li>\n<li><strong>映射过程</strong>:\n<ol>\n<li><strong>Sort</strong>: 将所有出现的数排序。</li>\n<li><strong>Unique</strong>: 去除重复的数，得到“有序去重值域”。</li>\n<li><strong>Binary Search</strong>: 对于原数组的每个数，二分查找它在去重值域中的位置（下标）。</li>\n</ol>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-STL-离散化模板\">3.1 STL 离散化模板</h3>\n<ul>\n<li>利用 <code>std::unique</code> 和 <code>std::lower_bound</code> 组合拳。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Discretization Template\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-type\">const</span> <span class=\"hljs-type\">int</span> maxn = <span class=\"hljs-number\">1e5</span> + <span class=\"hljs-number\">50</span>;<br><span class=\"hljs-type\">int</span> a[maxn], b[maxn]; <span class=\"hljs-comment\">// a: 原数组, b: 临时数组用于排序去重</span><br><span class=\"hljs-type\">int</span> n;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">discretize</span><span class=\"hljs-params\">()</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// 1. Copy: 复制一份数据到 b</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) b[i] = a[i];<br>    <br>    <span class=\"hljs-comment\">// 2. Sort: 排序</span><br>    <span class=\"hljs-built_in\">sort</span>( b + <span class=\"hljs-number\">1</span>, b + n + <span class=\"hljs-number\">1</span> );<br>    <br>    <span class=\"hljs-comment\">// 3. Unique: 去重</span><br>    <span class=\"hljs-comment\">// unique 返回去重后末尾元素的下一个迭代器</span><br>    <span class=\"hljs-type\">int</span> len = <span class=\"hljs-built_in\">unique</span>( b + <span class=\"hljs-number\">1</span>, b + n + <span class=\"hljs-number\">1</span> ) - ( b + <span class=\"hljs-number\">1</span> );<br>    <br>    <span class=\"hljs-comment\">// 4. Map: 构造映射 (Value -&gt; Rank)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>    &#123;<br>        <span class=\"hljs-comment\">// lower_bound 查找 a[i] 在 b 中的位置 (1-based)</span><br>        <span class=\"hljs-comment\">// 此时 a[i] 的值变为 range [1, len]</span><br>        a[i] = <span class=\"hljs-built_in\">lower_bound</span>( b + <span class=\"hljs-number\">1</span>, b + len + <span class=\"hljs-number\">1</span>, a[i] ) - ( b + <span class=\"hljs-number\">1</span> ) + <span class=\"hljs-number\">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 下标体系</strong>: <code>lower_bound</code> 返回的是指针/迭代器。</p>\n<ul>\n<li>\n<p>若是 <code>vector</code>，<code>it - v.begin()</code> 是 0-based index。</p>\n</li>\n<li>\n<p>若是数组 <code>b + 1</code> 开始，<code>ptr - (b + 1) + 1</code> 才是 1-based rank。建议统一使用 1-based 以适配 BIT/线段树。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>[坑点 2] 原值查询</strong>: 离散化后 <code>a[i]</code> 变成了 Rank。如果后续需要输出原始数值，需保留 <code>b</code> 数组，<code>b[ a[i] ]</code> 即为原值。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>典型应用</strong>:</p>\n<ul>\n<li>\n<p><strong>逆序对 (Inversion Pair)</strong>: 树状数组求逆序对时，若数值过大，必须先离散化。</p>\n</li>\n<li>\n<p><strong>二维平面扫描线</strong>: 坐标值很大时，需对 X 或 Y 坐标离散化。</p>\n</li>\n<li>\n<p><strong>主席树 (可持久化线段树)</strong>: 处理值域线段树时，必须离散化。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li><strong>[Luogu P1908] 逆序对</strong>: 离散化 + 权值树状数组的标准入门题。</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/ef28f194/"},{"title":"静态数组优化 (Prefix Sum & Difference)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 处理<strong>静态数组</strong>区间查询与修改的“对偶技巧”。</li>\n<li><strong>前置依赖</strong>: [容斥原理]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>前缀和</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 查询静态区间和。</li>\n<li><strong>差分</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 执行区间修改。</li>\n<li><strong>SOS DP</strong>: 解决子集求和 (Sum Over Subsets) 问题。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>对偶性</strong>: 差分是前缀和的<strong>逆运算</strong>。\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>−</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mo>∑</mo><mi>D</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">D[i] = A[i] - A[i-1] \\iff A[i] = \\sum D[j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span>。</li>\n</ul>\n</li>\n<li><strong>维度压缩</strong>:\n<ul>\n<li>将“区间操作”压缩为“端点操作”。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-基础前缀和-差分模板\">3.1 基础前缀和/差分模板</h3>\n<p><em>(略，保持原有内容)</em></p>\n<h3 id=\"3-2-高维前缀和-SOS-DP-模板\">3.2 高维前缀和 (SOS DP) 模板</h3>\n<ul>\n<li><strong>定义</strong>: 求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">[</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>⊆</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msub><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">F[mask] = \\sum_{i \\subseteq mask} A[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1449em;vertical-align:-0.3949em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1864em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">⊆</span><span class=\"mord mathnormal mtight\">ma</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3949em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span>。</li>\n<li><strong>策略</strong>: <strong>逐维处理</strong>。将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 维空间的容斥转化为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 次线性扫描。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: SOS DP\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// dp[mask] 初始存 A[mask]</span><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; n; ++ i ) <span class=\"hljs-comment\">// 枚举维度 (第 i 位)</span><br>&#123;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> mask = <span class=\"hljs-number\">0</span>; mask &lt; (<span class=\"hljs-number\">1</span> &lt;&lt; n); ++ mask ) <br>    &#123;<br>        <span class=\"hljs-comment\">// 如果 mask 包含第 i 维 (即第 i 位为 1)</span><br>        <span class=\"hljs-keyword\">if</span>( (mask &gt;&gt; i) &amp; <span class=\"hljs-number\">1</span> ) <br>        &#123;<br>            <span class=\"hljs-comment\">// 累加 &quot;第 i 位为 0&quot; 的对应状态</span><br>            dp[mask] += dp[mask ^ (<span class=\"hljs-number\">1</span> &lt;&lt; i)];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li><strong>[坑点]</strong>: SOS DP 的外层循环必须是<strong>枚举维度</strong> <code>i</code>，内层枚举状态 <code>mask</code>。顺序反了就变成了普通的逻辑运算，无法传递状态。</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>高维差分</strong>: 对偶操作，用于子集修改。</p>\n</li>\n<li>\n<p><strong>子集最值</strong>: 将 <code>+=</code> 改为 <code>max</code>，可求子集最大值 (ARC100-C)。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li><strong>[AT ARC100 C]</strong>: Or Plus Max - 高维前缀和维护最大/次大值。</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/b22c5db7/"},{"title":"树状数组体系 (Binary Indexed Tree)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 利用二进制特征 (<code>lowbit</code>) 构建的隐式树形结构，通过维护“部分和”来实现 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 的单点修改与前缀查询。</li>\n<li><strong>前置依赖</strong>: [前缀和], [位运算], [差分]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>动态前缀和</strong>: 解决静态前缀和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 修改的耗时问题。</li>\n<li><strong>轻量级维护</strong>: 相比线段树，BIT 常数更小、代码更短、空间更省 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> vs <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>4</mn><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(4N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>)。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">核心优势</th>\n<th style=\"text-align:left\">劣势/局限</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>树状数组</strong></td>\n<td style=\"text-align:left\">代码极短 (10行)，常数极小</td>\n<td style=\"text-align:left\">运算需满足结合律且可逆 (加法/异或)，区间操作受限</td>\n<td style=\"text-align:left\">逆序对、动态前缀和、二维偏序</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>线段树</strong></td>\n<td style=\"text-align:left\">功能完备，支持任意结合律算子</td>\n<td style=\"text-align:left\">代码冗长，常数大，空间大</td>\n<td style=\"text-align:left\">复杂区间操作 (RMQ, MatMul)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>二进制拆分</strong>。\n<ul>\n<li>任何整数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 都可以被拆解为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><msub><mi>k</mi><mn>1</mn></msub></msup><mo>+</mo><msup><mn>2</mn><msub><mi>k</mi><mn>2</mn></msub></msup><mo>+</mo><mo>…</mo></mrow><annotation encoding=\"application/x-tex\">2^{k_1} + 2^{k_2} + \\dots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9324em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0315em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9324em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0315em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.123em;\"></span><span class=\"minner\">…</span></span></span></span>。BIT 利用这一性质，让节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> 管辖区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mtext> </mtext><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">(x - lowbit(x), \\ x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">bi</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\"> </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span>。</li>\n<li><strong>Query (剥洋葱)</strong>: 不断减去 <code>lowbit</code>，累加管辖区间的信息，直到 0。</li>\n<li><strong>Update (爬树)</strong>: 不断加上 <code>lowbit</code>，更新所有覆盖了当前位置的父节点，直到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。</li>\n</ul>\n</li>\n<li><strong>关键公式</strong>:\n<ul>\n<li>\n<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mi mathvariant=\"normal\">&amp;</mi><mo stretchy=\"false\">(</mo><mo>−</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">lowbit(x) = x \\&amp; (-x)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">bi</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">&amp;</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span></p>\n</li>\n<li><strong>父子关系</strong>: 节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的父节点为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x + lowbit(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">bi</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n</li>\n<li><strong>模型转化</strong>:\n<ul>\n<li><strong>区间修改 + 单点查询</strong>: 利用 <strong>差分</strong> 思想。原数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> 的单点查询 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">A[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\iff</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> 差分数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 的前缀和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></msubsup><mi>D</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^x D[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span>。区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>L</mi><mo separator=\"true\">,</mo><mi>R</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[L, R]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">L</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">]</span></span></span></span> 加 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\iff</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo stretchy=\"false\">[</mo><mi>L</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mo>=</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>D</mi><mo stretchy=\"false\">[</mo><mi>R</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>−</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">D[L] += k, D[R+1] -= k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">L</span><span class=\"mclose\">]</span><span class=\"mord\">+</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-基础模型-单点修改-区间查询\">3.1 基础模型 (单点修改 + 区间查询)</h3>\n<ul>\n<li><strong>策略</strong>: 这里的 <code>query(x)</code> 返回前缀和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span>。区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>L</mi><mo separator=\"true\">,</mo><mi>R</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[L, R]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">L</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">]</span></span></span></span> 的和通过 <code>query(R) - query(L-1)</code> 获得。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-8f7bdefe\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-8f7bdefe\">\n        <div class=\"fold-arrow\">▶</div>Code: BIT Point Add\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-8f7bdefe\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1-based indexing is mandatory</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">lowbit</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> x )</span> </span>&#123; <span class=\"hljs-keyword\">return</span> x &amp; -x; &#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">add</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> x, <span class=\"hljs-type\">int</span> k )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// Update path: x -&gt; x + lowbit -&gt; N</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = x; i &lt;= n; i += <span class=\"hljs-built_in\">lowbit</span>( i ) ) <br>    &#123;<br>        c[i] += k;<br>    &#125;<br>&#125;<br><br><span class=\"hljs-function\">ll <span class=\"hljs-title\">query</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> x )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    ll res = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-comment\">// Query path: x -&gt; x - lowbit -&gt; 0</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = x; i &gt; <span class=\"hljs-number\">0</span>; i -= <span class=\"hljs-built_in\">lowbit</span>( i ) ) <br>    &#123;<br>        res += c[i];<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-差分模型-区间修改-单点查询\">3.2 差分模型 (区间修改 + 单点查询)</h3>\n<ul>\n<li><strong>策略</strong>: 维护<strong>差分数组</strong>的 BIT。\n<ul>\n<li><code>add(x, k)</code>: 物理意义是修改差分值。</li>\n<li><code>query(x)</code>: 物理意义是求原数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">A[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> (即差分数组的前缀和)。</li>\n</ul>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-dcdac752\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-dcdac752\">\n        <div class=\"fold-arrow\">▶</div>Code: BIT Range Add\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-dcdac752\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// Physics: Maintain Difference Array D[i]</span><br><span class=\"hljs-comment\">// Operation: A[L...R] += k</span><br><br><span class=\"hljs-comment\">// 1. D[L] += k</span><br><span class=\"hljs-built_in\">add</span>( L, k ); <br><br><span class=\"hljs-comment\">// 2. D[R+1] -= k</span><br><span class=\"hljs-built_in\">add</span>( R + <span class=\"hljs-number\">1</span>, -k );<br><br><span class=\"hljs-comment\">// 3. Query A[x]</span><br>ll val = <span class=\"hljs-built_in\">query</span>( x );<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li><strong>[坑点 1] 下标陷阱</strong>: <code>lowbit(0) = 0</code>。如果循环从 0 开始或计算出 0，会导致 <code>i</code> 原地踏步死循环。<strong>严禁使用 0 下标</strong>。</li>\n<li><strong>[坑点 2] 数据溢出</strong>: 前缀和累加极易超过 <code>int</code>，务必使用 <code>long long</code>。</li>\n<li><strong>[坑点 3] 离散化边界</strong>: 若值域很大需离散化，注意 <code>add</code> 时的上界是离散化后的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> 而非原值域。</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li><strong>变体模型</strong>:\n<ul>\n<li><strong>权值树状数组</strong>: 维护值域的频率，用于求 <strong>第 K 小</strong> 或 <strong>逆序对</strong>。</li>\n<li><strong>二维树状数组</strong>: 双重循环 <code>add(x, y, k)</code>，处理二维偏序问题。</li>\n</ul>\n</li>\n<li><strong>母题索引</strong>:\n<ul>\n<li><strong>[Luogu P3374]</strong>: 基础单点修改 + 区间求和。</li>\n<li><strong>[Luogu P3368]</strong>: 差分应用，区间修改 + 单点查询。</li>\n<li><strong>[Luogu P1908]</strong>: 逆序对 (利用 BIT 维护“当前数之前出现过多少比它大的数”)。</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/eef750c1/"},{"title":"基础排序体系 (Basic Sorting System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 将无序序列映射为单调序列的过程。本质是消除序列中的 <strong>逆序对 (Inversion Pair)</strong>。</li>\n<li><strong>前置依赖</strong>: [递归], [分治思想]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>冒泡排序</strong>: 教学模型，用于建立“交换一次相邻元素 = 消除一个逆序对”的理论直觉。</li>\n<li><strong>快速排序 (Quick Sort)</strong>: 解决大规模数据 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>≥</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">N \\ge 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>) 的通用排序，追求平均性能极致。</li>\n<li><strong>归并排序 (Merge Sort)</strong>: 解决 <strong>稳定性 (Stability)</strong> 需求及 <strong>逆序对统计</strong> 问题，这是 <code>std::sort</code> 无法替代的。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">平均复杂度</th>\n<th style=\"text-align:left\">空间复杂度</th>\n<th style=\"text-align:left\">稳定性</th>\n<th style=\"text-align:left\">核心特征 (Key Feature)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>Bubble</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">✅</td>\n<td style=\"text-align:left\">交换次数严格等于逆序对数量。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>Quick</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">❌</td>\n<td style=\"text-align:left\"><strong>原址排序 (In-place)</strong>，常数极小，最坏 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>Merge</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:left\">✅</td>\n<td style=\"text-align:left\"><strong>分治 (Divide &amp; Conquer)</strong>，适合统计过程量，需要辅助数组。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<h3 id=\"2-1-冒泡排序：逆序对的度量\">2.1 冒泡排序：逆序对的度量</h3>\n<ul>\n<li><strong>核心直觉</strong>: 每一轮“冒泡”必然将当前未排序部分的最值归位。</li>\n<li><strong>关键性质</strong>:\n<ul>\n<li><strong>交换守恒</strong>: 交换相邻的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(a[i], a[i+1])</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">])</span></span></span></span>，若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>&gt;</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">a[i] &gt; a[i+1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>，则全排列的逆序对总数严格 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>。</li>\n<li><strong>推论</strong>: 冒泡排序的总交换次数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>=</mo></mrow><annotation encoding=\"application/x-tex\">=</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">=</span></span></span></span> 初始序列的逆序对总数。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-2-快排-vs-归并：分治的对偶性\">2.2 快排 vs 归并：分治的对偶性</h3>\n<p>这两种算法是分治思想的两个极端：</p>\n<ul>\n<li>\n<p><strong>快速排序 (Quick Sort)</strong> —— <strong>重“分”轻“合”</strong></p>\n<ul>\n<li><strong>逻辑</strong>: 选取基准 (Pivot) <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>，将数组划分为 <code>&lt; P</code> 和 <code>&gt; P</code> 两部分。</li>\n<li><strong>难点</strong>: Partition (划分) 过程复杂，需要双指针技巧。</li>\n<li><strong>Easy</strong>: 递归结束后，整个数组天然有序，无需合并操作。</li>\n<li><strong>数学表达</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><msub><mi>S</mi><mrow><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow></msub><mo>∪</mo><mo stretchy=\"false\">{</mo><mi>P</mi><mi>i</mi><mi>v</mi><mi>o</mi><mi>t</mi><mo stretchy=\"false\">}</mo><mo>∪</mo><msub><mi>S</mi><mrow><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">S_{total} = S_{left} \\cup \\{Pivot\\} \\cup S_{right}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></li>\n</ul>\n</li>\n<li>\n<p><strong>归并排序 (Merge Sort)</strong> —— <strong>重“合”轻“分”</strong></p>\n<ul>\n<li><strong>逻辑</strong>: 无脑从中间切开，递归到底。</li>\n<li><strong>Easy</strong>: 划分过程是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 的（直接取中点）。</li>\n<li><strong>难点</strong>: Merge (合并) 过程，需要将两个有序子序列“拉链式”咬合，同时在此过程中可以统计逆序对。</li>\n<li><strong>数学表达</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mi>T</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">T(n) = 2T(n/2) + O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord\">/2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署-Battle-Deployment\">3. 实战部署 (Battle Deployment)</h2>\n<h3 id=\"3-1-快速排序-通用模板\">3.1 快速排序 (通用模板)</h3>\n<ul>\n<li><strong>策略</strong>: 选取 <code>mid</code> 值作为 Pivot (防止有序数组退化为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>)，采用双指针交换法。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Quick Sort\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// Quick Sort Template</span><br><span class=\"hljs-comment\">// 1-based indexing, O(N log N)</span><br><br><span class=\"hljs-type\">const</span> <span class=\"hljs-type\">int</span> maxn = <span class=\"hljs-number\">1e5</span> + <span class=\"hljs-number\">50</span>;<br><span class=\"hljs-type\">int</span> a[maxn];<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">quick_sort</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> l, <span class=\"hljs-type\">int</span> r )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// 递归边界</span><br>    <span class=\"hljs-keyword\">if</span>( l &gt;= r ) <span class=\"hljs-keyword\">return</span>;<br><br>    <span class=\"hljs-comment\">// 1. Partition: 取中点为基准，防止退化</span><br>    <span class=\"hljs-type\">int</span> mid = a[(l + r) &gt;&gt; <span class=\"hljs-number\">1</span>]; <br>    <span class=\"hljs-type\">int</span> i = l, j = r;<br><br>    <span class=\"hljs-keyword\">while</span>( i &lt;= j )<br>    &#123;<br>        <span class=\"hljs-comment\">// 寻找不符合条件的元素</span><br>        <span class=\"hljs-keyword\">while</span>( a[i] &lt; mid ) i++;<br>        <span class=\"hljs-keyword\">while</span>( a[j] &gt; mid ) j--;<br>        <br>        <span class=\"hljs-keyword\">if</span>( i &lt;= j )<br>        &#123;<br>            <span class=\"hljs-built_in\">swap</span>( a[i], a[j] );<br>            i++; <br>            j--;<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-comment\">// 2. Recursion: 递归处理子区间</span><br>    <span class=\"hljs-comment\">// 此时 j &lt; i, 分界线在 j 和 i 之间</span><br>    <span class=\"hljs-keyword\">if</span>( l &lt; j ) <span class=\"hljs-built_in\">quick_sort</span>( l, j );<br>    <span class=\"hljs-keyword\">if</span>( i &lt; r ) <span class=\"hljs-built_in\">quick_sort</span>( i, r );<br>&#125;<br>````<br><br>&#123;% endfold %&#125;<br><br>### <span class=\"hljs-number\">3.2</span> 归并排序 (逆序对统计版)<br><br>- **策略**: 使用全局 `tmp` 数组避免频繁 `<span class=\"hljs-keyword\">new</span>`。在右边元素比左边元素小的时候，说明左边剩余的所有元素都能与该右边元素构成逆序对。<br>    <br><br>&#123;% fold info @Code: Merge Sort &amp; Inversion Count %&#125;<br><br>```cpp<br><span class=\"hljs-comment\">// Merge Sort Template (with Inversion Counting)</span><br><span class=\"hljs-comment\">// 1-based indexing</span><br><br><span class=\"hljs-keyword\">using</span> ll = <span class=\"hljs-type\">long</span> <span class=\"hljs-type\">long</span>;<br><span class=\"hljs-type\">const</span> <span class=\"hljs-type\">int</span> maxn = <span class=\"hljs-number\">5e5</span> + <span class=\"hljs-number\">50</span>;<br><br><span class=\"hljs-type\">int</span> a[maxn], tmp[maxn]; <span class=\"hljs-comment\">// 辅助数组必须全局定义</span><br>ll total_inversions = <span class=\"hljs-number\">0</span>;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">merge_sort</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> l, <span class=\"hljs-type\">int</span> r )</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( l &gt;= r ) <span class=\"hljs-keyword\">return</span>;<br><br>    <span class=\"hljs-type\">int</span> mid = (l + r) &gt;&gt; <span class=\"hljs-number\">1</span>;<br>    <br>    <span class=\"hljs-comment\">// 1. Divide</span><br>    <span class=\"hljs-built_in\">merge_sort</span>( l, mid );<br>    <span class=\"hljs-built_in\">merge_sort</span>( mid + <span class=\"hljs-number\">1</span>, r );<br><br>    <span class=\"hljs-comment\">// 2. Conquer (Merge)</span><br>    <span class=\"hljs-type\">int</span> i = l, j = mid + <span class=\"hljs-number\">1</span>, k = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">while</span>( i &lt;= mid &amp;&amp; j &lt;= r )<br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( a[i] &lt;= a[j] )<br>        &#123;<br>            tmp[k++] = a[i++];<br>        &#125;<br>        <span class=\"hljs-keyword\">else</span><br>        &#123;<br>            tmp[k++] = a[j++];<br>            <span class=\"hljs-comment\">// 核心: 统计逆序对</span><br>            <span class=\"hljs-comment\">// 左边 a[i...mid] 都比 a[j] 大</span><br>            total_inversions += (ll)(mid - i + <span class=\"hljs-number\">1</span>);<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">while</span>( i &lt;= mid ) tmp[k++] = a[i++];<br>    <span class=\"hljs-keyword\">while</span>( j &lt;= r )   tmp[k++] = a[j++];<br><br>    <span class=\"hljs-comment\">// 3. Copy Back</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = l, k = <span class=\"hljs-number\">0</span>; i &lt;= r; ++i, ++k )<br>    &#123;<br>        a[i] = tmp[k];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[Quick Sort 坑点]</strong>:</p>\n<ul>\n<li>\n<p><strong>基准选择</strong>: 严禁直接选 <code>a[l]</code> 作为基准，遇到有序数据会退化成 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 导致 TLE。</p>\n</li>\n<li>\n<p><strong>死循环</strong>: <code>while(a[i] &lt; mid)</code> 不能写成 <code>&lt;=</code>, 否则遇到全相等数组会指针越界或死循环。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>[Merge Sort 坑点]</strong>:</p>\n<ul>\n<li>\n<p><strong>内存爆炸</strong>: <code>tmp</code> 数组如果写在函数内部 <code>vector&lt;int&gt; tmp</code>，会因为频繁分配内存导致 MLE 或 TLE。必须全局静态分配。</p>\n</li>\n<li>\n<p><strong>long long</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>5</mn><mo>×</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">N=5 \\times 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span> 时，逆序对数量级为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.25</mn><mo>×</mo><msup><mn>10</mn><mn>11</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\approx 1.25 \\times 10^{11}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.25</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span></span></span></span></span></span></span></span>，使用 <code>int</code> 必溢出。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"4-知识粘附-Knowledge-Adhesion\">4. 知识粘附 (Knowledge Adhesion)</h2>\n<blockquote>\n<p><em>体系关联</em></p>\n</blockquote>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>第 K 大数 (Quick Select)</strong>: 快排思想的变体，只递归一半，复杂度 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</p>\n</li>\n<li>\n<p><strong>CDQ 分治</strong>: 归并排序思想的二维扩展，用于解决多维偏序问题。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1177]</strong>: 快速排序模板（需抗 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 卡常）。</p>\n</li>\n<li>\n<p><strong>[Luogu P1908]</strong>: 逆序对计数（归并排序经典应用）。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/50dbb92c/"},{"title":"堆与优先队列 (Heap_PriorityQueue)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 一种特殊的完全二叉树，父节点值总是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo></mrow><annotation encoding=\"application/x-tex\">\\ge</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span></span></span></span> (或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo></mrow><annotation encoding=\"application/x-tex\">\\le</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span></span></span></span>) 子节点。</li>\n<li><strong>前置依赖</strong>: [完全二叉树]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li>动态维护集合中的<strong>极值</strong> (最大/最小)，支持 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 插入/删除。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:\n<ul>\n<li>vs <strong>排序</strong>: 堆适合动态流数据，排序适合静态数据。</li>\n<li>vs <strong>平衡树</strong>: 堆只能查极值，平衡树能查 Rank/前驱后继，但堆常数极小。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>秩序的维护者</strong>。\n<ul>\n<li><strong>Up (上浮)</strong>: 新人能力强，自动晋升。</li>\n<li><strong>Down (下沉)</strong>: 顶层空缺，底层补位后若德不配位，自动降级。</li>\n</ul>\n</li>\n<li><strong>STL 特性</strong>: <code>priority_queue</code> 默认是<strong>大根堆</strong> (<code>less</code>)。</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-STL-优先队列模板\">3.1 STL 优先队列模板</h3>\n<ul>\n<li><strong>策略</strong>: 99% 场景直接用 STL。Dijkstra 需配合 <code>greater</code> 或重载 <code>&lt;</code>。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Priority Queue\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// 1. 大根堆</span><br>priority_queue&lt;<span class=\"hljs-type\">int</span>&gt; max_pq;<br><br><span class=\"hljs-comment\">// 2. 小根堆 (注意 vector 和 greater)</span><br>priority_queue&lt;<span class=\"hljs-type\">int</span>, vector&lt;<span class=\"hljs-type\">int</span>&gt;, greater&lt;<span class=\"hljs-type\">int</span>&gt;&gt; min_pq;<br><br><span class=\"hljs-comment\">// 3. 结构体 (Dijkstra)</span><br><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Node</span> &#123;<br>    <span class=\"hljs-type\">int</span> u, d;<br>    <span class=\"hljs-comment\">// 想要 dist 小的在堆顶 -&gt; 重载 &lt; 为 &gt;</span><br>    <span class=\"hljs-type\">bool</span> <span class=\"hljs-keyword\">operator</span> &lt; (<span class=\"hljs-type\">const</span> Node &amp;rhs) <span class=\"hljs-type\">const</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> d &gt; rhs.d; <br>    &#125;<br>&#125;;<br>priority_queue&lt;Node&gt; pq;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-懒惰删除法-Lazy-Deletion\">3.2 懒惰删除法 (Lazy Deletion)</h3>\n<ul>\n<li><strong>策略</strong>: STL 堆不支持删除任意元素。建立一个 <code>del_pq</code> 记录要删的元素，当两堆堆顶相同时抵消。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Lazy Del\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\"><span class=\"hljs-comment\">// 弹出堆顶的逻辑</span><br><span class=\"hljs-keyword\">while</span>( !mq.<span class=\"hljs-built_in\">empty</span>() &amp;&amp; !del_mq.<span class=\"hljs-built_in\">empty</span>() &amp;&amp; mq.<span class=\"hljs-built_in\">top</span>() == del_mq.<span class=\"hljs-built_in\">top</span>() ) <br>&#123;<br>    mq.<span class=\"hljs-built_in\">pop</span>(); <br>    del_mq.<span class=\"hljs-built_in\">pop</span>();<br>&#125;<br><span class=\"hljs-comment\">// 此时 mq.top() 才是真实堆顶</span><br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1]</strong>: 结构体重载 <code>&lt;</code> 时，<code>const</code> 关键字不能省。</p>\n</li>\n<li>\n<p><strong>[坑点 2]</strong>: 默认大根堆。若存 <code>pair</code>，默认先比 <code>first</code>。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li><strong>对顶堆</strong>: 动态维护中位数 (一个大根堆 + 一个小根堆)。</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1090]</strong>: 合并果子 - 哈夫曼树思想</p>\n</li>\n<li>\n<p><strong>[Luogu P3378]</strong>: 堆模板</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/8d4c9742/"},{"title":"降维优化体系 (Optimization by Dimension Reduction)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 一系列将高复杂度（如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>）算法优化至线性或近线性（<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> / <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>）的思维范式。</li>\n<li><strong>核心地位</strong>: 算法竞赛中从“暴力解”通向“正解”的<strong>核心桥梁</strong>。</li>\n<li><strong>本质</strong>: <strong>Filter &amp; Compress</strong> —— 剔除无效计算，压缩冗余状态。</li>\n</ul>\n<h2 id=\"2-体系全景\">2. 体系全景</h2>\n<p>我们到底在降什么维？？！</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">维度</th>\n<th style=\"text-align:left\">技巧名称</th>\n<th style=\"text-align:left\">核心逻辑 (Logic Pivot)</th>\n<th style=\"text-align:left\">典型应用 (Use Case)</th>\n<th style=\"text-align:left\">归属位置</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>预处理</strong></td>\n<td style=\"text-align:left\"><strong>前缀和 &amp; 差分</strong></td>\n<td style=\"text-align:left\"><strong>逆运算</strong>: 将区间操作转化为端点操作。</td>\n<td style=\"text-align:left\">静态区间求和 / 区间修改。</td>\n<td style=\"text-align:left\"><code>00_Basis/02</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>动态维护</strong></td>\n<td style=\"text-align:left\"><strong>双指针</strong></td>\n<td style=\"text-align:left\"><strong>单调性</strong>: 利用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo separator=\"true\">,</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">L, R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> 不回退特性降维。</td>\n<td style=\"text-align:left\">两数之和 / 变长滑动窗口。</td>\n<td style=\"text-align:left\"><code>00_Basis/02</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>数据结构</strong></td>\n<td style=\"text-align:left\"><strong>单调栈/队列</strong></td>\n<td style=\"text-align:left\"><strong>淘汰机制</strong>: 及时剔除无效元素。</td>\n<td style=\"text-align:left\">下一个更大元素 / 窗口最值。</td>\n<td style=\"text-align:left\"><code>01_DS/01</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>二进制</strong></td>\n<td style=\"text-align:left\"><strong>倍增 (ST表)</strong></td>\n<td style=\"text-align:left\"><strong>二进制拆分</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo>→</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N) \\to O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</td>\n<td style=\"text-align:left\">静态 RMQ / LCA / 快速幂。</td>\n<td style=\"text-align:left\"><code>01_DS/04</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>值域</strong></td>\n<td style=\"text-align:left\"><strong>离散化</strong></td>\n<td style=\"text-align:left\"><strong>映射</strong>: 稀疏值域 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 紧凑下标。</td>\n<td style=\"text-align:left\">值域大但元素少的计数/线段树。</td>\n<td style=\"text-align:left\"><code>00_Basis/02</code></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"3-思考范式\">3. 思考范式</h2>\n<ol>\n<li><strong>暴力起手</strong>: 先写出 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 朴素解。</li>\n<li><strong>定位冗余</strong>:\n<ul>\n<li>是重复计算了区间和？ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <strong>前缀和</strong></li>\n<li>是重复扫描了无效元素？ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <strong>单调栈/队列</strong></li>\n<li>是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo separator=\"true\">,</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">L, R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> 指针反复横跳？ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <strong>双指针</strong></li>\n</ul>\n</li>\n<li><strong>匹配模型</strong>: 确认问题满足<strong>结合律</strong>（前缀和）或<strong>单调性</strong>（双指针/单调结构）。</li>\n</ol>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/fe091ad2/"},{"title":"双指针 (Two Pointers)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 利用序列的<strong>单调性</strong>，通过两个指针的<strong>同向</strong>或<strong>相向</strong>移动，将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 降维至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><strong>前置依赖</strong>: [排序], [前缀和]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>区间搜索</strong>: 寻找满足条件的最短/最长连续子区间。</li>\n<li><strong>组合优化</strong>: 两个有序序列的匹配或合并。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:\n<ul>\n<li>vs <strong>二分</strong>: 双指针是动态的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>，二分是静态的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>&quot;Never Turn Back&quot; (绝不回头)</strong>。\n<ul>\n<li>当 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> 右移导致状态变更时，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> 只需要跟随右移，无需回退。</li>\n</ul>\n</li>\n<li><strong>物理模型</strong>: <strong>滑动窗口</strong>的伸缩。\n<ul>\n<li><strong>进窗 (Expand)</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> 主动摄入。</li>\n<li><strong>出窗 (Shrink)</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> 被动排出以维持合法性。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-尺取法模板-同向双指针\">3.1 尺取法模板 (同向双指针)</h3>\n<ul>\n<li><strong>策略</strong>: 寻找和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">\\ge K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 的<strong>最短</strong>子数组。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Sliding Window\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-type\">int</span> l = <span class=\"hljs-number\">1</span>, sum = <span class=\"hljs-number\">0</span>, ans = n + <span class=\"hljs-number\">1</span>;<br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> r = <span class=\"hljs-number\">1</span>; r &lt;= n; ++ r ) <br>&#123;<br>    sum += a[r]; <br>    <span class=\"hljs-keyword\">while</span>( sum &gt;= K ) <br>    &#123;<br>        ans = <span class=\"hljs-built_in\">min</span>( ans, r - l + <span class=\"hljs-number\">1</span> );<br>        sum -= a[l]; <br>        l ++; <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1]</strong>: 若数组含<strong>负数</strong>，单调性失效，需改用前缀和+单调队列。</p>\n</li>\n<li>\n<p><strong>[坑点 2]</strong>: 求“最长”合法区间时，逻辑通常是 <code>while(invalid) L++</code>。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>前后缀分解 + 双指针</strong>: (P3143) 选取两个不重叠区间使和最大。</p>\n<ul>\n<li>\n<p>预处理 <code>pre[i]</code> (以 i 结尾的最优解) 和 <code>suf[i]</code> (以 i 开头的最优解)。</p>\n</li>\n<li>\n<p>答案为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\max(pre[i] + suf[i+1])</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">])</span></span></span></span>。其中 <code>pre/suf</code> 的计算利用双指针维护。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>相向双指针</strong>: 2-Sum 问题，或接雨水问题。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1638]</strong>: 逛画展 - 尺取法</p>\n</li>\n<li>\n<p><strong>[Luogu P3143]</strong>: 钻石收藏家 - 排序 + 双指针 + 前后缀DP</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/4775279/"},{"title":"ST表与倍增 (Sparse Table & Binary Lifting)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 利用 <strong>二进制拆分 (Binary Splitting)</strong> 思想，通过 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N \\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 预处理，实现 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 快速跳跃的技术。</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>ST表</strong>: <strong>静态</strong>区间最值查询 (RMQ)。在查询量巨大时，优于线段树的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 查询。</li>\n<li><strong>LCA (树上倍增)</strong>: 树上任意两点的最近公共祖先，避免 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 暴力上跳。</li>\n</ul>\n</li>\n<li><strong>局限性</strong>: ST表不支持<strong>修改</strong>（修改需重构，代价巨大）。</li>\n</ul>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>倍增原理</strong>: 任何整数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 均可被分解为二进制幂的组合 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>0</mn></msup><mo separator=\"true\">,</mo><msup><mn>2</mn><mn>1</mn></msup><mo separator=\"true\">,</mo><mo>…</mo></mrow><annotation encoding=\"application/x-tex\">2^0, 2^1, \\dots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span></span></span></span>)。</li>\n<li><strong>状态转移 (DP)</strong>:\n<ul>\n<li><strong>步长倍增 (LCA)</strong>: 跳 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span> 步 = 先跳 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span> 步，再从新位置跳 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span> 步。<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">[</mo><mi>u</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mi>F</mi><mo stretchy=\"false\">[</mo><mi>F</mi><mo stretchy=\"false\">[</mo><mi>u</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">F[u][i] = F[ F[u][i-1] ][ i-1 ]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span></span></p>\n</li>\n<li><strong>区间拼合 (ST表)</strong>: 长度 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span> 的最值 = 左半 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span> 与右半 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">2^{i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span> 的最值（允许重叠）。<p class=\"katex-block \"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>S</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>S</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>S</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>+</mo><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">ST[j][i] = \\max( ST[j][i-1], ST[j + 2^{i-1}][i-1] )\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1247em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8747em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">])</span></span></span></span></span></p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-ST-表模板-静态-RMQ\">3.1 ST 表模板 (静态 RMQ)</h3>\n<ul>\n<li><strong>Code Style</strong>: 注意位运算优先级，<code>1 &lt;&lt; j</code> 最好加括号。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: ST Table\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// st[i][j] 表示从 i 开始，长度为 2^j 的区间最大值</span><br><span class=\"hljs-type\">int</span> st[maxn][<span class=\"hljs-number\">21</span>]; <br><span class=\"hljs-type\">int</span> lg[maxn]; <span class=\"hljs-comment\">// 预处理 log 值</span><br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">init</span><span class=\"hljs-params\">()</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// 1. 预处理 log (常数优化)</span><br>    lg[<span class=\"hljs-number\">1</span>] = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">2</span>; i &lt;= n; ++ i ) <br>        lg[i] = lg[i &gt;&gt; <span class=\"hljs-number\">1</span>] + <span class=\"hljs-number\">1</span>;<br>        <br>    <span class=\"hljs-comment\">// 2. Base Case (j=0)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>        st[i][<span class=\"hljs-number\">0</span>] = a[i];<br>        <br>    <span class=\"hljs-comment\">// 3. DP 递推 (外层枚举 j)</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> j = <span class=\"hljs-number\">1</span>; j &lt;= <span class=\"hljs-number\">20</span>; ++ j ) <br>    &#123;<br>        <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i + (<span class=\"hljs-number\">1</span> &lt;&lt; j) - <span class=\"hljs-number\">1</span> &lt;= n; ++ i ) <br>        &#123;<br>            st[i][j] = <span class=\"hljs-built_in\">max</span>( st[i][j - <span class=\"hljs-number\">1</span>], <br>                            st[i + (<span class=\"hljs-number\">1</span> &lt;&lt; (j - <span class=\"hljs-number\">1</span>))][j - <span class=\"hljs-number\">1</span>] );<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">query</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> l, <span class=\"hljs-type\">int</span> r )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> k = lg[r - l + <span class=\"hljs-number\">1</span>];<br>    <span class=\"hljs-comment\">// 重叠覆盖：取左端长 2^k 和右端长 2^k</span><br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">max</span>( st[l][k], st[r - (<span class=\"hljs-number\">1</span> &lt;&lt; k) + <span class=\"hljs-number\">1</span>][k] );<br>&#125;<br>````<br><br>&#123;% endfold %&#125;<br><br>### <span class=\"hljs-number\">3.2</span> 倍增 LCA 模板 (Tree Binary Lifting)<br><br>- **策略**: 先将深度深的节点跳到同一深度，再同步上跳。<br>    <br><br>&#123;% fold info @Code: Binary Lifting LCA %&#125;<br><br>```cpp<br><span class=\"hljs-comment\">// fa[u][i] 表示 u 的 2^i 级祖先</span><br><span class=\"hljs-type\">int</span> fa[maxn][<span class=\"hljs-number\">21</span>], dep[maxn];<br><br><span class=\"hljs-comment\">// 1. DFS 预处理 fa[u][0] 和深度</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">dfs</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> father )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    dep[u] = dep[father] + <span class=\"hljs-number\">1</span>;<br>    fa[u][<span class=\"hljs-number\">0</span>] = father;<br>    <br>    <span class=\"hljs-comment\">// 倍增预处理：u 的 2^i 祖先 = (u 的 2^(i-1) 祖先) 的 2^(i-1) 祖先</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= <span class=\"hljs-number\">20</span>; ++ i ) <br>        fa[u][i] = fa[ fa[u][i - <span class=\"hljs-number\">1</span>] ][i - <span class=\"hljs-number\">1</span>];<br>        <br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> v : adj[u] ) <br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( v != father ) <span class=\"hljs-built_in\">dfs</span>( v, u );<br>    &#125;<br>&#125;<br><br><span class=\"hljs-comment\">// 2. 查询 LCA</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">lca</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> v )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( dep[u] &lt; dep[v] ) <span class=\"hljs-built_in\">swap</span>( u, v );<br>    <br>    <span class=\"hljs-comment\">// Step 1: 让 u 跳到和 v 同一层</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">20</span>; i &gt;= <span class=\"hljs-number\">0</span>; -- i ) <br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( dep[fa[u][i]] &gt;= dep[v] ) <br>            u = fa[u][i];<br>    &#125;<br>    <br>    <span class=\"hljs-keyword\">if</span>( u == v ) <span class=\"hljs-keyword\">return</span> u;<br>    <br>    <span class=\"hljs-comment\">// Step 2: u 和 v 一起往上跳，直到 LCA 的下一层</span><br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">20</span>; i &gt;= <span class=\"hljs-number\">0</span>; -- i ) <br>    &#123;<br>        <span class=\"hljs-keyword\">if</span>( fa[u][i] != fa[v][i] ) <br>        &#123;<br>            u = fa[u][i];<br>            v = fa[v][i];<br>        &#125;<br>    &#125;<br>    <br>    <span class=\"hljs-comment\">// Step 3: 返回父节点</span><br>    <span class=\"hljs-keyword\">return</span> fa[u][<span class=\"hljs-number\">0</span>];<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1] 循环顺序</strong>: 倍增 DP (<code>ST表</code>) 必须<strong>先枚举指数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span></strong>，再枚举位置 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>。这是因为计算 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 层依赖于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">j-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 层的所有结果。</p>\n</li>\n<li>\n<p><strong>[坑点 2] 内存限制</strong>: <code>st[N][21]</code> 在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><msup><mn>10</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">N=10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span> 时占用内存较大 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>80</mn><mi>M</mi><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">\\approx 80MB</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">80</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">MB</span></span></span></span> <code>int</code>)，若题目内存紧张 (64MB) 需警惕 MLE。</p>\n</li>\n<li>\n<p><strong>[坑点 3] 边界检查</strong>: LCA 跳跃时，注意 <code>fa[u][i]</code> 可能为 0 (表示跳出根节点)，需确保 <code>dep[0] = 0</code> 且不影响逻辑。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附-Knowledge-Adhesion\">4. 知识粘附 (Knowledge Adhesion)</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>树上差分</strong>: 结合 LCA 求路径修改。</p>\n</li>\n<li>\n<p><strong>树链剖分</strong>: 处理带<strong>修改</strong>的路径查询，比倍增更通用但常数大。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P3865]</strong>: ST 表模板 (静态 RMQ)。</p>\n</li>\n<li>\n<p><strong>[Luogu P3379]</strong>: LCA 模板 (树上最近公共祖先)。</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/e6c1b327/"},{"title":"单调栈与单调队列 (Monotonic Stack & Queue)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 内部元素保持严格单调（递增或递减）的线性数据结构。本质是**&quot;存储有潜力的未来&quot;**。</li>\n<li><strong>前置依赖</strong>: [队列/栈基础], [滑动窗口]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>单调栈</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 寻找每个元素左/右侧<strong>第一个</strong>比它大/小的元素 (NGE 问题)。</li>\n<li><strong>单调队列</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 解决<strong>滑动窗口</strong>内的最值查询 (RMQ)。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">核心优势</th>\n<th style=\"text-align:left\">劣势/局限</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>单调队列</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 线性极速</td>\n<td style=\"text-align:left\">仅限固定/变长窗口</td>\n<td style=\"text-align:left\">滑动窗口、DP 优化</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>ST 表</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 查询任意区间</td>\n<td style=\"text-align:left\">不支持修改、建表慢</td>\n<td style=\"text-align:left\">静态 RMQ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>线段树</strong></td>\n<td style=\"text-align:left\">支持修改</td>\n<td style=\"text-align:left\">常数大、写起来烦</td>\n<td style=\"text-align:left\">动态 RMQ</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>淘汰哲学</strong>: <strong>&quot;既不如此时新，也不如此时强，那便毫无意义。&quot;</strong>\n<ul>\n<li>若新元素 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 比老元素 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 更优且更晚过期，则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 永久删除。</li>\n</ul>\n</li>\n<li><strong>存储内容</strong>: 务必存储 <strong>下标 (Index)</strong>。\n<ul>\n<li>下标包含“位置/过期时间”信息。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-单调栈模板-Next-Greater-Element\">3.1 单调栈模板 (Next Greater Element)</h3>\n<ul>\n<li><strong>策略</strong>: 找右边第一个比我大的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 维护<strong>单调递减</strong>栈。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-076edf11\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-076edf11\">\n        <div class=\"fold-arrow\">▶</div>Code: Monotonic Stack\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-076edf11\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// ans[i] 存储 i 右边第一个比 a[i] 大的元素下标</span><br>stack&lt;<span class=\"hljs-type\">int</span>&gt; stk; <br><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>&#123;<br>    <span class=\"hljs-comment\">// 破坏单调性 -&gt; 结算时刻</span><br>    <span class=\"hljs-keyword\">while</span>( !stk.<span class=\"hljs-built_in\">empty</span>() &amp;&amp; a[i] &gt; a[stk.<span class=\"hljs-built_in\">top</span>()] ) <br>    &#123;<br>        ans[stk.<span class=\"hljs-built_in\">top</span>()] = i; <br>        stk.<span class=\"hljs-built_in\">pop</span>(); <br>    &#125;<br>    stk.<span class=\"hljs-built_in\">push</span>( i ); <br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-单调队列模板-Sliding-Window-Max\">3.2 单调队列模板 (Sliding Window Max)</h3>\n<ul>\n<li><strong>策略</strong>: 求最大值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 维护<strong>单调递减</strong>队列。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-28ab9646\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-28ab9646\">\n        <div class=\"fold-arrow\">▶</div>Code: Monotonic Queue\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-28ab9646\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs C++\">deque&lt;<span class=\"hljs-type\">int</span>&gt; q; <span class=\"hljs-comment\">// 存下标</span><br><br><span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) <br>&#123;<br>    <span class=\"hljs-comment\">// 1. 检查队头过期</span><br>    <span class=\"hljs-keyword\">if</span>( !q.<span class=\"hljs-built_in\">empty</span>() &amp;&amp; q.<span class=\"hljs-built_in\">front</span>() &lt;= i - K ) <br>        q.<span class=\"hljs-built_in\">pop_front</span>();<br>        <br>    <span class=\"hljs-comment\">// 2. 淘汰弱者</span><br>    <span class=\"hljs-keyword\">while</span>( !q.<span class=\"hljs-built_in\">empty</span>() &amp;&amp; a[i] &gt;= a[q.<span class=\"hljs-built_in\">back</span>()] ) <br>        q.<span class=\"hljs-built_in\">pop_back</span>();<br>        <br>    <span class=\"hljs-comment\">// 3. 入队 &amp; 取值</span><br>    q.<span class=\"hljs-built_in\">push_back</span>( i );<br>    <span class=\"hljs-keyword\">if</span>( i &gt;= K ) <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;%d &quot;</span>, a[q.<span class=\"hljs-built_in\">front</span>()]);<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li>\n<p><strong>[坑点 1]</strong>: 单调栈处理<strong>直方图最大矩形</strong>时，需在数组末尾加 <code>0</code> 强制弹栈结算。</p>\n</li>\n<li>\n<p><strong>[坑点 2]</strong>: 单调队列优化 DP 时，初始状态（如 <code>dp[0]</code>）需提前入队。</p>\n</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li>\n<p><strong>变体模型</strong>:</p>\n<ul>\n<li>\n<p><strong>二维滑动窗口</strong>: (P2216) 先对每一行做单调队列，得到 <code>row_max[i][j]</code>；再对该结果的每一列做单调队列。</p>\n</li>\n<li>\n<p><strong>DP 优化</strong>: (P3800) 形如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>k</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo>−</mo><mi>T</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>+</mo><mi>T</mi><mo stretchy=\"false\">]</mo></mrow></msub><mo stretchy=\"false\">(</mo><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>v</mi><mi>a</mi><mi>l</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">dp[i][j] = \\max_{k \\in [j-T, j+T]} (dp[i-1][k]) + val[i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3552em;\"></span><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">∈</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose mtight\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span>，内层 max 可用单调队列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 转移。</p>\n</li>\n<li>\n<p><strong>计数单调栈</strong>: (P1950) 统计全 <code>.</code> 子矩形数量。维护每个点作为“悬线”底部的左右边界 <code>L[i], R[i]</code>，贡献为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>i</mi><mo>−</mo><mi>L</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>R</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>−</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h[i] \\times (i-L[i]) \\times (R[i]-i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span>。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>母题索引</strong>:</p>\n<ul>\n<li>\n<p><strong>[Luogu P1886]</strong>: 滑动窗口 - 单调队列模板</p>\n</li>\n<li>\n<p><strong>[Luogu P5788]</strong>: 单调栈模板</p>\n</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/621f0544/"},{"title":"线段树体系 (Segment Tree System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 基于<strong>分治思想</strong>的二叉树结构，将大区间拆解为被管理的“小区间节点”，支持 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 的通用区间修改与查询。</li>\n<li><strong>前置依赖</strong>: [分治法], [二叉树], [递归]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>通用区间操作</strong>: 解决 BIT 无法处理的非可逆运算 (如 Range Max/Min) 和复杂组合操作 (如 Range Mul + Range Add)。</li>\n<li><strong>信息合并</strong>: 解决 &quot;最大子段和&quot; 等需要维护内部结构信息的难题。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">核心优势</th>\n<th style=\"text-align:left\">劣势/局限</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>线段树</strong></td>\n<td style=\"text-align:left\"><strong>全能战士</strong>，支持 Lazy Tag，支持复杂 Info Merge</td>\n<td style=\"text-align:left\">代码量大，常数大，空间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">4N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span></td>\n<td style=\"text-align:left\">区间修改、扫描线、GSS、历史最值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>ST 表</strong></td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 静态查询，极速</td>\n<td style=\"text-align:left\">不支持修改</td>\n<td style=\"text-align:left\">静态 RMQ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>分块</strong></td>\n<td style=\"text-align:left\">支持更离谱的非结合律操作 (如区间众数)</td>\n<td style=\"text-align:left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msqrt><mi>N</mi></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\sqrt{N})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1767em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9267em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-2.8867em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewbox=\"0 0 400000 1080\" preserveaspectratio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1133em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 较慢</td>\n<td style=\"text-align:left\">极难维护的数据结构题</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>分治 (Divide) 与 懒惰 (Lazy)</strong>。\n<ul>\n<li><strong>Divide</strong>: 将询问拆解为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 个已预处理的节点。</li>\n<li><strong>Lazy</strong>: 修改时只更新当前层，打上标记 <code>tag</code>，绝不主动下放，直到“被迫”访问子节点时才 <code>push_down</code>。</li>\n</ul>\n</li>\n<li><strong>算子代数</strong>:\n<ul>\n<li><strong>Push Up (信息汇总)</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>s</mi><mo stretchy=\"false\">)</mo><mo>⊕</mo><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Info(u) = Info(ls) \\oplus Info(rs)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊕</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">rs</span><span class=\"mclose\">)</span></span></span></span>。必须满足结合律。</li>\n<li><strong>Push Down (命令下达)</strong>: 将父节点的 <code>tag</code> 作用于子节点，并叠加到子节点的 <code>tag</code> 上。注意操作顺序 (如先乘后加)。</li>\n</ul>\n</li>\n<li><strong>空间投影 (扫描线)</strong>:\n<ul>\n<li>扫描线本质上是<strong>将 2D 几何问题投影到 1D 线段树上</strong>。</li>\n<li>线段树的每一个节点对应 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 轴的一段区间，随着 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 轴 (时间) 的推进，动态维护 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 轴 (空间) 的覆盖情况。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-通用-Lazy-模板-区间加-求和\">3.1 通用 Lazy 模板 (区间加/求和)</h3>\n<ul>\n<li><strong>策略</strong>: 只有当完全覆盖区间时才打标返回；否则下放标记并分裂递归。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-8f7bdefe\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-8f7bdefe\">\n        <div class=\"fold-arrow\">▶</div>Code: Lazy SegTree\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-8f7bdefe\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">define</span> ls u &lt;&lt; 1</span><br><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">define</span> rs u &lt;&lt; 1 | 1</span><br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">push_up</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    tr[u].sum = tr[ls].sum + tr[rs].sum;<br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">push_down</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( tr[u].tag ) <br>    &#123;<br>        ll t = tr[u].tag;<br>        <span class=\"hljs-comment\">// Apply tag to children</span><br>        tr[ls].sum += t * ( tr[ls].r - tr[ls].l + <span class=\"hljs-number\">1</span> );<br>        tr[ls].tag += t;<br>        tr[rs].sum += t * ( tr[rs].r - tr[rs].l + <span class=\"hljs-number\">1</span> );<br>        tr[rs].tag += t;<br>        tr[u].tag = <span class=\"hljs-number\">0</span>;<br>    &#125;<br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">modify</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u, <span class=\"hljs-type\">int</span> l, <span class=\"hljs-type\">int</span> r, ll k )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( l &lt;= tr[u].l &amp;&amp; tr[u].r &lt;= r ) <br>    &#123;<br>        tr[u].sum += k * ( tr[u].r - tr[u].l + <span class=\"hljs-number\">1</span> );<br>        tr[u].tag += k;<br>        <span class=\"hljs-keyword\">return</span> ;<br>    &#125;<br>    <span class=\"hljs-built_in\">push_down</span>( u ); <span class=\"hljs-comment\">// Mandatory push_down before split</span><br>    <span class=\"hljs-type\">int</span> mid = ( tr[u].l + tr[u].r ) &gt;&gt; <span class=\"hljs-number\">1</span>;<br>    <span class=\"hljs-keyword\">if</span>( l &lt;= mid ) <span class=\"hljs-built_in\">modify</span>( ls, l, r, k );<br>    <span class=\"hljs-keyword\">if</span>( mid &lt; r ) <span class=\"hljs-built_in\">modify</span>( rs, l, r, k );<br>    <span class=\"hljs-built_in\">push_up</span>( u );<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-GSS-模型-结构体合并\">3.2 GSS 模型 (结构体合并)</h3>\n<ul>\n<li><strong>策略</strong>: 当单一数值无法支持 <code>push_up</code> 时 (如最大子段和)，需构建结构体，维护 <code>lmax</code>, <code>rmax</code>, <code>sum</code> 等辅助信息以实现逻辑闭环。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-dcdac752\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-dcdac752\">\n        <div class=\"fold-arrow\">▶</div>Code: GSS Merge\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-dcdac752\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// GSS: Maximum Subarray Sum Logic</span><br><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Node</span> &#123;<br>    <span class=\"hljs-type\">int</span> l, r;<br>    ll sum, lmax, rmax, dat; <span class=\"hljs-comment\">// dat is the answer</span><br>&#125;;<br><br><span class=\"hljs-function\">Node <span class=\"hljs-title\">merge</span><span class=\"hljs-params\">( <span class=\"hljs-type\">const</span> Node &amp;L, <span class=\"hljs-type\">const</span> Node &amp;R )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    Node res;<br>    res.l = L.l, res.r = R.r;<br>    res.sum = L.sum + R.sum;<br>    <span class=\"hljs-comment\">// Prefix max: either left&#x27;s prefix OR left&#x27;s all + right&#x27;s prefix</span><br>    res.lmax = <span class=\"hljs-built_in\">max</span>( L.lmax, L.sum + R.lmax );<br>    <span class=\"hljs-comment\">// Suffix max</span><br>    res.rmax = <span class=\"hljs-built_in\">max</span>( R.rmax, R.sum + L.rmax );<br>    <span class=\"hljs-comment\">// Max Subarray: strictly in Left, strictly in Right, or crossing Mid</span><br>    res.dat = <span class=\"hljs-built_in\">max</span>( <span class=\"hljs-built_in\">max</span>( L.dat, R.dat ), L.rmax + R.lmax );<br>    <span class=\"hljs-keyword\">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-3-扫描线-几何投影\">3.3 扫描线 (几何投影)</h3>\n<ul>\n<li><strong>定义</strong>: 解决 <strong>矩形面积并</strong> 的经典算法。</li>\n<li><strong>特殊性</strong>:\n<ul>\n<li><strong>无需 PushDown</strong>: 因为只查询根节点 <code>tr[1].len</code>，且操作成对出现 (入边 +1, 出边 -1)，<code>cnt &gt; 0</code> 即可锁定长度。</li>\n<li><strong>离散化</strong>: 坐标通常很大，需映射到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>M</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, M]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\">]</span></span></span></span>。</li>\n<li><strong>区间定义</strong>: 线段树节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 维护的是几何区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[y_i, y_{i+1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-6ae3e036\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-6ae3e036\">\n        <div class=\"fold-arrow\">▶</div>Code: Sweep Line PushUp\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-6ae3e036\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">push_up</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> u )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-comment\">// Case 1: Fully covered by at least one rectangle</span><br>    <span class=\"hljs-keyword\">if</span>( tr[u].cnt &gt; <span class=\"hljs-number\">0</span> ) <br>    &#123;<br>        tr[u].len = raw_y[tr[u].r + <span class=\"hljs-number\">1</span>] - raw_y[tr[u].l];<br>    &#125;<br>    <span class=\"hljs-comment\">// Case 2: Not fully covered, derived from children</span><br>    <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span>( tr[u].l != tr[u].r ) <br>    &#123;<br>        tr[u].len = tr[ls].len + tr[rs].len;<br>    &#125; <br>    <span class=\"hljs-comment\">// Case 3: Leaf node with cnt == 0</span><br>    <span class=\"hljs-keyword\">else</span> <br>    &#123;<br>        tr[u].len = <span class=\"hljs-number\">0</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li><strong>[空间刺客]</strong>: 必须开 <strong>4 倍空间 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">4N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>)</strong>。底层节点数约为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>，倒数第二层 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">N/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\">/2</span></span></span></span>… 等比数列求和趋近 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>，考虑到满二叉树的填充，安全需 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">4N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。</li>\n<li><strong>[Tag 优先级]</strong>: 同时存在乘法和加法时，通常 <strong>先乘后加</strong> (mul 先乘，add 先乘后加) 以简化数学逻辑。</li>\n<li><strong>[扫描线映射]</strong>: 扫描线中，若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 坐标有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> 个，线段树维护的是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">M-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 个<strong>间隔</strong>。<code>modify(..., l, r-1)</code> 是常见防越界技巧。</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li><strong>母题索引</strong>:\n<ul>\n<li><strong>[Luogu P3372]</strong>: 基础 Lazy (区间加)。</li>\n<li><strong>[Luogu P3373]</strong>: 双 Tag 维护 (乘法+加法)。</li>\n<li><strong>[Luogu P4513]</strong>: GSS 最大子段和 (结构体合并)。</li>\n<li><strong>[Luogu P5490]</strong>: 扫描线求矩形面积并。</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/33f15c14/"},{"title":"并查集体系 (Disjoint Set Union System)","content":"<h2 id=\"1-生态位\">1. 生态位</h2>\n<ul>\n<li><strong>定义</strong>: 一种管理“元素分组”的森林结构，支持高效的 <strong>集合合并 (Merge)</strong> 与 <strong>元素查找 (Find)</strong>。</li>\n<li><strong>前置依赖</strong>: [树的存储], [递归]</li>\n<li><strong>解决痛点</strong>:\n<ul>\n<li><strong>动态连通性</strong>: 相比 DFS/BFS 的静态遍历，DSU 能在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>α</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\alpha(N))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">))</span></span></span></span> 时间内处理边的动态增加与连通性查询。</li>\n<li><strong>逻辑传递</strong>: 处理“朋友的朋友是朋友”、“敌人的敌人是朋友”等传递性或反传递性逻辑。</li>\n</ul>\n</li>\n<li><strong>竞品对比</strong>:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">算法</th>\n<th style=\"text-align:left\">核心优势</th>\n<th style=\"text-align:left\">劣势/局限</th>\n<th style=\"text-align:left\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>并查集 (DSU)</strong></td>\n<td style=\"text-align:left\">极速 (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>α</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\alpha(N))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">))</span></span></span></span>)，代码短</td>\n<td style=\"text-align:left\"><strong>只增不减</strong> (难以删边)，难以查询路径详情</td>\n<td style=\"text-align:left\">连通块计数、Kruskal MST、逻辑推导</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>DFS/BFS</strong></td>\n<td style=\"text-align:left\">能获取完整路径与距离</td>\n<td style=\"text-align:left\">动态加边需 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> 重跑，慢</td>\n<td style=\"text-align:left\">路径搜索、最短路</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>LCT (动态树)</strong></td>\n<td style=\"text-align:left\">支持删边、换根、动态路径维护</td>\n<td style=\"text-align:left\">极其复杂，常数大</td>\n<td style=\"text-align:left\">动态图连通性、动态树上路径信息</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-逻辑支点\">2. 逻辑支点</h2>\n<ul>\n<li><strong>核心直觉</strong>: <strong>认祖归宗</strong>。\n<ul>\n<li>每个集合是一棵树，根节点是<strong>代表元 (Representative)</strong>。判断两点是否连通，即看它们的根是否相同 (<code>find(x) == find(y)</code>)。</li>\n</ul>\n</li>\n<li><strong>关键技术</strong>:\n<ul>\n<li><strong>路径压缩 (Path Compression)</strong>: <code>find</code> 过程中，将沿途所有节点直接挂在根节点下，使树高度扁平化为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>。</li>\n<li><strong>按秩合并 (Rank Merging)</strong>: 将小树挂在大树下（可选优化，配合路径压缩时效果微乎其微，通常省略）。</li>\n<li><strong>复杂度</strong>: 时间复杂度为 <strong>反阿克曼函数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>α</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\alpha(N))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">))</span></span></span></span></strong>，在竞赛数据范围内可视为常数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mclose\">)</span></span></span></span>。</li>\n</ul>\n</li>\n<li><strong>高级形态</strong>:\n<ul>\n<li><strong>逻辑映射 (扩展域)</strong>: 利用空间换逻辑。将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 拆分为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>s</mi><mi>e</mi><mi>l</mi><mi>f</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{self}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">se</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> (同类域) 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>e</mi><mi>n</mi><mi>e</mi><mi>m</mi><mi>y</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{enemy}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> (敌对域)。若 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x, y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 敌对 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\iff</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟺</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> <code>merge(x_self, y_enemy)</code>。</li>\n<li><strong>向量叠加 (带权)</strong>: 维护 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mi>a</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">fa[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> 的相对值 <code>d[x]</code>。路径压缩时利用向量加法 <code>d[x] += d[fa[x]]</code> 更新。</li>\n<li><strong>时光倒流</strong>: DSU 不支持删边。若题目要求“删边”，则利用<strong>操作的可逆性</strong>，将“删除”转化为“逆序添加”。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-实战部署\">3. 实战部署</h2>\n<h3 id=\"3-1-基础模板-路径压缩\">3.1 基础模板 (路径压缩)</h3>\n<ul>\n<li><strong>策略</strong>: 仅使用路径压缩即可满足 99% 的竞赛需求。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-8f7bdefe\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-8f7bdefe\">\n        <div class=\"fold-arrow\">▶</div>Code: Basic DSU\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-8f7bdefe\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-type\">const</span> <span class=\"hljs-type\">int</span> maxn = <span class=\"hljs-number\">2e5</span> + <span class=\"hljs-number\">50</span>;<br><span class=\"hljs-type\">int</span> fa[maxn];<br><br><span class=\"hljs-comment\">// Init: Everyone is their own ancestor</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">DsuInit</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> n )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">for</span>( <span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">1</span>; i &lt;= n; ++ i ) fa[i] = i;<br>&#125;<br><br><span class=\"hljs-comment\">// Find + Path Compression</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">find</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> x )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( x == fa[x] ) <span class=\"hljs-keyword\">return</span> x;<br>    <span class=\"hljs-keyword\">return</span> fa[x] = <span class=\"hljs-built_in\">find</span>( fa[x] ); <span class=\"hljs-comment\">// Compression happens here</span><br>&#125;<br><br><span class=\"hljs-comment\">// Merge</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">merge</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> x, <span class=\"hljs-type\">int</span> y )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> rx = <span class=\"hljs-built_in\">find</span>( x );<br>    <span class=\"hljs-type\">int</span> ry = <span class=\"hljs-built_in\">find</span>( y );<br>    <span class=\"hljs-keyword\">if</span>( rx != ry ) fa[rx] = ry;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-2-扩展域模板-P1525-关押罪犯\">3.2 扩展域模板 (P1525 关押罪犯)</h3>\n<ul>\n<li><strong>策略</strong>: 处理 &quot;敌人的敌人是朋友&quot; 这类非传递关系。\n<ul>\n<li><strong>定义</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>…</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1 \\dots N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 为朋友域 (Self)，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>+</mo><mn>1</mn><mo>…</mo><mn>2</mn><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N+1 \\dots 2N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 为敌人域 (Enemy)。</li>\n<li><strong>动作</strong>: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x, y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 是敌人 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding=\"application/x-tex\">\\implies</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span></span></span> <code>merge(x, y + n)</code> (x与y敌连通) 且 <code>merge(y, x + n)</code>。</li>\n</ul>\n</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-dcdac752\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-dcdac752\">\n        <div class=\"fold-arrow\">▶</div>Code: Extended Domain\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-dcdac752\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-comment\">// Check Conflict: Is x and y already in the same set?</span><br><span class=\"hljs-keyword\">if</span>( <span class=\"hljs-built_in\">find</span>( x ) == <span class=\"hljs-built_in\">find</span>( y ) ) <br>&#123;<br>    cout &lt;&lt; <span class=\"hljs-string\">&quot;Conflict Detected&quot;</span> &lt;&lt; endl;<br>&#125;<br><span class=\"hljs-keyword\">else</span> <br>&#123;<br>    <span class=\"hljs-comment\">// Logic: Enemy of Enemy is Friend</span><br>    <span class=\"hljs-built_in\">merge</span>( x, y + n ); <br>    <span class=\"hljs-built_in\">merge</span>( y, x + n );<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-3-带权并查集模板-维护相对差值\">3.3 带权并查集模板 (维护相对差值)</h3>\n<ul>\n<li><strong>策略</strong>: 维护 <code>d[x]</code> 表示 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 比 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mi>a</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">fa[x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span> &quot;多&quot; 多少。</li>\n<li><strong>核心</strong>: <code>find</code> 中的<strong>先递归后更新</strong>。</li>\n</ul>\n\n    <div class=\"fold\">\n      <div class=\"fold-title fold-info collapsed\" data-toggle=\"collapse\" href=\"#collapse-6ae3e036\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapse-6ae3e036\">\n        <div class=\"fold-arrow\">▶</div>Code: Weighted DSU\n      </div>\n      <div class=\"fold-collapse collapse\" id=\"collapse-6ae3e036\">\n        <div class=\"fold-content\">\n          <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cpp\"><span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">find</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> x )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">if</span>( x == fa[x] ) <span class=\"hljs-keyword\">return</span> x;<br>    <br>    <span class=\"hljs-type\">int</span> root = <span class=\"hljs-built_in\">find</span>( fa[x] ); <span class=\"hljs-comment\">// 1. Recursive first</span><br>    d[x] += d[fa[x]];         <span class=\"hljs-comment\">// 2. Vector addition: dist(x-&gt;root) = dist(x-&gt;fa) + dist(fa-&gt;root)</span><br>    <span class=\"hljs-keyword\">return</span> fa[x] = root;      <span class=\"hljs-comment\">// 3. Compress</span><br>&#125;<br><br><span class=\"hljs-comment\">// Merge x and y such that val(x) - val(y) = k</span><br><span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">merge</span><span class=\"hljs-params\">( <span class=\"hljs-type\">int</span> x, <span class=\"hljs-type\">int</span> y, <span class=\"hljs-type\">int</span> k )</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-type\">int</span> rx = <span class=\"hljs-built_in\">find</span>( x ), ry = <span class=\"hljs-built_in\">find</span>( y );<br>    <span class=\"hljs-keyword\">if</span>( rx != ry ) <br>    &#123;<br>        fa[rx] = ry;<br>        <span class=\"hljs-comment\">// Vector Calculation loop: </span><br>        <span class=\"hljs-comment\">// d[rx] (rx-&gt;ry) = d[y] (y-&gt;rootY) - d[x] (x-&gt;rootX) + k (x-&gt;y)</span><br>        d[rx] = d[y] - d[x] + k;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n        </div>\n      </div>\n    </div>\n<h3 id=\"3-4-时光倒流-P1197-星球大战\">3.4 时光倒流 (P1197 星球大战)</h3>\n<ul>\n<li><strong>策略</strong>: <strong>正难则反</strong>。\n<ul>\n<li><strong>正向</strong>: 摧毁星球 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 分裂连通块 (DSU 无法做)。</li>\n<li><strong>逆向</strong>: 从废墟开始 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 修复星球 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> 合并连通块 (DSU 擅长)。</li>\n</ul>\n</li>\n<li><strong>步骤</strong>:\n<ol>\n<li>读入所有打击指令，标记被摧毁的星球。</li>\n<li>对<strong>最终幸存</strong>的星球构建初始 DSU，计算残局连通块数 <code>cnt</code>。</li>\n<li><strong>倒序</strong>处理打击指令：每次“修复”一个星球，将其与周围已存在的邻居 <code>merge</code>。每成功 merge 一次，<code>cnt--</code>。</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"⚠️-边界与-Hack\">⚠️ 边界与 Hack</h3>\n<ul>\n<li><strong>[空间刺客]</strong>: 扩展域并查集极易 RE。若有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 种关系 (如食物链 A吃B吃C)，需开 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K \\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 的空间。</li>\n<li><strong>[递归陷阱]</strong>: 带权并查集的 <code>find</code> 必须先保存 <code>find(fa[x])</code> 的返回值，<strong>再</strong>更新 <code>d[x]</code>，<strong>最后</strong>赋值 <code>fa[x]</code>。若直接 <code>fa[x] = find(fa[x])</code> 会导致 <code>d[fa[x]]</code> 在用到前就被压缩没了。</li>\n<li><strong>[初始化]</strong>: 扩展域初始化必须覆盖 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>…</mo><mi>K</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">1 \\dots K \\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。</li>\n</ul>\n<h2 id=\"4-知识粘附\">4. 知识粘附</h2>\n<ul>\n<li><strong>变体模型</strong>:\n<ul>\n<li><strong>食物链 (NOI 2001)</strong>: 3 倍扩展域 (同类、捕食、天敌)。</li>\n<li><strong>Kruskal 算法</strong>: 利用 DSU 维护加边过程中的连通性，防止环的产生。</li>\n</ul>\n</li>\n<li><strong>母题索引</strong>:\n<ul>\n<li><strong>[Luogu P1525]</strong>: 扩展域 (二分图判定)。</li>\n<li><strong>[Luogu P1197]</strong>: 时光倒流 (连通块计数)。</li>\n<li><strong>[Luogu P2004/P1196]</strong>: 带权并查集 (银河英雄传说 - 距离/大小维护)。</li>\n</ul>\n</li>\n</ul>\n","isPage":false,"isDraft":false,"permalink":"http://example.com/posts/6c25457a/"},{"title":"文章分类","content":"","isPage":true,"isDraft":false,"permalink":"http://example.com/categories/index.html"},{"title":"关于我 (About Me)","content":"<h2 id=\"👋-你好哇，我是-MiQiu（米秋）。\">👋 你好哇，我是 MiQiu（米秋）。</h2>\n<p>一个热爱生活，也总是忍不住想<strong>把混乱变成有序</strong>的学生。</p>\n<p>欢迎来到我在这个数字宇宙中搭建的小小角落。</p>\n<p>相比于屏幕上枯燥的代码行，我更迷恋<strong>在草稿纸上推演的时刻</strong>。<br>\n那些散乱的数据就像夜空中的碎星，而算法，就是那根将它们连成<strong>星座</strong>的线。</p>\n<p>我享受那种在一团乱麻中找到线头的惊喜，沉醉于经过层层剥茧后，真相忽然在眼前铺开的<strong>通透感</strong>。<br>\n对我来说，这就是一种纯粹的魔法。</p>\n<p>这便是我，<strong>「米秋」</strong>。<br>\n一个相信 <strong>“希望和浪漫”</strong> 的人。</p>\n<p>虽然前路漫漫，依然会有风暴和迷雾，但只要内心的火焰还在燃烧，我就拥有破浪前行的勇气。</p>\n<p>我搭建这里，是希望能记录下这些思维火花碰撞的瞬间，也希望能给你带来一点点向上的能量。</p>\n<p>路途遥远，你可以慢慢走，别着急。</p>\n<p><strong>Bon Voyage.</strong> 愿你的旅途星光璀璨，愿你的夏日永不凋零。</p>\n<p>愿你能在这里，捡到一些有用的碎片，或者感受到一点点共鸣。</p>\n<hr>\n<blockquote>\n<p><strong>Sonnet 18 – William Shakespeare</strong></p>\n<p>Shall I compare thee to a summer’s day?</p>\n<p>Thou are more lovely and more temperate:</p>\n<p>Rough winds do shake the darling buds of May,</p>\n<p>And summer’s lease hath all too small a date:</p>\n<p>Sometime too hot the eye of heaven shines.</p>\n<p>And every fair from fair sometime declines,</p>\n<p>By chance or nature’s changing course untrimmed:</p>\n<p>But thy eternal summer shall not fade,</p>\n<p>Nor lose possession of that fair thou ow’st,</p>\n<p>Nor shall eternal lines to time thou grow’st:</p>\n<p>So long as men can breathe or eyes can see,</p>\n<p>So long lives this, and this gives life to thee.</p>\n</blockquote>\n","isPage":true,"isDraft":false,"permalink":"http://example.com/about/index.html"}]